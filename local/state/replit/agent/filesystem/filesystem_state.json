{"file_contents":{"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Overview\n\nSecureExam is a comprehensive online examination platform designed to provide secure, proctored testing capabilities with advanced monitoring features. The application combines QR code-based hall ticket authentication, AI-powered face detection, real-time monitoring dashboards, and a secure kiosk exam mode to ensure academic integrity during online examinations.\n\nThe platform serves two primary user types: administrators who create and monitor exams, and students who take authenticated examinations under controlled conditions.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n# System Architecture\n\n## Frontend Architecture\n- **Framework**: React with TypeScript using Vite as the build tool\n- **UI Library**: shadcn/ui components built on top of Radix UI primitives\n- **Styling**: Tailwind CSS with a custom design system featuring gradient themes and glassmorphism effects\n- **Routing**: Wouter for client-side routing with role-based route protection\n- **State Management**: TanStack Query for server state management and caching\n\n## Backend Architecture\n- **Runtime**: Node.js with Express.js framework\n- **Language**: TypeScript with ESM modules\n- **API Design**: RESTful API with WebSocket support for real-time features\n- **Authentication**: Replit OAuth integration with session-based authentication\n- **Real-time Communication**: WebSocket server for live monitoring and incident reporting\n\n## Data Storage\n- **Database**: PostgreSQL with Neon serverless hosting\n- **ORM**: Drizzle ORM with type-safe schema definitions\n- **Session Storage**: PostgreSQL-backed session store using connect-pg-simple\n- **Migrations**: Drizzle Kit for schema migrations\n\n## Key Features Architecture\n\n### Authentication & Authorization\n- OAuth-based authentication through Replit's identity provider\n- Role-based access control (admin/student roles)\n- Session management with PostgreSQL storage\n- Middleware-based route protection\n\n### QR Code System\n- Hall ticket generation with embedded metadata (student info, exam details, timestamps)\n- QR code validation with expiration checks\n- Secure authentication flow using QR scanning\n\n### AI-Powered Monitoring\n- Browser-based face detection using web APIs\n- Real-time webcam monitoring with violation detection\n- Multiple face detection and attention tracking\n- Configurable sensitivity thresholds\n\n### Real-time Monitoring\n- WebSocket-based live communication between admin dashboard and student clients\n- Real-time incident logging and alerting\n- Live exam session monitoring with status updates\n- Admin dashboard with live statistics and controls\n\n### Exam Security\n- Fullscreen exam mode with exit prevention\n- Tab switching detection and logging\n- Camera monitoring throughout exam duration\n- Automatic security incident creation and escalation\n\n## External Dependencies\n\n- **Database**: Neon PostgreSQL serverless database\n- **Authentication**: Replit OAuth service for user authentication\n- **UI Components**: Radix UI primitives for accessible component foundation\n- **Styling**: Tailwind CSS for utility-first styling approach\n- **QR Code Generation**: qrcode library for hall ticket QR generation\n- **Face Detection**: Browser native APIs for real-time face recognition\n- **WebSocket**: Native WebSocket API for real-time communication\n- **File Upload**: Browser File API for identity verification\n- **Session Management**: PostgreSQL-backed sessions via connect-pg-simple","size_bytes":3469},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2766},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        // Custom colors from design\n        'status-online': \"var(--status-online)\",\n        'status-warning': \"var(--status-warning)\",\n        'status-danger': \"var(--status-danger)\",\n        'status-offline': \"var(--status-offline)\",\n      },\n      fontFamily: {\n        sans: [\"Inter\", \"ui-sans-serif\", \"system-ui\"],\n      },\n      spacing: {\n        '75': '18.75rem', // 300px for QR scanner\n      },\n      borderWidth: {\n        '3': '3px',\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n        \"pulse-green\": {\n          \"0%, 100%\": { opacity: \"1\" },\n          \"50%\": { opacity: \"0.7\" },\n        },\n        \"pulse-red\": {\n          \"0%, 100%\": { backgroundColor: \"hsl(0, 84%, 60%)\" },\n          \"50%\": { backgroundColor: \"hsl(0, 73%, 53%)\" },\n        },\n        \"slide-up\": {\n          from: { \n            transform: \"translateY(100%)\", \n            opacity: \"0\" \n          },\n          to: { \n            transform: \"translateY(0)\", \n            opacity: \"1\" \n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n        \"pulse-green\": \"pulse-green 2s infinite\",\n        \"pulse-red\": \"pulse-red 1s infinite\",\n        \"slide-up\": \"slide-up 0.3s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":3281},"server/ai-verification.ts":{"content":"import OpenAI from \"openai\";\n\n// the newest OpenAI model is \"gpt-5\" which was released August 7, 2025. do not change this unless explicitly requested by the user\nconst openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n\nexport interface IDVerificationResult {\n  isValid: boolean;\n  confidence: number;\n  extractedData: {\n    name?: string;\n    dateOfBirth?: string;\n    idNumber?: string;\n    documentType?: string;\n  };\n  faceMatch: {\n    matches: boolean;\n    confidence: number;\n  };\n  reasons: string[];\n}\n\nexport async function verifyIDDocument(\n  idCardImage: string, // base64 image\n  selfieImage: string,  // base64 image\n  expectedName: string,\n  expectedIdNumber?: string\n): Promise<IDVerificationResult> {\n  try {\n    // Ultra-fast verification with 8-second timeout\n    const verificationPromise = openai.chat.completions.create({\n      model: \"gpt-5\",\n      messages: [\n        {\n          role: \"system\",\n          content: `Fast ID checker. Extract name from ID and check if faces match. Reply with JSON:\n{\n  \"name\": \"name from ID\",\n  \"faceMatch\": boolean,\n  \"passed\": boolean\n}`\n        },\n        {\n          role: \"user\",\n          content: [\n            {\n              type: \"text\",\n              text: `Extract name from ID and check if faces match. Expected: \"${expectedName}\"`\n            },\n            {\n              type: \"image_url\",\n              image_url: {\n                url: `data:image/jpeg;base64,${idCardImage}`\n              }\n            },\n            {\n              type: \"image_url\",\n              image_url: {\n                url: `data:image/jpeg;base64,${selfieImage}`\n              }\n            }\n          ]\n        }\n      ],\n      response_format: { type: \"json_object\" },\n      max_tokens: 150 // Minimal response for speed\n    });\n\n    // 8-second timeout for fast processing\n    const timeoutPromise = new Promise((_, reject) => \n      setTimeout(() => reject(new Error('Verification timeout')), 8000)\n    );\n\n    const verificationResponse = await Promise.race([verificationPromise, timeoutPromise]) as any;\n\n    const result = JSON.parse(verificationResponse.choices[0].message.content || '{}');\n\n    // Fast validation logic with lenient matching\n    const reasons: string[] = [];\n    let isValid = false;\n    let confidence = 0.6; // Default confidence\n    \n    // Check name match with secure threshold (80% for security)\n    if (result.name && expectedName) {\n      const nameSimilarity = calculateNameSimilarity(result.name.toLowerCase(), expectedName.toLowerCase());\n      if (nameSimilarity >= 0.8) { // Secure threshold\n        isValid = true;\n        confidence = nameSimilarity;\n        reasons.push(`Name match found: \"${result.name}\" ≈ \"${expectedName}\"`);\n      } else {\n        reasons.push(`Name similarity too low: ${Math.round(nameSimilarity * 100)}% (need 80%)`);\n      }\n    }\n\n    // Require BOTH AI approval AND face match for security\n    if (result.passed && result.faceMatch && isValid) {\n      confidence = Math.max(confidence, 0.8);\n      reasons.push(\"AI verification passed with face match and name verification\");\n    } else {\n      isValid = false;\n      if (!result.passed) reasons.push(\"AI verification failed\");\n      if (!result.faceMatch) reasons.push(\"Face match failed\");\n    }\n\n    return {\n      isValid,\n      confidence,\n      extractedData: {\n        name: result.name || \"Unknown\",\n        documentType: \"ID Document\",\n        idNumber: expectedIdNumber,\n        dateOfBirth: undefined\n      },\n      faceMatch: {\n        matches: result.faceMatch || false,\n        confidence: confidence\n      },\n      reasons: reasons.length > 0 ? reasons : [\"Quick verification completed\"]\n    };\n\n  } catch (error) {\n    console.error(\"ID verification error:\", error);\n    \n    // Secure timeout handling: No auto-approval in production\n    if (error instanceof Error && error.message && error.message.includes('timeout')) {\n      console.log(\"AI verification timed out - security failure\");\n      \n      // NEVER auto-approve in production for security\n      return {\n        isValid: false,\n        confidence: 0,\n        extractedData: {\n          name: undefined,\n          documentType: undefined,\n          idNumber: expectedIdNumber,\n          dateOfBirth: undefined\n        },\n        faceMatch: {\n          matches: false,\n          confidence: 0\n        },\n        reasons: [\"Verification timed out - please try again or contact support\"]\n      };\n    }\n    \n    return {\n      isValid: false,\n      confidence: 0,\n      extractedData: {},\n      faceMatch: { matches: false, confidence: 0 },\n      reasons: [`Verification failed: ${error instanceof Error ? error.message : 'Unknown error'}`]\n    };\n  }\n}\n\n// Simple name similarity calculation using Levenshtein distance\nfunction calculateNameSimilarity(name1: string, name2: string): number {\n  const longer = name1.length > name2.length ? name1 : name2;\n  const shorter = name1.length > name2.length ? name2 : name1;\n  \n  if (longer.length === 0) return 1.0;\n  \n  const distance = levenshteinDistance(longer, shorter);\n  return (longer.length - distance) / longer.length;\n}\n\nfunction levenshteinDistance(str1: string, str2: string): number {\n  const matrix = Array(str2.length + 1).fill(null).map(() => Array(str1.length + 1).fill(null));\n  \n  for (let i = 0; i <= str1.length; i++) matrix[0][i] = i;\n  for (let j = 0; j <= str2.length; j++) matrix[j][0] = j;\n  \n  for (let j = 1; j <= str2.length; j++) {\n    for (let i = 1; i <= str1.length; i++) {\n      const indicator = str1[i - 1] === str2[j - 1] ? 0 : 1;\n      matrix[j][i] = Math.min(\n        matrix[j][i - 1] + 1,     // deletion\n        matrix[j - 1][i] + 1,     // insertion\n        matrix[j - 1][i - 1] + indicator   // substitution\n      );\n    }\n  }\n  \n  return matrix[str2.length][str1.length];\n}","size_bytes":5823},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    // Fix Vite HMR WebSocket configuration for Replit environment by disabling HMR\n    app.all('/@vite/client', (req, res) => {\n      res.type('application/javascript');\n      res.set('Cache-Control', 'no-store');\n      res.send(`\n        export function createHotContext(){\n          const hot={\n            on(){},off(){},emit(){},dispose(){},prune(){},\n            invalidate(){},accept(){},decline(){},data:null,\n            send(){},_notifyListeners(){},_queueUpdate(){}\n          };\n          return hot;\n        }\n        export function updateStyle(){}\n        export function removeStyle(){}\n        export function injectQuery(url){ return url; }\n        export const __HMR_PORT__ = null;\n        export const __HMR_HOSTNAME__ = null;\n        export default {};\n        // Provide module specifier resolution fallback\n        if (typeof window !== 'undefined') {\n          window.__hmr_import = function(id) { \n            if (id === 'undefined') return Promise.resolve({});\n            return import(id).catch(() => ({})); \n          };\n        }\n      `);\n    });\n    \n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":3148},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\n// Extend session interface to include requestedRole\ndeclare module \"express-session\" {\n  interface SessionData {\n    requestedRole?: string;\n  }\n}\n\n// REPLIT_DOMAINS is now optional - we'll build callback URLs dynamically per request\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  \n  // Production guard: Require DATABASE_URL in production\n  if (process.env.NODE_ENV === 'production' && !process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL is required in production for session persistence. Please configure a PostgreSQL database.\");\n  }\n  \n  // Use PostgreSQL store if DATABASE_URL is available, otherwise fallback to MemoryStore\n  let sessionStore;\n  if (process.env.DATABASE_URL) {\n    const pgStore = connectPg(session);\n    sessionStore = new pgStore({\n      conString: process.env.DATABASE_URL,\n      createTableIfMissing: false,\n      ttl: sessionTtl,\n      tableName: \"sessions\",\n    });\n  } else {\n    // Fallback to MemoryStore for development when DATABASE_URL is not available\n    console.warn(\"DATABASE_URL not available, using MemoryStore for sessions\");\n    sessionStore = undefined; // Use default MemoryStore\n  }\n  \n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production', // Only secure in production\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n  requestedRole?: string\n) {\n  const userData = {\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  };\n\n  // Set role if specifically requested (either for new users or role updates)\n  if (requestedRole === 'admin' || requestedRole === 'student') {\n    (userData as any).role = requestedRole;\n  }\n\n  await storage.upsertUser(userData);\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    // Note: req is not available in verify function, so we'll handle role in callback\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Register a single strategy with a working callback URL\n  const defaultHost = process.env.REPLIT_DOMAINS?.split(',')[0] || \n                     (process.env.REPL_SLUG ? `${process.env.REPL_SLUG}.repl.co` : 'localhost:5000');\n  const strategy = new Strategy(\n    {\n      name: \"replitauth\",\n      config,\n      scope: \"openid email profile offline_access\",\n      callbackURL: `https://${defaultHost}/api/callback`,\n    },\n    verify,\n  );\n  passport.use(strategy);\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    // Store the requested role in session for use after authentication\n    const requestedRole = req.query.role as string;\n    if (requestedRole === 'admin' || requestedRole === 'student') {\n      req.session.requestedRole = requestedRole;\n    }\n    \n    passport.authenticate(\"replitauth\", {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    passport.authenticate(\"replitauth\", {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    }, async (err: any, user: any) => {\n      if (err) return next(err);\n      if (!user) return res.redirect(\"/api/login\");\n      \n      // Handle role assignment after successful authentication\n      const requestedRole = req.session.requestedRole;\n      if (requestedRole && user) {\n        const claims = (user as any).claims;\n        if (claims) {\n          await upsertUser(claims, requestedRole);\n        }\n        delete req.session.requestedRole; // Clean up\n      }\n      \n      req.logIn(user, (err) => {\n        if (err) return next(err);\n        res.redirect(\"/\");\n      });\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":6346},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { WebSocketServer, WebSocket } from \"ws\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./auth\";\nimport { insertHallTicketSchema, clientHallTicketSchema, insertExamSessionSchema, insertSecurityIncidentSchema, insertMonitoringLogSchema, insertQuestionSchema } from \"@shared/schema\";\nimport QRCode from \"qrcode\";\nimport { nanoid } from \"nanoid\";\nimport { verifyIDDocument } from \"./ai-verification\";\nimport { extractNameFromDocument } from \"./simple-name-verification\";\n\ninterface WebSocketClient extends WebSocket {\n  sessionId?: string;\n  userId?: string;\n  type?: 'admin' | 'student';\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  await setupAuth(app);\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Hall ticket routes\n  app.post('/api/hall-tickets', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const clientData = clientHallTicketSchema.parse(req.body);\n      const hallTicketId = `HT${new Date().getFullYear()}${nanoid(8).toUpperCase()}`;\n      \n      // Generate QR code data\n      const qrData = JSON.stringify({\n        hallTicketId,\n        rollNumber: clientData.rollNumber,\n        examName: clientData.examName,\n        timestamp: new Date().getTime()\n      });\n\n      const hallTicket = await storage.createHallTicket({\n        hallTicketId,\n        examName: clientData.examName,\n        examDate: new Date(clientData.examDate), // Convert string to Date\n        duration: clientData.duration,\n        totalQuestions: clientData.totalQuestions,\n        rollNumber: clientData.rollNumber,\n        studentName: clientData.studentName,\n        studentEmail: clientData.studentEmail,\n        qrCodeData: qrData,\n        isActive: true,\n        createdBy: userId,\n      });\n\n      res.json(hallTicket);\n    } catch (error) {\n      console.error(\"Error creating hall ticket:\", error);\n      res.status(500).json({ message: \"Failed to create hall ticket\" });\n    }\n  });\n\n  app.get('/api/hall-tickets', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const hallTickets = await storage.getHallTicketsByCreator(userId);\n      res.json(hallTickets);\n    } catch (error) {\n      console.error(\"Error fetching hall tickets:\", error);\n      res.status(500).json({ message: \"Failed to fetch hall tickets\" });\n    }\n  });\n\n  app.get('/api/hall-tickets/:id/qr', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const hallTicket = await storage.getHallTicketById(id);\n      \n      if (!hallTicket) {\n        return res.status(404).json({ message: \"Hall ticket not found\" });\n      }\n\n      const qrCodeUrl = await QRCode.toDataURL(hallTicket.qrCodeData, {\n        width: 300,\n        margin: 2,\n      });\n\n      res.json({ qrCodeUrl });\n    } catch (error) {\n      console.error(\"Error generating QR code:\", error);\n      res.status(500).json({ message: \"Failed to generate QR code\" });\n    }\n  });\n\n  app.patch('/api/hall-tickets/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const userId = req.user.claims.sub;\n      \n      const user = await storage.getUser(userId);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const updates = req.body;\n      const updatedTicket = await storage.updateHallTicket(id, updates);\n      res.json(updatedTicket);\n    } catch (error) {\n      console.error(\"Error updating hall ticket:\", error);\n      res.status(500).json({ message: \"Failed to update hall ticket\" });\n    }\n  });\n\n  app.delete('/api/hall-tickets/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const userId = req.user.claims.sub;\n      \n      const user = await storage.getUser(userId);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      await storage.deleteHallTicket(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting hall ticket:\", error);\n      res.status(500).json({ message: \"Failed to delete hall ticket\" });\n    }\n  });\n\n  // Student authentication routes\n  app.post('/api/auth/verify-hall-ticket', async (req, res) => {\n    try {\n      const { qrData, rollNumber, hallTicketId } = req.body;\n      \n      let hallTicket;\n      \n      // If hallTicketId is provided (manual entry), validate by hall ticket ID\n      if (hallTicketId) {\n        hallTicket = await storage.getHallTicketByIdAndRoll(hallTicketId, rollNumber);\n        \n        if (!hallTicket) {\n          return res.status(400).json({ message: \"Invalid details\" });\n        }\n      } else if (qrData) {\n        // QR code validation\n        hallTicket = await storage.getHallTicketByQR(qrData);\n        if (!hallTicket) {\n          return res.status(404).json({ message: \"Invalid hall ticket\" });\n        }\n\n        if (hallTicket.rollNumber !== rollNumber) {\n          return res.status(400).json({ message: \"Roll number mismatch\" });\n        }\n      } else {\n        return res.status(400).json({ message: \"Either QR data or hall ticket ID is required\" });\n      }\n\n      res.json({\n        valid: true,\n        hallTicket: {\n          id: hallTicket.id,\n          hallTicketId: hallTicket.hallTicketId,\n          examName: hallTicket.examName,\n          studentName: hallTicket.studentName,\n          rollNumber: hallTicket.rollNumber,\n          examDate: hallTicket.examDate,\n          duration: hallTicket.duration,\n        }\n      });\n    } catch (error) {\n      console.error(\"Error verifying hall ticket:\", error);\n      res.status(500).json({ message: \"Failed to verify hall ticket\" });\n    }\n  });\n\n  // Exam session routes\n  // Student exam session creation (no auth required - validated via hall ticket)\n  app.post('/api/exam-sessions', async (req, res) => {\n    try {\n      // Validate hall ticket exists and is active first\n      const hallTicket = await storage.getHallTicketById(req.body.hallTicketId);\n      if (!hallTicket || !hallTicket.isActive) {\n        return res.status(400).json({ message: \"Invalid or inactive hall ticket\" });\n      }\n\n      // For students, use hall ticket roll number as studentId (since they don't have Replit auth)\n      const studentId = `student_${hallTicket.rollNumber}`;\n      \n      // Create or get the student user record\n      let studentUser = await storage.getUser(studentId);\n      if (!studentUser) {\n        studentUser = await storage.upsertUser({\n          id: studentId,\n          email: hallTicket.studentEmail,\n          firstName: hallTicket.studentName.split(' ')[0],\n          lastName: hallTicket.studentName.split(' ').slice(1).join(' ') || '',\n          role: 'student',\n        });\n      }\n      \n      // Prepare data with studentId and convert startTime to Date\n      const sessionData = {\n        ...req.body,\n        studentId: studentId,\n        startTime: req.body.startTime ? new Date(req.body.startTime) : new Date(),\n      };\n\n      // Now validate with schema\n      const data = insertExamSessionSchema.parse(sessionData);\n      \n      // Check if session already exists\n      const existingSession = await storage.getExamSessionByStudent(studentId, data.hallTicketId);\n      if (existingSession) {\n        return res.json(existingSession);\n      }\n\n      // Get randomized questions for this exam\n      let examQuestions = await storage.getRandomQuestions(hallTicket.examName, hallTicket.totalQuestions);\n      \n      // If no questions found for specific exam name, fallback to any available questions\n      if (!examQuestions || examQuestions.length === 0) {\n        console.log(`No questions found for \"${hallTicket.examName}\", trying fallback to all questions`);\n        const allQuestions = await storage.getAllQuestions();\n        \n        if (allQuestions.length === 0) {\n          return res.status(400).json({ \n            message: \"No questions available in the system. Please contact the administrator to add questions.\",\n            error: \"NO_QUESTIONS_IN_SYSTEM\"\n          });\n        }\n        \n        // Use random questions from all available\n        const shuffled = allQuestions.sort(() => 0.5 - Math.random());\n        const limit = Math.min(hallTicket.totalQuestions || 20, allQuestions.length);\n        examQuestions = shuffled.slice(0, limit);\n        \n        console.log(`Using ${examQuestions.length} fallback questions for exam`);\n      }\n      \n      const questionIds = examQuestions.map(q => q.id);\n\n      // Add questionIds to the session data\n      const sessionDataWithQuestions = {\n        ...data,\n        questionIds: questionIds\n      };\n\n      const examSession = await storage.createExamSession(sessionDataWithQuestions);\n\n      res.json(examSession);\n    } catch (error) {\n      console.error(\"Error creating exam session:\", error);\n      res.status(500).json({ message: \"Failed to create exam session\" });\n    }\n  });\n\n  app.get('/api/exam-sessions/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const session = await storage.getExamSession(id);\n      \n      if (!session) {\n        return res.status(404).json({ message: \"Exam session not found\" });\n      }\n\n      res.json(session);\n    } catch (error) {\n      console.error(\"Error fetching exam session:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam session\" });\n    }\n  });\n\n  app.patch('/api/exam-sessions/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const updates = req.body;\n      \n      const session = await storage.updateExamSession(id, updates);\n      res.json(session);\n    } catch (error) {\n      console.error(\"Error updating exam session:\", error);\n      res.status(500).json({ message: \"Failed to update exam session\" });\n    }\n  });\n\n  // Get questions for a specific exam session (no auth required - students use hall tickets)\n  app.get('/api/exam-sessions/:id/questions', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const session = await storage.getExamSession(id);\n      \n      if (!session) {\n        return res.status(404).json({ message: \"Exam session not found\" });\n      }\n\n      // Get the questions based on the session's questionIds\n      const questionIds = session.questionIds as string[];\n      if (!questionIds || !Array.isArray(questionIds) || questionIds.length === 0) {\n        return res.status(400).json({ \n          message: \"No questions assigned to this exam session\",\n          error: \"NO_QUESTIONS_ASSIGNED\"\n        });\n      }\n\n      // Fetch questions but don't return correct answers to students\n      const allQuestions = await storage.getAllQuestions();\n      const sessionQuestions = allQuestions\n        .filter(q => questionIds.includes(q.id))\n        .map(q => ({\n          id: q.id,\n          questionText: q.questionText,\n          options: q.options,\n          questionType: q.questionType,\n          marks: q.marks\n          // Exclude correctAnswer for security\n        }));\n\n      res.json(sessionQuestions);\n    } catch (error) {\n      console.error(\"Error fetching session questions:\", error);\n      res.status(500).json({ message: \"Failed to fetch session questions\" });\n    }\n  });\n\n  // Submit exam session\n  app.post('/api/exam-sessions/:id/submit', async (req, res) => {\n    try {\n      const { id } = req.params;\n      const { answers } = req.body;\n      \n      const session = await storage.getExamSession(id);\n      if (!session) {\n        return res.status(404).json({ message: \"Exam session not found\" });\n      }\n\n      // Update session with final answers and mark as submitted\n      const updatedSession = await storage.updateExamSession(id, {\n        answers: answers,\n        status: 'submitted',\n        endTime: new Date()\n      });\n\n      res.json({ \n        success: true, \n        message: \"Exam submitted successfully\",\n        session: updatedSession \n      });\n    } catch (error) {\n      console.error(\"Error submitting exam:\", error);\n      res.status(500).json({ message: \"Failed to submit exam\" });\n    }\n  });\n\n  // Security incident routes\n  app.post('/api/security-incidents', isAuthenticated, async (req: any, res) => {\n    try {\n      const data = insertSecurityIncidentSchema.parse(req.body);\n      const incident = await storage.createSecurityIncident(data);\n      \n      // Broadcast to admin clients\n      wss.clients.forEach((client: WebSocketClient) => {\n        if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n          client.send(JSON.stringify({\n            type: 'security_incident',\n            data: incident\n          }));\n        }\n      });\n\n      res.json(incident);\n    } catch (error) {\n      console.error(\"Error creating security incident:\", error);\n      res.status(500).json({ message: \"Failed to create security incident\" });\n    }\n  });\n\n\n  // Monitoring routes  \n  app.post('/api/monitoring-logs', async (req, res) => {\n    try {\n      const data = insertMonitoringLogSchema.parse(req.body);\n      const log = await storage.createMonitoringLog(data);\n      res.json(log);\n    } catch (error) {\n      console.error(\"Error creating monitoring log:\", error);\n      res.status(500).json({ message: \"Failed to create monitoring log\" });\n    }\n  });\n\n  app.get('/api/monitoring-logs/:sessionId', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.claims.sub);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const { sessionId } = req.params;\n      const logs = await storage.getMonitoringLogs(sessionId);\n      res.json(logs);\n    } catch (error) {\n      console.error(\"Error fetching monitoring logs:\", error);\n      res.status(500).json({ message: \"Failed to fetch monitoring logs\" });\n    }\n  });\n\n  app.get('/api/exam-stats', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.claims.sub);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const stats = await storage.getExamStats();\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Error fetching exam stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam stats\" });\n    }\n  });\n\n  app.get('/api/exam-sessions', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.claims.sub);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const sessions = await storage.getAllExamSessions();\n      res.json(sessions);\n    } catch (error) {\n      console.error(\"Error fetching exam sessions:\", error);\n      res.status(500).json({ message: \"Failed to fetch exam sessions\" });\n    }\n  });\n\n  app.get('/api/active-sessions', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.claims.sub);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const sessions = await storage.getActiveExamSessions();\n      res.json(sessions);\n    } catch (error) {\n      console.error(\"Error fetching active sessions:\", error);\n      res.status(500).json({ message: \"Failed to fetch active sessions\" });\n    }\n  });\n\n  // Security incident routes\n  app.get('/api/security-incidents', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.claims.sub);\n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const incidents = await storage.getSecurityIncidents();\n      res.json(incidents);\n    } catch (error) {\n      console.error(\"Error fetching security incidents:\", error);\n      res.status(500).json({ message: \"Failed to fetch security incidents\" });\n    }\n  });\n\n  app.patch('/api/security-incidents/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const user = await storage.getUser(req.user.claims.sub);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const updates = req.body;\n      // Add resolvedAt timestamp on the server side to avoid serialization issues\n      if (updates.isResolved) {\n        updates.resolvedAt = new Date();\n      }\n      const updatedIncident = await storage.updateSecurityIncident(id, updates);\n      res.json(updatedIncident);\n    } catch (error) {\n      console.error(\"Error updating security incident:\", error);\n      res.status(500).json({ message: \"Failed to update security incident\" });\n    }\n  });\n\n  // Question management routes\n  app.post('/api/questions', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const data = insertQuestionSchema.parse(req.body);\n      const question = await storage.createQuestion(data);\n      res.json(question);\n    } catch (error) {\n      console.error(\"Error creating question:\", error);\n      res.status(500).json({ message: \"Failed to create question\" });\n    }\n  });\n\n  app.get('/api/questions', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const questions = await storage.getAllQuestions();\n      res.json(questions);\n    } catch (error) {\n      console.error(\"Error fetching questions:\", error);\n      res.status(500).json({ message: \"Failed to fetch questions\" });\n    }\n  });\n\n  app.put('/api/questions/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const { id } = req.params;\n      const data = insertQuestionSchema.parse(req.body);\n      const question = await storage.updateQuestion(id, data);\n      res.json(question);\n    } catch (error) {\n      console.error(\"Error updating question:\", error);\n      res.status(500).json({ message: \"Failed to update question\" });\n    }\n  });\n\n  app.delete('/api/questions/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      \n      if (!user || user.role !== 'admin') {\n        return res.status(403).json({ message: \"Admin access required\" });\n      }\n\n      const { id } = req.params;\n      await storage.deleteQuestion(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error deleting question:\", error);\n      res.status(500).json({ message: \"Failed to delete question\" });\n    }\n  });\n\n  // AI-powered ID verification endpoint\n  // Simple name-based verification route (new simplified system)\n  app.post('/api/verify-name', async (req, res) => {\n    try {\n      const { idCardImage, expectedName } = req.body;\n      \n      if (!idCardImage || !expectedName) {\n        return res.status(400).json({ \n          message: \"Missing required fields: idCardImage and expectedName\" \n        });\n      }\n      \n      console.log(\"Starting simple name verification for:\", expectedName);\n      \n      const result = await extractNameFromDocument(idCardImage, expectedName);\n      \n      res.json({\n        isValid: result.isValid,\n        confidence: result.confidence,\n        extractedName: result.extractedName,\n        reason: result.reason\n      });\n      \n    } catch (error) {\n      console.error(\"Name verification error:\", error);\n      res.status(500).json({ \n        message: \"Verification failed. Please try again.\",\n        error: process.env.NODE_ENV === 'development' ? (error as Error)?.message : undefined\n      });\n    }\n  });\n\n  // Old complex verification route (kept for fallback)\n  app.post('/api/verify-identity', async (req, res) => {\n    try {\n      const { idCardImage, selfieImage, expectedName, expectedIdNumber, hallTicketId } = req.body;\n      \n      if (!idCardImage || !selfieImage || !expectedName) {\n        return res.status(400).json({ \n          message: \"Missing required fields: idCardImage, selfieImage, and expectedName are required\" \n        });\n      }\n\n      // Verify hall ticket exists if provided\n      if (hallTicketId) {\n        const hallTicket = await storage.getHallTicketById(hallTicketId);\n        if (!hallTicket || !hallTicket.isActive) {\n          return res.status(400).json({ message: \"Invalid or inactive hall ticket\" });\n        }\n      }\n\n      // Perform AI verification\n      const verificationResult = await verifyIDDocument(\n        idCardImage,\n        selfieImage,\n        expectedName,\n        expectedIdNumber\n      );\n\n      res.json(verificationResult);\n    } catch (error) {\n      console.error(\"Identity verification error:\", error);\n      res.status(500).json({ \n        message: \"Identity verification failed\",\n        error: error.message \n      });\n    }\n  });\n\n  // Create HTTP server\n  const httpServer = createServer(app);\n\n  // Create WebSocket server\n  const wss = new WebSocketServer({ \n    server: httpServer, \n    path: '/ws' \n  });\n\n  wss.on('connection', (ws: WebSocketClient) => {\n    ws.on('message', async (message) => {\n      try {\n        const data = JSON.parse(message.toString());\n        \n        if (data.type === 'auth') {\n          ws.userId = data.userId;\n          ws.type = data.userType;\n          ws.sessionId = data.sessionId;\n        }\n        \n        if (data.type === 'student_status_update') {\n          // Broadcast to admin clients\n          wss.clients.forEach((client: WebSocketClient) => {\n            if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n              client.send(JSON.stringify({\n                type: 'student_status',\n                data: data.payload\n              }));\n            }\n          });\n        }\n        \n        if (data.type === 'face_detection_update') {\n          // Log monitoring data\n          if (data.sessionId) {\n            await storage.createMonitoringLog({\n              sessionId: data.sessionId,\n              eventType: 'face_detected',\n              eventData: data.payload\n            });\n          }\n        }\n\n        if (data.type === 'video_snapshot') {\n          // Broadcast video snapshot to admin clients for live monitoring\n          wss.clients.forEach((client: WebSocketClient) => {\n            if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n              client.send(JSON.stringify({\n                type: 'video_feed',\n                data: {\n                  sessionId: data.data.sessionId,\n                  studentId: data.data.studentId,\n                  studentName: data.data.studentName,\n                  rollNumber: data.data.rollNumber,\n                  snapshot: data.data.snapshot,\n                  timestamp: data.data.timestamp\n                }\n              }));\n            }\n          });\n          \n          // Log to monitoring logs as fallback\n          if (data.data.sessionId) {\n            await storage.createMonitoringLog({\n              sessionId: data.data.sessionId,\n              eventType: 'video_snapshot',\n              eventData: { \n                studentId: data.data.studentId,\n                timestamp: data.data.timestamp\n              }\n            });\n          }\n        }\n        \n        // Handle security violations from students\n        if (data.type === 'security_violation' || data.type === 'face_violation') {\n          try {\n            // Validate required fields for incident creation\n            if (!data.data.sessionId || !data.data.incidentType || !data.data.severity || !data.data.description) {\n              console.error('Invalid violation data: missing required fields (sessionId, incidentType, severity, description)');\n              return;\n            }\n            \n            // Validate sender is a student\n            if (ws.type !== 'student') {\n              console.error('Unauthorized: Only students can report violations');\n              return;\n            }\n            \n            // Validate session exists and belongs to the student\n            const session = await storage.getExamSession(data.data.sessionId);\n            if (!session) {\n              console.error(`Session ${data.data.sessionId} not found`);\n              return;\n            }\n            \n            // Rate limiting: check for recent incidents to prevent spam\n            const recentIncidents = await storage.getSecurityIncidents(data.data.sessionId);\n            const oneMinuteAgo = new Date(Date.now() - 60000);\n            const recentSameType = recentIncidents.filter(incident => \n              incident.incidentType === data.data.incidentType && \n              incident.createdAt && new Date(incident.createdAt) > oneMinuteAgo\n            );\n            \n            if (recentSameType.length >= 3) {\n              console.log(`Rate limited: Too many ${data.data.incidentType} incidents for session ${data.data.sessionId}`);\n              return;\n            }\n            \n            // Create security incident\n            const incident = await storage.createSecurityIncident({\n              sessionId: data.data.sessionId,\n              incidentType: data.data.incidentType,\n              severity: data.data.severity,\n              description: data.data.description,\n              metadata: data.data.metadata || {}\n            });\n            \n            // Broadcast to admin clients\n            wss.clients.forEach((client: WebSocketClient) => {\n              if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n                client.send(JSON.stringify({\n                  type: 'security_incident',\n                  data: {\n                    ...incident,\n                    studentName: data.data.studentName,\n                    rollNumber: data.data.rollNumber,\n                    violationType: data.data.incidentType // Use actual incident type, not message type\n                  }\n                }));\n              }\n            });\n            \n            console.log(`Security incident created: ${data.data.incidentType} for session ${data.data.sessionId}`);\n          } catch (error) {\n            console.error('Error creating security incident:', error);\n          }\n        }\n        \n        // Handle student status updates (lightweight monitoring)\n        if (data.type === 'student_status') {\n          try {\n            // Broadcast to admin clients\n            wss.clients.forEach((client: WebSocketClient) => {\n              if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n                client.send(JSON.stringify({\n                  type: 'student_monitoring',\n                  data: data.data\n                }));\n              }\n            });\n          } catch (error) {\n            console.error('Error handling student status:', error);\n          }\n        }\n        \n        // Handle policy updates (exam paused/auto-submitted) - separate from incidents\n        if (data.type === 'policy_update') {\n          try {\n            // Validate basic required fields\n            if (!data.data.sessionId || !data.data.action) {\n              console.error('Invalid policy update: missing sessionId or action');\n              return;\n            }\n            \n            // Broadcast policy update to admin clients\n            wss.clients.forEach((client: WebSocketClient) => {\n              if (client.readyState === WebSocket.OPEN && client.type === 'admin') {\n                client.send(JSON.stringify({\n                  type: 'policy_update',\n                  data: data.data\n                }));\n              }\n            });\n            \n            console.log(`Policy update: ${data.data.action} for session ${data.data.sessionId}`);\n          } catch (error) {\n            console.error('Error handling policy update:', error);\n          }\n        }\n        \n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    });\n\n    ws.on('close', () => {\n      console.log('WebSocket connection closed');\n    });\n  });\n\n  return httpServer;\n}\n","size_bytes":29715},"server/simple-name-verification.ts":{"content":"// Simple name-based verification to replace complex AI system\n// Just extracts name from ID document and compares with hall ticket\n\ninterface NameVerificationResult {\n  isValid: boolean;\n  confidence: number;\n  extractedName?: string;\n  reason: string;\n}\n\n// Simple fuzzy string matching for names\nfunction calculateNameSimilarity(name1: string, name2: string): number {\n  // Normalize names: lowercase, remove extra spaces, common prefixes\n  const normalize = (name: string) => {\n    return name\n      .toLowerCase()\n      .replace(/\\b(mr|mrs|ms|dr|prof)\\b\\.?/g, '') // Remove titles\n      .replace(/[^\\w\\s]/g, '') // Remove punctuation\n      .replace(/\\s+/g, ' ') // Normalize spaces\n      .trim();\n  };\n  \n  const norm1 = normalize(name1);\n  const norm2 = normalize(name2);\n  \n  // Direct match\n  if (norm1 === norm2) return 1.0;\n  \n  // Split into words and check overlap\n  const words1 = norm1.split(' ').filter(w => w.length > 1);\n  const words2 = norm2.split(' ').filter(w => w.length > 1);\n  \n  if (words1.length === 0 || words2.length === 0) return 0;\n  \n  // Count matching words\n  let matches = 0;\n  for (const word1 of words1) {\n    for (const word2 of words2) {\n      if (word1 === word2 || word1.includes(word2) || word2.includes(word1)) {\n        matches++;\n        break;\n      }\n    }\n  }\n  \n  // Return ratio of matching words\n  return matches / Math.max(words1.length, words2.length);\n}\n\n// Simple text extraction from image using browser APIs\nexport async function extractNameFromDocument(\n  imageBase64: string,\n  expectedName: string\n): Promise<NameVerificationResult> {\n  try {\n    console.log(\"Starting simple name extraction...\");\n    \n    // For now, use a basic OCR approach\n    // In production, you could use Tesseract.js or similar client-side OCR\n    // For this demo, we'll simulate extraction and do pattern matching\n    \n    // Convert base64 to image and try to extract text\n    const extractedText = await performBasicOCR(imageBase64);\n    \n    // Look for name patterns in extracted text\n    const extractedName = findNameInText(extractedText);\n    \n    if (!extractedName) {\n      return {\n        isValid: false,\n        confidence: 0,\n        reason: \"Could not extract name from document. Please ensure the image is clear and contains readable text.\"\n      };\n    }\n    \n    // Compare with expected name\n    const similarity = calculateNameSimilarity(extractedName, expectedName);\n    \n    // Accept if similarity is 70% or higher\n    if (similarity >= 0.7) {\n      return {\n        isValid: true,\n        confidence: similarity,\n        extractedName,\n        reason: `Name match found: \"${extractedName}\" matches \"${expectedName}\" (${Math.round(similarity * 100)}% similarity)`\n      };\n    } else {\n      return {\n        isValid: false,\n        confidence: similarity,\n        extractedName,\n        reason: `Name mismatch: extracted \"${extractedName}\" doesn't match \"${expectedName}\" (${Math.round(similarity * 100)}% similarity, need 70%)`\n      };\n    }\n    \n  } catch (error) {\n    console.error(\"Name extraction error:\", error);\n    return {\n      isValid: false,\n      confidence: 0,\n      reason: \"Failed to process document. Please try uploading a clearer image.\"\n    };\n  }\n}\n\n// Realistic OCR using OpenAI Vision for text extraction\nasync function performBasicOCR(imageBase64: string): Promise<string> {\n  try {\n    // Use OpenAI Vision to extract text from the document\n    const OpenAI = require(\"openai\");\n    const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });\n    \n    const response = await openai.chat.completions.create({\n      model: \"gpt-4o-mini\", // Fast model for text extraction\n      messages: [\n        {\n          role: \"system\",\n          content: \"Extract all visible text from this ID document. Return just the raw text, no analysis.\"\n        },\n        {\n          role: \"user\",\n          content: [\n            {\n              type: \"text\",\n              text: \"Extract all text from this ID document:\"\n            },\n            {\n              type: \"image_url\",\n              image_url: {\n                url: `data:image/jpeg;base64,${imageBase64}`\n              }\n            }\n          ]\n        }\n      ],\n      max_tokens: 200 // Just need text extraction\n    });\n\n    return response.choices[0]?.message?.content || \"\";\n    \n  } catch (error) {\n    console.error(\"OCR extraction failed:\", error);\n    // Fallback: return empty string so name matching will fail gracefully\n    return \"\";\n  }\n}\n\n// Extract name patterns from OCR text\nfunction findNameInText(text: string): string | null {\n  // Common name patterns in ID documents\n  const namePatterns = [\n    /name[:\\s]+([a-zA-Z\\s]+)/i,\n    /^([A-Z][a-z]+ [A-Z][a-z]+)/m, // First Last pattern\n    /([A-Z][A-Z\\s]+)/, // All caps name\n  ];\n  \n  for (const pattern of namePatterns) {\n    const match = text.match(pattern);\n    if (match && match[1]) {\n      const name = match[1].trim();\n      // Filter out common non-name text\n      if (name.length > 3 && !name.match(/\\d/) && !name.includes('GOVERNMENT')) {\n        return name;\n      }\n    }\n  }\n  \n  return null;\n}","size_bytes":5120},"server/storage.ts":{"content":"import {\n  users,\n  hallTickets,\n  examSessions,\n  securityIncidents,\n  monitoringLogs,\n  questions,\n  type User,\n  type UpsertUser,\n  type HallTicket,\n  type InsertHallTicket,\n  type ExamSession,\n  type InsertExamSession,\n  type SecurityIncident,\n  type InsertSecurityIncident,\n  type MonitoringLog,\n  type InsertMonitoringLog,\n  type Question,\n  type InsertQuestion,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, count, sql } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations (required for Replit Auth)\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Hall ticket operations\n  createHallTicket(hallTicket: InsertHallTicket): Promise<HallTicket>;\n  getHallTicketByQR(qrData: string): Promise<HallTicket | undefined>;\n  getHallTicketById(id: string): Promise<HallTicket | undefined>;\n  getHallTicketsByCreator(creatorId: string): Promise<HallTicket[]>;\n  updateHallTicket(id: string, updates: Partial<InsertHallTicket>): Promise<HallTicket>;\n  \n  // Exam session operations\n  createExamSession(session: InsertExamSession): Promise<ExamSession>;\n  getExamSession(id: string): Promise<ExamSession | undefined>;\n  getExamSessionByStudent(studentId: string, hallTicketId: string): Promise<ExamSession | undefined>;\n  updateExamSession(id: string, updates: Partial<InsertExamSession>): Promise<ExamSession>;\n  getActiveExamSessions(): Promise<ExamSession[]>;\n  \n  // Security incident operations\n  createSecurityIncident(incident: InsertSecurityIncident): Promise<SecurityIncident>;\n  getSecurityIncidents(sessionId?: string): Promise<SecurityIncident[]>;\n  updateSecurityIncident(id: string, updates: Partial<InsertSecurityIncident>): Promise<SecurityIncident>;\n  getActiveSecurityIncidents(): Promise<SecurityIncident[]>;\n  \n  // Monitoring log operations\n  createMonitoringLog(log: InsertMonitoringLog): Promise<MonitoringLog>;\n  getMonitoringLogs(sessionId: string): Promise<MonitoringLog[]>;\n  \n  // Question operations\n  createQuestion(question: InsertQuestion): Promise<Question>;\n  getAllQuestions(): Promise<Question[]>;\n  updateQuestion(id: string, data: InsertQuestion): Promise<Question>;\n  deleteQuestion(id: string): Promise<void>;\n  getQuestionsByExam(examName: string): Promise<Question[]>;\n  getRandomQuestions(examName: string, limit: number): Promise<Question[]>;\n  \n  // Analytics\n  getExamStats(): Promise<{\n    activeStudents: number;\n    totalSessions: number;\n    securityAlerts: number;\n    averageProgress: number;\n  }>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  // Hall ticket operations\n  async createHallTicket(hallTicket: InsertHallTicket): Promise<HallTicket> {\n    const [ticket] = await db.insert(hallTickets).values(hallTicket).returning();\n    return ticket;\n  }\n\n  async getHallTicketByQR(qrData: string): Promise<HallTicket | undefined> {\n    const [ticket] = await db\n      .select()\n      .from(hallTickets)\n      .where(and(eq(hallTickets.qrCodeData, qrData), eq(hallTickets.isActive, true)));\n    return ticket;\n  }\n\n  async getHallTicketById(id: string): Promise<HallTicket | undefined> {\n    const [ticket] = await db.select().from(hallTickets).where(eq(hallTickets.id, id));\n    return ticket;\n  }\n\n  async getHallTicketsByCreator(creatorId: string): Promise<HallTicket[]> {\n    return await db\n      .select()\n      .from(hallTickets)\n      .where(eq(hallTickets.createdBy, creatorId))\n      .orderBy(desc(hallTickets.createdAt));\n  }\n\n  async updateHallTicket(id: string, updates: Partial<InsertHallTicket>): Promise<HallTicket> {\n    const [ticket] = await db\n      .update(hallTickets)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(hallTickets.id, id))\n      .returning();\n    return ticket;\n  }\n\n  async getHallTicketByIdAndRoll(hallTicketId: string, rollNumber: string): Promise<HallTicket | undefined> {\n    const [ticket] = await db\n      .select()\n      .from(hallTickets)\n      .where(and(\n        eq(hallTickets.hallTicketId, hallTicketId),\n        eq(hallTickets.rollNumber, rollNumber),\n        eq(hallTickets.isActive, true)\n      ));\n    return ticket;\n  }\n\n  async deleteHallTicket(id: string): Promise<void> {\n    // First, get all exam sessions that reference this hall ticket\n    const relatedSessions = await db\n      .select()\n      .from(examSessions)\n      .where(eq(examSessions.hallTicketId, id));\n\n    // Delete security incidents for each related exam session (cascade)\n    for (const session of relatedSessions) {\n      await db.delete(securityIncidents).where(eq(securityIncidents.sessionId, session.id));\n      await db.delete(monitoringLogs).where(eq(monitoringLogs.sessionId, session.id));\n    }\n\n    // Delete all exam sessions that reference this hall ticket\n    await db.delete(examSessions).where(eq(examSessions.hallTicketId, id));\n\n    // Finally, delete the hall ticket\n    await db.delete(hallTickets).where(eq(hallTickets.id, id));\n  }\n\n  // Exam session operations\n  async createExamSession(session: InsertExamSession): Promise<ExamSession> {\n    const [examSession] = await db.insert(examSessions).values(session).returning();\n    return examSession;\n  }\n\n  async getExamSession(id: string): Promise<ExamSession | undefined> {\n    const [session] = await db.select().from(examSessions).where(eq(examSessions.id, id));\n    return session;\n  }\n\n  async getExamSessionByStudent(studentId: string, hallTicketId: string): Promise<ExamSession | undefined> {\n    const [session] = await db\n      .select()\n      .from(examSessions)\n      .where(and(eq(examSessions.studentId, studentId), eq(examSessions.hallTicketId, hallTicketId)));\n    return session;\n  }\n\n  async updateExamSession(id: string, updates: Partial<InsertExamSession>): Promise<ExamSession> {\n    const [session] = await db\n      .update(examSessions)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(examSessions.id, id))\n      .returning();\n    return session;\n  }\n\n  async getAllExamSessions(): Promise<any[]> {\n    return await db\n      .select({\n        id: examSessions.id,\n        hallTicketId: examSessions.hallTicketId,\n        studentId: examSessions.studentId,\n        status: examSessions.status,\n        startTime: examSessions.startTime,\n        endTime: examSessions.endTime,\n        currentQuestion: examSessions.currentQuestion,\n        answers: examSessions.answers,\n        questionIds: examSessions.questionIds,\n        timeRemaining: examSessions.timeRemaining,\n        isVerified: examSessions.isVerified,\n        verificationData: examSessions.verificationData,\n        createdAt: examSessions.createdAt,\n        updatedAt: examSessions.updatedAt,\n        // Include user information\n        studentName: users.firstName,\n        studentLastName: users.lastName,\n        studentEmail: users.email\n      })\n      .from(examSessions)\n      .leftJoin(users, eq(users.id, examSessions.studentId))\n      .orderBy(desc(examSessions.startTime));\n  }\n\n  async getActiveExamSessions(): Promise<ExamSession[]> {\n    return await db\n      .select()\n      .from(examSessions)\n      .where(eq(examSessions.status, \"in_progress\"))\n      .orderBy(desc(examSessions.startTime));\n  }\n\n  // Security incident operations\n  async createSecurityIncident(incident: InsertSecurityIncident): Promise<SecurityIncident> {\n    const [securityIncident] = await db.insert(securityIncidents).values(incident).returning();\n    return securityIncident;\n  }\n\n  async getSecurityIncidents(sessionId?: string): Promise<SecurityIncident[]> {\n    const query = db.select().from(securityIncidents);\n    if (sessionId) {\n      return await query.where(eq(securityIncidents.sessionId, sessionId)).orderBy(desc(securityIncidents.createdAt));\n    }\n    return await query.orderBy(desc(securityIncidents.createdAt));\n  }\n\n  async updateSecurityIncident(id: string, updates: Partial<InsertSecurityIncident>): Promise<SecurityIncident> {\n    const [incident] = await db\n      .update(securityIncidents)\n      .set(updates)\n      .where(eq(securityIncidents.id, id))\n      .returning();\n    return incident;\n  }\n\n  async getActiveSecurityIncidents(): Promise<SecurityIncident[]> {\n    return await db\n      .select()\n      .from(securityIncidents)\n      .where(eq(securityIncidents.isResolved, false))\n      .orderBy(desc(securityIncidents.createdAt));\n  }\n\n  // Monitoring log operations\n  async createMonitoringLog(log: InsertMonitoringLog): Promise<MonitoringLog> {\n    const [monitoringLog] = await db.insert(monitoringLogs).values(log).returning();\n    return monitoringLog;\n  }\n\n  async getMonitoringLogs(sessionId: string): Promise<MonitoringLog[]> {\n    return await db\n      .select()\n      .from(monitoringLogs)\n      .where(eq(monitoringLogs.sessionId, sessionId))\n      .orderBy(desc(monitoringLogs.timestamp));\n  }\n\n  // Question operations\n  async createQuestion(question: InsertQuestion): Promise<Question> {\n    const [newQuestion] = await db.insert(questions).values(question).returning();\n    return newQuestion;\n  }\n\n  async getQuestionsByExam(examName: string): Promise<Question[]> {\n    return await db.select().from(questions).where(eq(questions.examName, examName));\n  }\n\n  async getRandomQuestions(examName: string, limit: number): Promise<Question[]> {\n    return await db\n      .select()\n      .from(questions)\n      .where(eq(questions.examName, examName))\n      .orderBy(sql`RANDOM()`)\n      .limit(limit);\n  }\n\n  async getAllQuestions(): Promise<Question[]> {\n    return await db\n      .select()\n      .from(questions)\n      .orderBy(desc(questions.createdAt));\n  }\n\n  async updateQuestion(id: string, data: InsertQuestion): Promise<Question> {\n    const [question] = await db\n      .update(questions)\n      .set(data)\n      .where(eq(questions.id, id))\n      .returning();\n    return question;\n  }\n\n  async deleteQuestion(id: string): Promise<void> {\n    await db.delete(questions).where(eq(questions.id, id));\n  }\n\n  // Analytics\n  async getExamStats(): Promise<{\n    activeStudents: number;\n    totalSessions: number;\n    securityAlerts: number;\n    averageProgress: number;\n  }> {\n    const [activeStudentsResult] = await db\n      .select({ count: count() })\n      .from(examSessions)\n      .where(eq(examSessions.status, \"in_progress\"));\n\n    const [totalSessionsResult] = await db.select({ count: count() }).from(examSessions);\n\n    const [securityAlertsResult] = await db\n      .select({ count: count() })\n      .from(securityIncidents)\n      .where(eq(securityIncidents.isResolved, false));\n\n    const activeSessions = await db\n      .select()\n      .from(examSessions)\n      .where(eq(examSessions.status, \"in_progress\"));\n\n    let averageProgress = 0;\n    if (activeSessions.length > 0) {\n      const totalProgress = activeSessions.reduce((sum, session) => {\n        const progress = session.currentQuestion || 1;\n        return sum + progress;\n      }, 0);\n      averageProgress = Math.round((totalProgress / activeSessions.length) * 2); // Assuming 50 total questions\n    }\n\n    return {\n      activeStudents: activeStudentsResult.count,\n      totalSessions: totalSessionsResult.count,\n      securityAlerts: securityAlertsResult.count,\n      averageProgress,\n    };\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":11727},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport { relations } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  text,\n  integer,\n  boolean,\n  uuid,\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table (required for Replit Auth)\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table (required for Replit Auth)\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  role: varchar(\"role\").notNull().default(\"student\"), // 'admin' | 'student'\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Hall tickets table\nexport const hallTickets = pgTable(\"hall_tickets\", {\n  id: uuid(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  hallTicketId: varchar(\"hall_ticket_id\").notNull().unique(),\n  examName: varchar(\"exam_name\").notNull(),\n  examDate: timestamp(\"exam_date\").notNull(),\n  duration: integer(\"duration\").notNull(), // in minutes\n  totalQuestions: integer(\"total_questions\").notNull(),\n  rollNumber: varchar(\"roll_number\").notNull(),\n  studentName: varchar(\"student_name\").notNull(),\n  studentEmail: varchar(\"student_email\").notNull(),\n  qrCodeData: text(\"qr_code_data\").notNull(),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdBy: varchar(\"created_by\").notNull().references(() => users.id),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Exam sessions table\nexport const examSessions = pgTable(\"exam_sessions\", {\n  id: uuid(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  hallTicketId: uuid(\"hall_ticket_id\").notNull().references(() => hallTickets.id),\n  studentId: varchar(\"student_id\").notNull().references(() => users.id),\n  status: varchar(\"status\").notNull().default(\"not_started\"), // 'not_started' | 'in_progress' | 'paused' | 'completed' | 'submitted'\n  startTime: timestamp(\"start_time\"),\n  endTime: timestamp(\"end_time\"),\n  currentQuestion: integer(\"current_question\").default(1),\n  answers: jsonb(\"answers\").default({}),\n  questionIds: jsonb(\"question_ids\").default([]), // array of question UUIDs for this session\n  timeRemaining: integer(\"time_remaining\"), // in seconds\n  isVerified: boolean(\"is_verified\").default(false),\n  verificationData: jsonb(\"verification_data\"), // photos, ID verification results\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Security incidents table\nexport const securityIncidents = pgTable(\"security_incidents\", {\n  id: uuid(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sessionId: uuid(\"session_id\").notNull().references(() => examSessions.id),\n  incidentType: varchar(\"incident_type\").notNull(), // 'multiple_faces' | 'looking_away' | 'network_disconnect' | 'device_detected'\n  severity: varchar(\"severity\").notNull(), // 'low' | 'medium' | 'high' | 'critical'\n  description: text(\"description\").notNull(),\n  metadata: jsonb(\"metadata\"), // detection confidence, duration, etc.\n  snapshotUrl: varchar(\"snapshot_url\"),\n  isResolved: boolean(\"is_resolved\").default(false),\n  resolvedBy: varchar(\"resolved_by\").references(() => users.id),\n  resolvedAt: timestamp(\"resolved_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Monitoring logs table\nexport const monitoringLogs = pgTable(\"monitoring_logs\", {\n  id: uuid(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  sessionId: uuid(\"session_id\").notNull().references(() => examSessions.id),\n  eventType: varchar(\"event_type\").notNull(), // 'face_detected' | 'attention_warning' | 'network_status' | 'question_answered'\n  eventData: jsonb(\"event_data\"),\n  timestamp: timestamp(\"timestamp\").defaultNow(),\n});\n\n// Questions table\nexport const questions = pgTable(\"questions\", {\n  id: uuid(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  examName: varchar(\"exam_name\").notNull(),\n  questionText: text(\"question_text\").notNull(),\n  options: jsonb(\"options\").notNull(), // array of options\n  correctAnswer: varchar(\"correct_answer\").notNull(),\n  questionType: varchar(\"question_type\").notNull().default(\"multiple_choice\"),\n  difficulty: varchar(\"difficulty\").default(\"medium\"),\n  subject: varchar(\"subject\").notNull(),\n  topic: varchar(\"topic\").notNull(),\n  marks: integer(\"marks\").notNull().default(1),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  createdHallTickets: many(hallTickets),\n  examSessions: many(examSessions),\n  resolvedIncidents: many(securityIncidents),\n}));\n\nexport const hallTicketsRelations = relations(hallTickets, ({ one, many }) => ({\n  createdBy: one(users, {\n    fields: [hallTickets.createdBy],\n    references: [users.id],\n  }),\n  examSessions: many(examSessions),\n}));\n\nexport const examSessionsRelations = relations(examSessions, ({ one, many }) => ({\n  hallTicket: one(hallTickets, {\n    fields: [examSessions.hallTicketId],\n    references: [hallTickets.id],\n  }),\n  student: one(users, {\n    fields: [examSessions.studentId],\n    references: [users.id],\n  }),\n  securityIncidents: many(securityIncidents),\n  monitoringLogs: many(monitoringLogs),\n}));\n\nexport const securityIncidentsRelations = relations(securityIncidents, ({ one }) => ({\n  session: one(examSessions, {\n    fields: [securityIncidents.sessionId],\n    references: [examSessions.id],\n  }),\n  resolvedBy: one(users, {\n    fields: [securityIncidents.resolvedBy],\n    references: [users.id],\n  }),\n}));\n\nexport const monitoringLogsRelations = relations(monitoringLogs, ({ one }) => ({\n  session: one(examSessions, {\n    fields: [monitoringLogs.sessionId],\n    references: [examSessions.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertHallTicketSchema = createInsertSchema(hallTickets).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\n// Client input schema for hall ticket creation (only fields the client sends)\nexport const clientHallTicketSchema = z.object({\n  examName: z.string().min(1, \"Exam name is required\"),\n  examDate: z.string().min(1, \"Exam date is required\"), // Will be converted to Date on server\n  duration: z.number().min(1, \"Duration must be at least 1 minute\"),\n  totalQuestions: z.number().min(1, \"Total questions must be at least 1\"),\n  rollNumber: z.string().min(1, \"Roll number is required\"),\n  studentName: z.string().min(1, \"Student name is required\"),\n  studentEmail: z.string().email(\"Valid email is required\"),\n});\n\nexport const insertExamSessionSchema = createInsertSchema(examSessions).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertSecurityIncidentSchema = createInsertSchema(securityIncidents).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMonitoringLogSchema = createInsertSchema(monitoringLogs).omit({\n  id: true,\n  timestamp: true,\n});\n\nexport const insertQuestionSchema = createInsertSchema(questions).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\n// Types\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type InsertHallTicket = z.infer<typeof insertHallTicketSchema>;\nexport type ClientHallTicket = z.infer<typeof clientHallTicketSchema>;\nexport type HallTicket = typeof hallTickets.$inferSelect;\nexport type InsertExamSession = z.infer<typeof insertExamSessionSchema>;\nexport type ExamSession = typeof examSessions.$inferSelect;\nexport type InsertSecurityIncident = z.infer<typeof insertSecurityIncidentSchema>;\nexport type SecurityIncident = typeof securityIncidents.$inferSelect;\nexport type InsertMonitoringLog = z.infer<typeof insertMonitoringLogSchema>;\nexport type MonitoringLog = typeof monitoringLogs.$inferSelect;\nexport type InsertQuestion = z.infer<typeof insertQuestionSchema>;\nexport type Question = typeof questions.$inferSelect;\n","size_bytes":8310},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/landing\";\nimport Home from \"@/pages/home\";\n\n// Admin pages\nimport AdminLogin from \"@/pages/admin/login\";\nimport HallTicketGeneration from \"@/pages/admin/hall-ticket-generation\";\nimport AdminDashboard from \"@/pages/admin/dashboard\";\nimport MonitoringSystem from \"@/pages/admin/monitoring\";\nimport IncidentManagement from \"@/pages/admin/incidents\";\nimport QuestionManagement from \"@/pages/admin/question-management\";\nimport Results from \"@/pages/admin/results\";\nimport DraftBin from \"@/pages/admin/draft-bin\";\n\n// Student pages\nimport StudentAuthentication from \"@/pages/student/authentication\";\nimport SimpleIdentityVerification from \"@/pages/student/simple-identity-verification\";\nimport ExamMode from \"@/pages/student/exam\";\nimport ExamComplete from \"@/pages/student/exam-complete\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  return (\n    <Switch>\n      {/* Home route - conditional based on auth */}\n      <Route path=\"/\" component={isLoading || !isAuthenticated ? Landing : Home} />\n      \n      {/* Admin login route - always available */}\n      <Route path=\"/admin/login\" component={AdminLogin} />\n      \n      {/* Student routes - always available (they guard themselves) */}\n      <Route path=\"/student/auth\" component={StudentAuthentication} />\n      <Route path=\"/hall-ticket\" component={StudentAuthentication} />\n      <Route path=\"/student/identity-verification\" component={SimpleIdentityVerification} />\n      <Route path=\"/student/exam\" component={ExamMode} />\n      <Route path=\"/exam-complete\" component={ExamComplete} />\n      \n      {/* Admin routes - protected by auth */}\n      {isAuthenticated && (\n        <>\n          <Route path=\"/admin\" component={Home} />\n          <Route path=\"/admin/hall-tickets\" component={HallTicketGeneration} />\n          <Route path=\"/admin/dashboard\" component={AdminDashboard} />\n          <Route path=\"/admin/monitoring\" component={MonitoringSystem} />\n          <Route path=\"/admin/incidents\" component={IncidentManagement} />\n          <Route path=\"/admin/questions\" component={QuestionManagement} />\n          <Route path=\"/admin/results\" component={Results} />\n          <Route path=\"/admin/draft-bin\" component={DraftBin} />\n        </>\n      )}\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2895},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(210, 40%, 98%);\n  --foreground: hsl(222.2, 84%, 4.9%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(222.2, 84%, 4.9%);\n  --primary: hsl(239, 84%, 67%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  --secondary: hsl(262, 83%, 58%);\n  --secondary-foreground: hsl(0, 0%, 100%);\n  --muted: hsl(210, 40%, 96%);\n  --muted-foreground: hsl(215.4, 16.3%, 46.9%);\n  --accent: hsl(187, 85%, 43%);\n  --accent-foreground: hsl(0, 0%, 100%);\n  --destructive: hsl(0, 84%, 60%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --border: hsl(214.3, 31.8%, 91.4%);\n  --input: hsl(214.3, 31.8%, 91.4%);\n  --ring: hsl(239, 84%, 67%);\n  --radius: 12px;\n  \n  /* Custom gradients from design */\n  --gradient-primary: linear-gradient(135deg, hsl(239, 84%, 67%) 0%, hsl(262, 83%, 58%) 100%);\n  --gradient-accent: linear-gradient(135deg, hsl(187, 85%, 43%) 0%, hsl(239, 84%, 67%) 100%);\n  \n  /* Glassmorphism effects */\n  --glass-background: rgba(255, 255, 255, 0.1);\n  --glass-border: rgba(255, 255, 255, 0.2);\n  \n  /* Status colors */\n  --status-online: hsl(142, 76%, 36%);\n  --status-warning: hsl(48, 96%, 53%);\n  --status-danger: hsl(0, 84%, 60%);\n  --status-offline: hsl(215, 14%, 42%);\n}\n\n.dark {\n  --background: hsl(0, 0%, 0%);\n  --foreground: hsl(200, 6.6667%, 91.1765%);\n  --card: hsl(228, 9.8039%, 10%);\n  --card-foreground: hsl(0, 0%, 85.0980%);\n  --popover: hsl(0, 0%, 0%);\n  --popover-foreground: hsl(200, 6.6667%, 91.1765%);\n  --primary: hsl(203.7736, 87.6033%, 52.5490%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  --secondary: hsl(195.0000, 15.3846%, 94.9020%);\n  --secondary-foreground: hsl(210, 25%, 7.8431%);\n  --muted: hsl(0, 0%, 9.4118%);\n  --muted-foreground: hsl(210, 3.3898%, 46.2745%);\n  --accent: hsl(205.7143, 70%, 7.8431%);\n  --accent-foreground: hsl(203.7736, 87.6033%, 52.5490%);\n  --destructive: hsl(356.3033, 90.5579%, 54.3137%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --border: hsl(210, 5.2632%, 14.9020%);\n  --input: hsl(207.6923, 27.6596%, 18.4314%);\n  --ring: hsl(202.8169, 89.1213%, 53.1373%);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    font-family: 'Inter', ui-sans-serif, system-ui;\n  }\n}\n\n@layer components {\n  /* Custom gradient backgrounds */\n  .bg-gradient-primary {\n    background: var(--gradient-primary);\n  }\n  \n  .bg-gradient-accent {\n    background: var(--gradient-accent);\n  }\n  \n  /* Glassmorphism header */\n  .glass-header {\n    background: var(--glass-background);\n    backdrop-filter: blur(10px);\n    border-bottom: 1px solid var(--glass-border);\n  }\n  \n  /* Status indicators */\n  .status-indicator {\n    @apply w-3 h-3 rounded-full inline-block mr-2;\n  }\n  \n  .status-online {\n    background-color: var(--status-online);\n  }\n  \n  .status-warning {\n    background-color: var(--status-warning);\n  }\n  \n  .status-danger {\n    background-color: var(--status-danger);\n  }\n  \n  .status-offline {\n    background-color: var(--status-offline);\n  }\n  \n  /* Video feed styles */\n  .video-feed {\n    @apply rounded-xl overflow-hidden relative;\n  }\n  \n  .video-overlay {\n    @apply absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs;\n  }\n  \n  /* QR Scanner styles */\n  .qr-scanner {\n    @apply w-80 h-80 border-2 border-dashed border-primary rounded-xl flex items-center justify-center bg-muted;\n  }\n  \n  /* Custom animations */\n  .pulse-green {\n    animation: pulse-green 2s infinite;\n  }\n  \n  .pulse-red {\n    animation: pulse-red 1s infinite;\n  }\n  \n  .slide-up {\n    animation: slide-up 0.3s ease-out;\n  }\n  \n  /* Toast styles */\n  .toast {\n    @apply fixed top-5 right-5 bg-card rounded-xl p-4 shadow-2xl border-l-4 z-50 min-w-80;\n  }\n  \n  .toast.success {\n    @apply border-l-green-500;\n  }\n  \n  .toast.warning {\n    @apply border-l-yellow-500;\n  }\n  \n  .toast.error {\n    @apply border-l-red-500;\n  }\n  \n  /* Kiosk mode */\n  .kiosk-mode {\n    @apply fixed inset-0 bg-background z-[999];\n  }\n  \n  /* Data grid responsive */\n  .data-grid {\n    @apply grid gap-4;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n  }\n  \n  @media (min-width: 768px) {\n    .data-grid {\n      grid-template-columns: repeat(2, 1fr);\n    }\n  }\n  \n  @media (min-width: 1024px) {\n    .data-grid {\n      grid-template-columns: repeat(3, 1fr);\n    }\n  }\n  \n  @media (min-width: 1280px) {\n    .data-grid {\n      grid-template-columns: repeat(4, 1fr);\n    }\n  }\n}\n\n@layer utilities {\n  /* Custom keyframes */\n  @keyframes pulse-green {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.7; }\n  }\n  \n  @keyframes pulse-red {\n    0%, 100% { background-color: hsl(0, 84%, 60%); }\n    50% { background-color: hsl(0, 73%, 53%); }\n  }\n  \n  @keyframes slide-up {\n    from { \n      transform: translateY(100%); \n      opacity: 0; \n    }\n    to { \n      transform: translateY(0); \n      opacity: 1; \n    }\n  }\n}\n","size_bytes":5023},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/face-detection.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useFaceDetection } from \"@/hooks/useFaceDetection\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\ninterface FaceDetectionProps {\n  onDetectionChange?: (detection: {\n    faceDetected: boolean;\n    multipleFaces: boolean;\n    lookingAway: boolean;\n    confidence: number;\n  }) => void;\n  showVisualization?: boolean;\n  className?: string;\n  stream?: MediaStream | null;\n}\n\nexport default function FaceDetection({ \n  onDetectionChange, \n  showVisualization = true, \n  className = \"\",\n  stream\n}: FaceDetectionProps) {\n  const { \n    faceDetected, \n    multipleFaces, \n    lookingAway, \n    confidence, \n    isLoading, \n    error \n  } = useFaceDetection(stream);\n\n  const [detectionHistory, setDetectionHistory] = useState<boolean[]>([]);\n  const [alertCount, setAlertCount] = useState(0);\n\n  // Update detection history for stability\n  useEffect(() => {\n    setDetectionHistory(prev => {\n      const newHistory = [...prev, faceDetected].slice(-10); // Keep last 10 readings\n      return newHistory;\n    });\n  }, [faceDetected]);\n\n  // Report detection changes to parent\n  useEffect(() => {\n    onDetectionChange?.({\n      faceDetected,\n      multipleFaces,\n      lookingAway,\n      confidence\n    });\n  }, [faceDetected, multipleFaces, lookingAway, confidence, onDetectionChange]);\n\n  // Track alerts\n  useEffect(() => {\n    if (multipleFaces || lookingAway) {\n      setAlertCount(prev => prev + 1);\n    }\n  }, [multipleFaces, lookingAway]);\n\n  const getDetectionStatus = () => {\n    if (isLoading) return { status: 'loading', color: 'secondary', icon: 'fa-spinner fa-spin' };\n    if (error) return { status: 'error', color: 'destructive', icon: 'fa-exclamation-triangle' };\n    if (multipleFaces) return { status: 'multiple_faces', color: 'destructive', icon: 'fa-users' };\n    if (lookingAway) return { status: 'looking_away', color: 'yellow', icon: 'fa-eye-slash' };\n    if (faceDetected) return { status: 'face_detected', color: 'success', icon: 'fa-user-check' };\n    return { status: 'no_face', color: 'secondary', icon: 'fa-user-times' };\n  };\n\n  const getStatusMessage = () => {\n    const status = getDetectionStatus();\n    switch (status.status) {\n      case 'loading':\n        return 'Initializing face detection...';\n      case 'error':\n        return `Detection error: ${error}`;\n      case 'multiple_faces':\n        return 'ALERT: Multiple faces detected!';\n      case 'looking_away':\n        return 'WARNING: Looking away from camera';\n      case 'face_detected':\n        return `Face detected (${Math.round(confidence * 100)}% confidence)`;\n      default:\n        return 'No face detected';\n    }\n  };\n\n  const getStabilityScore = () => {\n    if (detectionHistory.length === 0) return 0;\n    const positiveDetections = detectionHistory.filter(Boolean).length;\n    return Math.round((positiveDetections / detectionHistory.length) * 100);\n  };\n\n  const status = getDetectionStatus();\n\n  if (!showVisualization) {\n    return (\n      <div className={`flex items-center space-x-2 ${className}`} data-testid=\"face-detection-minimal\">\n        <div className={`status-indicator ${\n          status.color === 'success' ? 'status-online' :\n          status.color === 'destructive' ? 'status-danger' :\n          status.color === 'yellow' ? 'status-warning' :\n          'status-offline'\n        } ${faceDetected && !multipleFaces && !lookingAway ? 'pulse-green' : ''}`}></div>\n        <span className=\"text-sm text-muted-foreground\">{getStatusMessage()}</span>\n      </div>\n    );\n  }\n\n  return (\n    <Card className={`${className}`} data-testid=\"face-detection-card\">\n      <CardContent className=\"p-4\">\n        <div className=\"space-y-4\">\n          {/* Main Status */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className={`w-12 h-12 rounded-full border-2 flex items-center justify-center ${\n                status.color === 'success' ? 'border-green-400 bg-green-50' :\n                status.color === 'destructive' ? 'border-red-400 bg-red-50 pulse-red' :\n                status.color === 'yellow' ? 'border-yellow-400 bg-yellow-50' :\n                'border-gray-400 bg-gray-50'\n              }`}>\n                <i className={`fas ${status.icon} ${\n                  status.color === 'success' ? 'text-green-600' :\n                  status.color === 'destructive' ? 'text-red-600' :\n                  status.color === 'yellow' ? 'text-yellow-600' :\n                  'text-gray-600'\n                } text-lg`}></i>\n              </div>\n              <div>\n                <h4 className=\"font-medium text-foreground\">Face Detection</h4>\n                <p className=\"text-sm text-muted-foreground\">{getStatusMessage()}</p>\n              </div>\n            </div>\n            <Badge \n              variant={\n                status.color === 'success' ? 'default' :\n                status.color === 'destructive' ? 'destructive' :\n                status.color === 'yellow' ? 'secondary' :\n                'outline'\n              }\n              data-testid=\"detection-status-badge\"\n            >\n              {status.status.replace('_', ' ').toUpperCase()}\n            </Badge>\n          </div>\n\n          {/* Detection Metrics */}\n          {faceDetected && !isLoading && (\n            <div className=\"grid grid-cols-3 gap-4 pt-2 border-t border-border\">\n              <div className=\"text-center\">\n                <div className=\"text-lg font-semibold text-foreground\" data-testid=\"confidence-score\">\n                  {Math.round(confidence * 100)}%\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Confidence</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-lg font-semibold text-foreground\" data-testid=\"stability-score\">\n                  {getStabilityScore()}%\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Stability</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-lg font-semibold text-foreground\" data-testid=\"alert-count\">\n                  {alertCount}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">Alerts</div>\n              </div>\n            </div>\n          )}\n\n          {/* Alert Messages */}\n          {multipleFaces && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\n              <div className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-exclamation-circle text-red-500\"></i>\n                <div>\n                  <p className=\"text-red-700 text-sm font-medium\">Multiple Faces Detected</p>\n                  <p className=\"text-red-600 text-xs\">Only one person should be visible during the exam.</p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {lookingAway && !multipleFaces && (\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n              <div className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-eye-slash text-yellow-500\"></i>\n                <div>\n                  <p className=\"text-yellow-700 text-sm font-medium\">Attention Warning</p>\n                  <p className=\"text-yellow-600 text-xs\">Please look directly at the camera.</p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\n              <div className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-exclamation-triangle text-red-500\"></i>\n                <div>\n                  <p className=\"text-red-700 text-sm font-medium\">Detection Error</p>\n                  <p className=\"text-red-600 text-xs\">{error}</p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Success State */}\n          {faceDetected && !multipleFaces && !lookingAway && !error && (\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-3\">\n              <div className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-check-circle text-green-500\"></i>\n                <div>\n                  <p className=\"text-green-700 text-sm font-medium\">Detection Active</p>\n                  <p className=\"text-green-600 text-xs\">Face monitoring is working properly.</p>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":8694},"client/src/components/qr-scanner.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { Html5Qrcode } from \"html5-qrcode\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface QRScannerProps {\n  onScan: (data: string) => void;\n  onError?: (error: string) => void;\n  className?: string;\n}\n\nexport default function QRScanner({ onScan, onError, className = \"\" }: QRScannerProps) {\n  const scannerRef = useRef<HTMLDivElement>(null);\n  const html5QrCode = useRef<Html5Qrcode | null>(null);\n  const [isScanning, setIsScanning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const startScanning = async () => {\n    if (!scannerRef.current) {\n      setError(\"Scanner container not ready\");\n      return;\n    }\n\n    try {\n      setError(null);\n      setIsScanning(true);\n\n      // Check if camera is available\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error(\"Camera not supported on this device\");\n      }\n\n      // Request camera permission first\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        stream.getTracks().forEach(track => track.stop()); // Stop the test stream\n      } catch (permissionError) {\n        throw new Error(\"Camera permission denied. Please allow camera access and try again.\");\n      }\n\n      // Initialize Html5Qrcode safely\n      if (html5QrCode.current) {\n        await html5QrCode.current.clear();\n        html5QrCode.current = null;\n      }\n\n      html5QrCode.current = new Html5Qrcode(\"qr-scanner\");\n\n      // Start scanning with better error handling\n      await html5QrCode.current.start(\n        { facingMode: \"environment\" }, // Use back camera if available\n        {\n          fps: 10,\n          qrbox: { width: 250, height: 250 },\n          aspectRatio: 1.0,\n        },\n        (decodedText, decodedResult) => {\n          console.log(\"QR Code scanned:\", decodedText);\n          onScan(decodedText);\n          stopScanning();\n          toast({\n            title: \"QR Code Scanned\",\n            description: \"Hall ticket verified successfully\",\n          });\n        },\n        (errorMessage) => {\n          // Handle scan error silently - this fires constantly during scanning\n          console.debug(\"QR scan error:\", errorMessage);\n        }\n      );\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : \"Failed to start camera\";\n      console.error(\"QR Scanner error:\", err);\n      setError(errorMessage);\n      setIsScanning(false);\n      onError?.(errorMessage);\n      toast({\n        title: \"Scanner Error\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const stopScanning = async () => {\n    if (html5QrCode.current && isScanning) {\n      try {\n        await html5QrCode.current.stop();\n        await html5QrCode.current.clear();\n      } catch (err) {\n        console.error(\"Error stopping scanner:\", err);\n      } finally {\n        html5QrCode.current = null;\n        setIsScanning(false);\n      }\n    }\n  };\n\n  useEffect(() => {\n    // Cleanup on unmount\n    return () => {\n      stopScanning();\n    };\n  }, []);\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      {/* Scanner Container */}\n      <div className=\"relative\">\n        <div\n          id=\"qr-scanner\"\n          ref={scannerRef}\n          className=\"mx-auto min-h-[300px] w-full max-w-md\"\n          data-testid=\"qr-scanner-container\"\n          style={{\n            background: isScanning ? 'transparent' : '#f3f4f6',\n            borderRadius: '8px',\n          }}\n        >\n          {!isScanning && (\n            <div className=\"flex flex-col items-center justify-center h-[300px] text-center\">\n              <i className=\"fas fa-qrcode text-4xl text-primary mb-2\"></i>\n              <p className=\"text-muted-foreground text-sm mb-4\">Click \"Start QR Scanner\" to begin camera scanning</p>\n              <div className=\"w-12 h-12 border-2 border-primary rounded-lg opacity-50\"></div>\n            </div>\n          )}\n        </div>\n\n        {/* Scanning overlay - positioned to not block camera */}\n        {isScanning && (\n          <div className=\"absolute top-4 left-1/2 transform -translate-x-1/2 pointer-events-none z-10\">\n            <div className=\"w-48 h-48 border-2 border-green-500 rounded-lg\">\n              <div className=\"relative w-full h-full\">\n                {/* Corner guides */}\n                <div className=\"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-green-500\"></div>\n                <div className=\"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-green-500\"></div>\n                <div className=\"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-green-500\"></div>\n                <div className=\"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-green-500\"></div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Controls */}\n      <div className=\"text-center space-y-2\">\n        {!isScanning ? (\n          <Button \n            onClick={startScanning}\n            className=\"bg-primary text-primary-foreground\"\n            data-testid=\"button-start-scanning\"\n          >\n            <i className=\"fas fa-camera mr-2\"></i>Start QR Scanner\n          </Button>\n        ) : (\n          <Button \n            onClick={stopScanning}\n            variant=\"outline\"\n            data-testid=\"button-stop-scanning\"\n          >\n            <i className=\"fas fa-stop mr-2\"></i>Stop Scanner\n          </Button>\n        )}\n        \n        {isScanning && (\n          <p className=\"text-sm text-muted-foreground\">\n            <i className=\"fas fa-info-circle mr-1\"></i>\n            Point camera at QR code to scan\n          </p>\n        )}\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\n          <div className=\"flex items-start space-x-2\">\n            <i className=\"fas fa-exclamation-triangle text-red-500 mt-0.5\"></i>\n            <div>\n              <p className=\"text-red-700 text-sm font-medium\">Scanner Error</p>\n              <p className=\"text-red-600 text-xs mt-1\">{error}</p>\n              <Button \n                size=\"sm\" \n                className=\"mt-2\" \n                onClick={() => {\n                  setError(null);\n                  startScanning();\n                }}\n                data-testid=\"button-retry-scanner\"\n              >\n                Retry\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Usage Instructions */}\n      {!isScanning && !error && (\n        <div className=\"bg-muted rounded-lg p-3 text-center\">\n          <h4 className=\"text-sm font-medium text-foreground mb-2\">\n            <i className=\"fas fa-info-circle text-blue-500 mr-1\"></i>\n            How to scan\n          </h4>\n          <ul className=\"text-xs text-muted-foreground space-y-1\">\n            <li>• Click \"Start QR Scanner\" to begin</li>\n            <li>• Hold your hall ticket QR code in front of camera</li>\n            <li>• Keep the code within the scanning frame</li>\n            <li>• Wait for automatic detection</li>\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":7322},"client/src/components/webcam-monitor.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface WebcamMonitorProps {\n  className?: string;\n  showControls?: boolean;\n  onStreamReady?: (stream: MediaStream) => void;\n  stream?: MediaStream | null;\n  isActive?: boolean;\n  error?: string | null;\n  onStartCamera?: () => void;\n  onStopCamera?: () => void;\n}\n\nexport default function WebcamMonitor({ \n  className = \"\", \n  showControls = false, \n  onStreamReady,\n  stream,\n  isActive = false,\n  error,\n  onStartCamera,\n  onStopCamera\n}: WebcamMonitorProps) {\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const { toast } = useToast();\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  // Set video stream when available\n  useEffect(() => {\n    if (videoRef.current && stream) {\n      videoRef.current.srcObject = stream;\n      onStreamReady?.(stream);\n    }\n  }, [stream, onStreamReady]);\n\n  // Handle errors\n  useEffect(() => {\n    if (error) {\n      toast({\n        title: \"Camera Error\",\n        description: error,\n        variant: \"destructive\",\n      });\n    }\n  }, [error, toast]);\n\n  const handleFullscreen = async () => {\n    if (!videoRef.current) return;\n\n    try {\n      if (isFullscreen) {\n        await document.exitFullscreen();\n        setIsFullscreen(false);\n      } else {\n        await videoRef.current.requestFullscreen();\n        setIsFullscreen(true);\n      }\n    } catch (error) {\n      console.error(\"Fullscreen error:\", error);\n    }\n  };\n\n  useEffect(() => {\n    const handleFullscreenChange = () => {\n      setIsFullscreen(!!document.fullscreenElement);\n    };\n\n    document.addEventListener(\"fullscreenchange\", handleFullscreenChange);\n    return () => document.removeEventListener(\"fullscreenchange\", handleFullscreenChange);\n  }, []);\n\n  return (\n    <div className={`relative ${className}`}>\n      <div className=\"video-feed bg-black rounded-lg overflow-hidden\" style={{ aspectRatio: \"16/9\" }}>\n        {stream ? (\n          <video\n            ref={videoRef}\n            autoPlay\n            playsInline\n            muted\n            className=\"w-full h-full object-cover\"\n            data-testid=\"webcam-video\"\n          />\n        ) : (\n          <div className=\"w-full h-full flex items-center justify-center text-white\">\n            {error ? (\n              <div className=\"text-center\">\n                <i className=\"fas fa-exclamation-triangle text-red-400 text-2xl mb-2\"></i>\n                <p className=\"text-red-400\">Camera Error</p>\n                <p className=\"text-xs opacity-75\">{error}</p>\n              </div>\n            ) : isActive ? (\n              <div className=\"text-center\">\n                <div className=\"animate-spin w-8 h-8 border-2 border-white border-t-transparent rounded-full mx-auto mb-2\"></div>\n                <p>Starting camera...</p>\n              </div>\n            ) : (\n              <div className=\"text-center\">\n                <i className=\"fas fa-video-slash text-muted-foreground text-2xl mb-2\"></i>\n                <p className=\"text-muted-foreground\">Camera inactive</p>\n                {showControls && (\n                  <Button \n                    className=\"mt-2\" \n                    onClick={onStartCamera}\n                    data-testid=\"button-start-camera\"\n                  >\n                    Start Camera\n                  </Button>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Camera status overlay */}\n        {stream && (\n          <div className=\"absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs flex items-center space-x-1\">\n            <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\"></div>\n            <span>LIVE</span>\n          </div>\n        )}\n\n        {/* Controls overlay */}\n        {showControls && stream && (\n          <div className=\"absolute bottom-2 right-2 flex space-x-2\">\n            <Button\n              size=\"sm\"\n              variant=\"secondary\"\n              onClick={handleFullscreen}\n              data-testid=\"button-fullscreen\"\n            >\n              <i className={`fas ${isFullscreen ? 'fa-compress' : 'fa-expand'}`}></i>\n            </Button>\n            <Button\n              size=\"sm\"\n              variant=\"destructive\"\n              onClick={onStopCamera}\n              data-testid=\"button-stop-camera\"\n            >\n              <i className=\"fas fa-stop\"></i>\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* Error message */}\n      {error && (\n        <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-red-700 text-sm\">\n            <i className=\"fas fa-exclamation-circle mr-1\"></i>\n            {error}\n          </p>\n          <Button \n            size=\"sm\" \n            className=\"mt-2\" \n            onClick={onStartCamera}\n            data-testid=\"button-retry-camera\"\n          >\n            Retry\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":5044},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":314},"client/src/hooks/useFaceDetection.ts":{"content":"import { useState, useEffect, useRef } from 'react';\n\ninterface FaceDetectionResult {\n  faceDetected: boolean;\n  multipleFaces: boolean;\n  lookingAway: boolean;\n  confidence: number;\n}\n\nexport function useFaceDetection(stream?: MediaStream | null) {\n  const [detection, setDetection] = useState<FaceDetectionResult>({\n    faceDetected: false,\n    multipleFaces: false,\n    lookingAway: false,\n    confidence: 0\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  const videoRef = useRef<HTMLVideoElement | null>(null);\n  const detectionIntervalRef = useRef<NodeJS.Timeout | null>(null);\n  const lookAwayCounterRef = useRef(0);\n  const lookAwayThreshold = 5; // Number of consecutive frames looking away\n\n  // Initialize face detection when stream is available\n  useEffect(() => {\n    if (stream && typeof window !== 'undefined') {\n      initializeFaceDetection();\n    } else {\n      cleanupDetection();\n    }\n\n    return () => {\n      cleanupDetection();\n    };\n  }, [stream]);\n\n  const initializeFaceDetection = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      // Create video element for processing\n      const video = document.createElement('video');\n      if (stream) {\n        video.srcObject = stream;\n      }\n      video.autoplay = true;\n      video.playsInline = true;\n      videoRef.current = video;\n\n      // Wait for video to load\n      await new Promise<void>((resolve, reject) => {\n        video.onloadedmetadata = () => resolve();\n        video.onerror = () => reject(new Error('Failed to load video stream'));\n        setTimeout(() => reject(new Error('Video load timeout')), 10000);\n      });\n\n      // Start detection loop\n      startDetectionLoop();\n      setIsLoading(false);\n\n    } catch (err) {\n      console.error('Face detection initialization error:', err);\n      setError(err instanceof Error ? err.message : 'Failed to initialize face detection');\n      setIsLoading(false);\n    }\n  };\n\n  const startDetectionLoop = () => {\n    if (detectionIntervalRef.current) {\n      clearInterval(detectionIntervalRef.current);\n    }\n\n    detectionIntervalRef.current = setInterval(() => {\n      detectFaces();\n    }, 1000); // Run detection every second\n  };\n\n  const detectFaces = async () => {\n    if (!videoRef.current || videoRef.current.readyState !== 4) {\n      return;\n    }\n\n    try {\n      // In a real implementation, you would use a face detection library like:\n      // - face-api.js\n      // - TensorFlow.js with face detection models\n      // - MediaPipe\n      \n      // For now, we'll simulate face detection with some basic logic\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      \n      if (!ctx) return;\n\n      canvas.width = videoRef.current.videoWidth;\n      canvas.height = videoRef.current.videoHeight;\n      ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n\n      // Simulate face detection results\n      // In production, this would be replaced with actual ML model inference\n      const mockDetection = simulateFaceDetection();\n      \n      setDetection(mockDetection);\n\n      // Track looking away behavior\n      if (mockDetection.lookingAway) {\n        lookAwayCounterRef.current++;\n      } else {\n        lookAwayCounterRef.current = 0;\n      }\n\n      // Update looking away status based on threshold\n      const isLookingAway = lookAwayCounterRef.current >= lookAwayThreshold;\n      if (isLookingAway !== mockDetection.lookingAway) {\n        setDetection(prev => ({ ...prev, lookingAway: isLookingAway }));\n      }\n\n    } catch (err) {\n      console.error('Face detection error:', err);\n      setError('Face detection processing error');\n    }\n  };\n\n  // Simulate face detection results\n  // In production, replace this with actual face detection ML model\n  const simulateFaceDetection = (): FaceDetectionResult => {\n    const random = Math.random();\n    \n    // Simulate 90% face detection success rate\n    const faceDetected = random > 0.1;\n    \n    // Simulate occasional multiple faces (5% chance)\n    const multipleFaces = faceDetected && random > 0.95;\n    \n    // Simulate looking away (10% chance when face is detected)\n    const lookingAway = faceDetected && !multipleFaces && random > 0.9;\n    \n    // Simulate confidence score\n    const confidence = faceDetected ? 0.7 + (Math.random() * 0.3) : 0;\n\n    return {\n      faceDetected,\n      multipleFaces,\n      lookingAway,\n      confidence\n    };\n  };\n\n  const cleanupDetection = () => {\n    if (detectionIntervalRef.current) {\n      clearInterval(detectionIntervalRef.current);\n      detectionIntervalRef.current = null;\n    }\n    \n    if (videoRef.current) {\n      videoRef.current.pause();\n      videoRef.current = null;\n    }\n    \n    lookAwayCounterRef.current = 0;\n    setDetection({\n      faceDetected: false,\n      multipleFaces: false,\n      lookingAway: false,\n      confidence: 0\n    });\n  };\n\n  return {\n    ...detection,\n    isLoading,\n    error\n  };\n}\n","size_bytes":5042},"client/src/hooks/useWebSocket.ts":{"content":"import { useEffect, useRef, useState, useCallback } from 'react';\n\ninterface WebSocketMessage {\n  type: string;\n  data?: any;\n  userId?: string;\n  userType?: string;\n  sessionId?: string;\n  payload?: any;\n}\n\nexport function useWebSocket() {\n  const ws = useRef<WebSocket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [lastMessage, setLastMessage] = useState<MessageEvent | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const reconnectTimeoutRef = useRef<NodeJS.Timeout>();\n  const reconnectAttempts = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  const connect = useCallback(() => {\n    try {\n      const protocol = window.location.protocol === \"https:\" ? \"wss:\" : \"ws:\";\n      const wsUrl = `${protocol}//${window.location.host}/ws`;\n      \n      ws.current = new WebSocket(wsUrl);\n\n      ws.current.onopen = () => {\n        console.log('WebSocket connected');\n        setIsConnected(true);\n        setError(null);\n        reconnectAttempts.current = 0;\n      };\n\n      ws.current.onmessage = (event) => {\n        setLastMessage(event);\n      };\n\n      ws.current.onclose = (event) => {\n        console.log('WebSocket disconnected:', event.code, event.reason);\n        setIsConnected(false);\n        ws.current = null;\n\n        // Attempt to reconnect unless it was a normal closure\n        if (event.code !== 1000 && reconnectAttempts.current < maxReconnectAttempts) {\n          const timeout = Math.pow(2, reconnectAttempts.current) * 1000; // Exponential backoff\n          reconnectTimeoutRef.current = setTimeout(() => {\n            reconnectAttempts.current++;\n            connect();\n          }, timeout);\n        }\n      };\n\n      ws.current.onerror = (event) => {\n        console.error('WebSocket error:', event);\n        setError('WebSocket connection error');\n      };\n\n    } catch (err) {\n      console.error('Failed to create WebSocket connection:', err);\n      setError('Failed to establish WebSocket connection');\n    }\n  }, []);\n\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n    }\n    \n    if (ws.current) {\n      ws.current.close(1000, 'Manual disconnect');\n    }\n  }, []);\n\n  const sendMessage = useCallback((message: WebSocketMessage) => {\n    if (ws.current && ws.current.readyState === WebSocket.OPEN) {\n      try {\n        ws.current.send(JSON.stringify(message));\n      } catch (err) {\n        console.error('Failed to send WebSocket message:', err);\n        setError('Failed to send message');\n      }\n    } else {\n      console.warn('WebSocket is not connected. Message not sent:', message);\n      setError('WebSocket not connected');\n    }\n  }, []);\n\n  useEffect(() => {\n    connect();\n\n    return () => {\n      disconnect();\n    };\n  }, [connect, disconnect]);\n\n  return {\n    isConnected,\n    lastMessage,\n    error,\n    sendMessage,\n    reconnect: connect,\n    disconnect\n  };\n}\n","size_bytes":2956},"client/src/hooks/useWebcam.ts":{"content":"import { useState, useRef, useCallback } from 'react';\n\nexport function useWebcam() {\n  const [stream, setStream] = useState<MediaStream | null>(null);\n  const [isActive, setIsActive] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n\n  const startCamera = useCallback(async () => {\n    try {\n      setError(null);\n      setIsActive(true);\n\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: { ideal: 1280 },\n          height: { ideal: 720 },\n          facingMode: 'user'\n        },\n        audio: false\n      });\n\n      streamRef.current = mediaStream;\n      setStream(mediaStream);\n      \n      console.log('Camera started successfully');\n    } catch (err) {\n      console.error('Failed to start camera:', err);\n      let errorMessage = 'Failed to access camera';\n      \n      if (err instanceof Error) {\n        if (err.name === 'NotAllowedError') {\n          errorMessage = 'Camera access denied. Please allow camera permissions.';\n        } else if (err.name === 'NotFoundError') {\n          errorMessage = 'No camera device found.';\n        } else if (err.name === 'NotReadableError') {\n          errorMessage = 'Camera is already in use by another application.';\n        } else {\n          errorMessage = err.message;\n        }\n      }\n      \n      setError(errorMessage);\n      setIsActive(false);\n    }\n  }, []);\n\n  const stopCamera = useCallback(() => {\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => {\n        track.stop();\n      });\n      streamRef.current = null;\n      setStream(null);\n    }\n    setIsActive(false);\n    console.log('Camera stopped');\n  }, []);\n\n  const capturePhoto = useCallback((): Promise<string | null> => {\n    return new Promise((resolve) => {\n      if (!streamRef.current) {\n        resolve(null);\n        return;\n      }\n\n      const video = document.createElement('video');\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n\n      if (!ctx) {\n        resolve(null);\n        return;\n      }\n\n      video.srcObject = streamRef.current;\n      video.play();\n\n      video.addEventListener('loadedmetadata', () => {\n        canvas.width = video.videoWidth;\n        canvas.height = video.videoHeight;\n        \n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        \n        const dataUrl = canvas.toDataURL('image/jpeg', 0.8);\n        resolve(dataUrl);\n      });\n    });\n  }, []);\n\n  const switchCamera = useCallback(async (facingMode: 'user' | 'environment' = 'user') => {\n    if (streamRef.current) {\n      stopCamera();\n    }\n    \n    try {\n      setError(null);\n      setIsActive(true);\n\n      const mediaStream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          width: { ideal: 1280 },\n          height: { ideal: 720 },\n          facingMode\n        },\n        audio: false\n      });\n\n      streamRef.current = mediaStream;\n      setStream(mediaStream);\n    } catch (err) {\n      console.error('Failed to switch camera:', err);\n      setError('Failed to switch camera');\n      setIsActive(false);\n    }\n  }, [stopCamera]);\n\n  return {\n    stream,\n    isActive,\n    error,\n    startCamera,\n    stopCamera,\n    capturePhoto,\n    switchCamera\n  };\n}\n","size_bytes":3342},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/lib/exam-utils.ts":{"content":"export interface Question {\n  id: string;\n  questionText: string;\n  options: string[];\n  correctAnswer: string;\n  questionType: 'multiple_choice' | 'true_false' | 'short_answer';\n  difficulty?: 'easy' | 'medium' | 'hard';\n  points?: number;\n  timeLimit?: number; // in seconds\n}\n\nexport interface ExamAnswer {\n  questionId: string;\n  selectedOption: string;\n  timeSpent: number;\n  timestamp: string;\n}\n\nexport interface ExamSession {\n  id: string;\n  studentId: string;\n  hallTicketId: string;\n  startTime: string;\n  endTime?: string;\n  currentQuestion: number;\n  answers: Record<string, ExamAnswer>;\n  timeRemaining: number;\n  status: 'not_started' | 'in_progress' | 'paused' | 'completed' | 'submitted';\n}\n\nexport function calculateTimeRemaining(startTime: string, durationMinutes: number): number {\n  const start = new Date(startTime).getTime();\n  const now = Date.now();\n  const elapsed = Math.floor((now - start) / 1000); // elapsed in seconds\n  const totalSeconds = durationMinutes * 60;\n  return Math.max(0, totalSeconds - elapsed);\n}\n\nexport function formatTime(seconds: number): string {\n  const hours = Math.floor(seconds / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  const secs = seconds % 60;\n  \n  if (hours > 0) {\n    return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  }\n  return `${minutes}:${secs.toString().padStart(2, '0')}`;\n}\n\nexport function calculateExamProgress(answers: Record<string, ExamAnswer>, totalQuestions: number): {\n  answered: number;\n  percentage: number;\n  remaining: number;\n} {\n  const answered = Object.keys(answers).length;\n  const percentage = Math.round((answered / totalQuestions) * 100);\n  const remaining = totalQuestions - answered;\n  \n  return { answered, percentage, remaining };\n}\n\nexport function validateAnswer(answer: ExamAnswer): { isValid: boolean; error?: string } {\n  if (!answer.questionId) {\n    return { isValid: false, error: 'Question ID is required' };\n  }\n  \n  if (!answer.selectedOption) {\n    return { isValid: false, error: 'Answer selection is required' };\n  }\n  \n  if (answer.timeSpent < 0) {\n    return { isValid: false, error: 'Invalid time spent' };\n  }\n  \n  return { isValid: true };\n}\n\nexport function shuffleQuestions<T extends Question>(questions: T[]): T[] {\n  const shuffled = [...questions];\n  for (let i = shuffled.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n  }\n  return shuffled;\n}\n\nexport function shuffleOptions(question: Question): Question {\n  if (question.questionType !== 'multiple_choice') {\n    return question;\n  }\n  \n  const correctIndex = question.options.findIndex((_, index) => \n    String.fromCharCode(65 + index) === question.correctAnswer\n  );\n  \n  if (correctIndex === -1) {\n    return question;\n  }\n  \n  const shuffledOptions = [...question.options];\n  const correctOption = shuffledOptions[correctIndex];\n  \n  // Fisher-Yates shuffle\n  for (let i = shuffledOptions.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [shuffledOptions[i], shuffledOptions[j]] = [shuffledOptions[j], shuffledOptions[i]];\n  }\n  \n  // Update correct answer based on new position\n  const newCorrectIndex = shuffledOptions.findIndex(option => option === correctOption);\n  const newCorrectAnswer = String.fromCharCode(65 + newCorrectIndex);\n  \n  return {\n    ...question,\n    options: shuffledOptions,\n    correctAnswer: newCorrectAnswer\n  };\n}\n\nexport function generateExamReport(session: ExamSession, questions: Question[]): {\n  totalQuestions: number;\n  answeredQuestions: number;\n  correctAnswers: number;\n  score: number;\n  timeSpent: number;\n  averageTimePerQuestion: number;\n} {\n  const totalQuestions = questions.length;\n  const answeredQuestions = Object.keys(session.answers).length;\n  \n  let correctAnswers = 0;\n  let totalTimeSpent = 0;\n  \n  Object.entries(session.answers).forEach(([questionId, answer]) => {\n    const question = questions.find(q => q.id === questionId);\n    if (question && answer.selectedOption === question.correctAnswer) {\n      correctAnswers++;\n    }\n    totalTimeSpent += answer.timeSpent;\n  });\n  \n  const score = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;\n  const averageTimePerQuestion = answeredQuestions > 0 ? Math.round(totalTimeSpent / answeredQuestions) : 0;\n  \n  return {\n    totalQuestions,\n    answeredQuestions,\n    correctAnswers,\n    score,\n    timeSpent: totalTimeSpent,\n    averageTimePerQuestion\n  };\n}\n\nexport function detectCheatingPatterns(session: ExamSession): {\n  suspiciousPatterns: string[];\n  riskLevel: 'low' | 'medium' | 'high';\n} {\n  const patterns: string[] = [];\n  let riskLevel: 'low' | 'medium' | 'high' = 'low';\n  \n  const answers = Object.values(session.answers);\n  \n  if (answers.length === 0) {\n    return { suspiciousPatterns: patterns, riskLevel };\n  }\n  \n  // Check for unusually fast answering\n  const avgTimePerQuestion = answers.reduce((sum, answer) => sum + answer.timeSpent, 0) / answers.length;\n  if (avgTimePerQuestion < 10) { // Less than 10 seconds per question\n    patterns.push('Unusually fast answering pattern detected');\n    riskLevel = 'medium';\n  }\n  \n  // Check for pattern in answer selection (e.g., all A's, alternating pattern)\n  const selectedOptions = answers.map(answer => answer.selectedOption);\n  const optionCounts = selectedOptions.reduce((counts, option) => {\n    counts[option] = (counts[option] || 0) + 1;\n    return counts;\n  }, {} as Record<string, number>);\n  \n  const maxOptionCount = Math.max(...Object.values(optionCounts));\n  const totalAnswers = selectedOptions.length;\n  \n  if (maxOptionCount / totalAnswers > 0.8) { // More than 80% same option\n    patterns.push('Repetitive answer pattern detected');\n    riskLevel = 'high';\n  }\n  \n  // Check for time gaps that might indicate external help\n  const timeGaps = answers.map(answer => answer.timeSpent).filter(time => time > 300); // > 5 minutes\n  if (timeGaps.length > totalAnswers * 0.3) { // 30% of questions took too long\n    patterns.push('Unusual time delays detected');\n    riskLevel = riskLevel === 'high' ? 'high' : 'medium';\n  }\n  \n  return { suspiciousPatterns: patterns, riskLevel };\n}\n\nexport const EXAM_CONSTANTS = {\n  MIN_QUESTION_TIME: 5, // seconds\n  MAX_QUESTION_TIME: 600, // 10 minutes\n  AUTO_SUBMIT_WARNING: 300, // 5 minutes before auto-submit\n  IDLE_TIMEOUT: 1800, // 30 minutes idle timeout\n  MAX_LOOKING_AWAY_TIME: 60, // seconds before alert\n  MAX_FACE_DETECTION_FAILURES: 10, // consecutive failures before alert\n} as const;\n","size_bytes":6612},"client/src/lib/qr-utils.ts":{"content":"export interface QRCodeData {\n  hallTicketId: string;\n  rollNumber: string;\n  examName: string;\n  timestamp: number;\n  studentName?: string;\n  examDate?: string;\n}\n\nexport function parseQRCode(qrData: string): QRCodeData {\n  try {\n    const parsed = JSON.parse(qrData);\n    \n    // Validate required fields\n    if (!parsed.hallTicketId || !parsed.rollNumber) {\n      throw new Error('Invalid QR code: Missing required fields');\n    }\n    \n    return {\n      hallTicketId: parsed.hallTicketId,\n      rollNumber: parsed.rollNumber,\n      examName: parsed.examName || 'Unknown Exam',\n      timestamp: parsed.timestamp || Date.now(),\n      studentName: parsed.studentName,\n      examDate: parsed.examDate\n    };\n  } catch (error) {\n    throw new Error('Invalid QR code format');\n  }\n}\n\nexport function generateQRCodeData(data: Omit<QRCodeData, 'timestamp'>): string {\n  const qrData: QRCodeData = {\n    ...data,\n    timestamp: Date.now()\n  };\n  \n  return JSON.stringify(qrData);\n}\n\nexport function validateQRCode(qrData: string): { isValid: boolean; error?: string } {\n  try {\n    const parsed = parseQRCode(qrData);\n    \n    // Check if QR code is not expired (24 hours)\n    const maxAge = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\n    const age = Date.now() - parsed.timestamp;\n    \n    if (age > maxAge) {\n      return { isValid: false, error: 'QR code has expired' };\n    }\n    \n    return { isValid: true };\n  } catch (error) {\n    return { \n      isValid: false, \n      error: error instanceof Error ? error.message : 'Invalid QR code' \n    };\n  }\n}\n\nexport function formatHallTicketId(rollNumber: string, year: number = new Date().getFullYear()): string {\n  // Generate hall ticket ID: HT + year + random chars + roll number suffix\n  const suffix = rollNumber.slice(-4); // Last 4 characters of roll number\n  const randomChars = Math.random().toString(36).substring(2, 6).toUpperCase();\n  return `HT${year}${randomChars}${suffix}`;\n}\n\nexport function extractStudentInfo(qrData: string): {\n  rollNumber: string;\n  hallTicketId: string;\n  examName: string;\n  studentName?: string;\n} {\n  const parsed = parseQRCode(qrData);\n  return {\n    rollNumber: parsed.rollNumber,\n    hallTicketId: parsed.hallTicketId,\n    examName: parsed.examName,\n    studentName: parsed.studentName\n  };\n}\n\n// QR code generation options for different use cases\nexport const QR_CODE_CONFIG = {\n  hallTicket: {\n    width: 300,\n    height: 300,\n    margin: 2,\n    colorDark: '#000000',\n    colorLight: '#FFFFFF',\n    correctLevel: 'M' as const,\n  },\n  verification: {\n    width: 200,\n    height: 200,\n    margin: 1,\n    colorDark: '#6366f1',\n    colorLight: '#FFFFFF',\n    correctLevel: 'H' as const,\n  },\n  mobile: {\n    width: 150,\n    height: 150,\n    margin: 1,\n    colorDark: '#000000',\n    colorLight: '#FFFFFF',\n    correctLevel: 'L' as const,\n  }\n};\n","size_bytes":2839},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const token = localStorage.getItem(\"auth_token\");\n  const headers: Record<string, string> = data ? { \"Content-Type\": \"application/json\" } : {};\n  if (token) {\n    headers[\"Authorization\"] = `Bearer ${token}`;\n  }\n\n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const token = localStorage.getItem(\"auth_token\");\n    const headers: Record<string, string> = {};\n    if (token) {\n      headers[\"Authorization\"] = `Bearer ${token}`;\n    }\n\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n      headers,\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1740},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/home.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\n\nexport default function Home() {\n  const { user, isLoading } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const isAdmin = user?.role === 'admin';\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"glass-header px-6 py-4\">\n        <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <i className=\"fas fa-graduation-cap text-primary text-2xl\"></i>\n            <h1 className=\"text-2xl font-bold text-foreground\">SecureExam</h1>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"text-sm text-muted-foreground\">\n              Welcome, {user?.firstName || user?.email}\n            </div>\n            <Button\n              variant=\"outline\"\n              onClick={() => window.location.href = \"/api/logout\"}\n              data-testid=\"button-logout\"\n            >\n              <i className=\"fas fa-sign-out-alt mr-2\"></i>\n              Logout\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-6xl mx-auto p-6\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold text-foreground mb-2\">\n            {isAdmin ? 'Admin Dashboard' : 'Student Portal'}\n          </h2>\n          <p className=\"text-muted-foreground\">\n            {isAdmin \n              ? 'Manage exams, monitor students, and handle security incidents'\n              : 'Access your exams and view your progress'\n            }\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {isAdmin ? (\n            <>\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-qrcode text-primary\"></i>\n                    <span>Hall Ticket Generation</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Create and manage hall tickets with QR codes for student authentication.\n                  </p>\n                  <Link href=\"/admin/hall-tickets\">\n                    <Button className=\"w-full\" data-testid=\"link-hall-tickets\">\n                      Generate Tickets\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-tachometer-alt text-primary\"></i>\n                    <span>Live Dashboard</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Monitor active exams, view statistics, and manage ongoing sessions.\n                  </p>\n                  <Link href=\"/admin/dashboard\">\n                    <Button className=\"w-full\" data-testid=\"link-dashboard\">\n                      View Dashboard\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-video text-primary\"></i>\n                    <span>Live Monitoring</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Real-time video feeds and AI-powered proctoring system.\n                  </p>\n                  <Link href=\"/admin/monitoring\">\n                    <Button className=\"w-full\" data-testid=\"link-monitoring\">\n                      Monitor Students\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-shield-alt text-primary\"></i>\n                    <span>Incident Management</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Handle security alerts, view snapshots, and manage violations.\n                  </p>\n                  <Link href=\"/admin/incidents\">\n                    <Button className=\"w-full\" data-testid=\"link-incidents\">\n                      View Incidents\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-question-circle text-primary\"></i>\n                    <span>Exam Questions</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Create, import, and manage exam questions for all assessments.\n                  </p>\n                  <Link href=\"/admin/questions\">\n                    <Button className=\"w-full\" data-testid=\"link-questions\">\n                      Manage Questions\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-chart-bar text-primary\"></i>\n                    <span>Exam Results</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    View student performance, analyze scores, and generate reports.\n                  </p>\n                  <Link href=\"/admin/results\">\n                    <Button className=\"w-full\" data-testid=\"link-results\">\n                      View Results\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            </>\n          ) : (\n            <>\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-qrcode text-primary\"></i>\n                    <span>Hall Ticket Authentication</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Scan your hall ticket QR code to authenticate for exams.\n                  </p>\n                  <Link href=\"/student/auth\">\n                    <Button className=\"w-full\" data-testid=\"link-auth\">\n                      Scan Hall Ticket\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-id-card text-primary\"></i>\n                    <span>Identity Verification</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Complete identity verification before starting your exam.\n                  </p>\n                  <Link href=\"/student/identity-verification\">\n                    <Button className=\"w-full\" data-testid=\"link-verify\">\n                      Verify Identity\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n\n              <Card className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-edit text-primary\"></i>\n                    <span>Take Exam</span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <p className=\"text-muted-foreground text-sm mb-4\">\n                    Enter secure exam mode and begin your examination.\n                  </p>\n                  <Link href=\"/student/exam\">\n                    <Button className=\"w-full\" data-testid=\"link-exam\">\n                      Start Exam\n                    </Button>\n                  </Link>\n                </CardContent>\n              </Card>\n            </>\n          )}\n        </div>\n\n        {/* System Status */}\n        <Card className=\"mt-8\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <i className=\"fas fa-heartbeat text-green-500\"></i>\n              <span>System Status</span>\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"status-indicator status-online\"></div>\n                <span className=\"text-sm\">Monitoring System</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"status-indicator status-online\"></div>\n                <span className=\"text-sm\">AI Proctoring</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"status-indicator status-online\"></div>\n                <span className=\"text-sm\">Database</span>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <div className=\"status-indicator status-online\"></div>\n                <span className=\"text-sm\">WebSocket Connection</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11105},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useState } from \"react\";\n\nexport default function Landing() {\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm sticky top-0 z-50\">\n        <nav className=\"max-w-6xl mx-auto flex justify-between items-center px-8 py-4\">\n          <a href=\"/\" className=\"flex items-center gap-2 text-2xl font-bold text-indigo-600 no-underline\">\n            <i className=\"fas fa-graduation-cap\"></i>\n            SecureExam\n          </a>\n          \n          {/* Desktop Navigation */}\n          <ul className=\"hidden md:flex items-center gap-8 list-none\">\n            <li><a href=\"#\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Home</a></li>\n            <li><a href=\"#features\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Features</a></li>\n            <li><a href=\"#stats\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">About</a></li>\n            <li><a href=\"#contact\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Contact</a></li>\n            <li>\n              <Button \n                variant=\"outline\" \n                onClick={() => window.location.href = \"/admin/login\"}\n                className=\"border-indigo-600 text-indigo-600 hover:bg-indigo-600 hover:text-white\"\n                data-testid=\"button-admin-login\"\n              >\n                Admin\n              </Button>\n            </li>\n            <li>\n              <Button \n                onClick={() => window.location.href = \"/student/auth\"}\n                className=\"bg-indigo-600 hover:bg-indigo-700 text-white\"\n                data-testid=\"button-student-login\"\n              >\n                Student Login\n              </Button>\n            </li>\n          </ul>\n\n          {/* Mobile Menu Button */}\n          <button \n            className=\"md:hidden text-slate-600 text-xl\"\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            data-testid=\"button-mobile-menu\"\n          >\n            <i className=\"fas fa-bars\"></i>\n          </button>\n        </nav>\n\n        {/* Mobile Menu */}\n        {mobileMenuOpen && (\n          <div className=\"md:hidden bg-white border-t border-slate-200 px-4 py-4\">\n            <div className=\"flex flex-col gap-4\">\n              <a href=\"#\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Home</a>\n              <a href=\"#features\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Features</a>\n              <a href=\"#stats\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">About</a>\n              <a href=\"#contact\" className=\"text-slate-600 font-medium hover:text-indigo-600 transition-colors no-underline\">Contact</a>\n              <div className=\"flex gap-2\">\n                <Button \n                  variant=\"outline\" \n                  onClick={() => window.location.href = \"/admin/login\"}\n                  className=\"border-indigo-600 text-indigo-600 hover:bg-indigo-600 hover:text-white flex-1\"\n                >\n                  Admin\n                </Button>\n                <Button \n                  onClick={() => window.location.href = \"/student/auth\"}\n                  className=\"bg-indigo-600 hover:bg-indigo-700 text-white flex-1\"\n                >\n                  Student Login\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"bg-gradient-to-br from-indigo-600 to-violet-600 text-white py-24 text-center\">\n        <div className=\"max-w-4xl mx-auto px-8\">\n          <h1 className=\"text-5xl md:text-6xl font-bold mb-6 leading-tight\">\n            Secure Online Examinations\n          </h1>\n          <p className=\"text-xl mb-8 opacity-90 max-w-3xl mx-auto\">\n            Advanced AI-powered proctoring system ensuring exam integrity with real-time monitoring and anti-cheating technology\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <Button \n              onClick={() => window.location.href = \"/student/auth\"}\n              className=\"bg-white text-indigo-600 hover:bg-gray-100 px-8 py-3 text-lg\"\n              data-testid=\"button-start-exam\"\n            >\n              <i className=\"fas fa-sign-in-alt mr-2\"></i>\n              Start Exam\n            </Button>\n            <Button \n              variant=\"outline\"\n              onClick={() => {\n                document.getElementById('features')?.scrollIntoView({ behavior: 'smooth' });\n              }}\n              className=\"border-white text-white hover:bg-white hover:text-indigo-600 px-8 py-3 text-lg\"\n              data-testid=\"button-watch-demo\"\n            >\n              <i className=\"fas fa-play mr-2\"></i>\n              Learn More\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section id=\"features\" className=\"py-24 bg-gray-50\">\n        <div className=\"max-w-6xl mx-auto px-8\">\n          <div className=\"text-center mb-16\">\n            <h2 className=\"text-4xl font-bold text-slate-800 mb-4\">\n              Why Choose SecureExam?\n            </h2>\n            <p className=\"text-lg text-slate-600 max-w-2xl mx-auto\">\n              Comprehensive examination platform with cutting-edge security features\n            </p>\n          </div>\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[\n              {\n                icon: \"fas fa-video\",\n                title: \"Live Proctoring\",\n                description: \"AI-powered real-time monitoring with facial recognition and behavior analysis to detect suspicious activities\"\n              },\n              {\n                icon: \"fas fa-shield-alt\",\n                title: \"Anti-Cheating Technology\",\n                description: \"Advanced browser lockdown, tab switching detection, and copy-paste prevention mechanisms\"\n              },\n              {\n                icon: \"fas fa-qrcode\",\n                title: \"Digital Verification\",\n                description: \"Hall ticket scanning, biometric authentication, and secure student identity verification\"\n              },\n              {\n                icon: \"fas fa-chart-line\",\n                title: \"Analytics Dashboard\",\n                description: \"Comprehensive reporting with exam analytics, performance metrics, and security incident tracking\"\n              },\n              {\n                icon: \"fas fa-mobile-alt\",\n                title: \"Multi-Device Support\",\n                description: \"Seamless experience across desktop, tablet, and mobile devices with responsive design\"\n              },\n              {\n                icon: \"fas fa-cloud\",\n                title: \"Cloud Infrastructure\",\n                description: \"Scalable cloud-based platform ensuring 99.9% uptime and secure data storage\"\n              }\n            ].map((feature, index) => (\n              <Card key={index} className=\"hover:shadow-lg transition-all duration-300 hover:-translate-y-1\">\n                <CardContent className=\"p-8\">\n                  <div className=\"w-16 h-16 bg-gradient-to-br from-indigo-600 to-violet-600 text-white rounded-xl flex items-center justify-center text-2xl mb-6\">\n                    <i className={feature.icon}></i>\n                  </div>\n                  <h3 className=\"text-xl font-semibold text-slate-800 mb-3\">\n                    {feature.title}\n                  </h3>\n                  <p className=\"text-slate-600\">\n                    {feature.description}\n                  </p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section id=\"stats\" className=\"bg-slate-800 text-white py-16\">\n        <div className=\"max-w-6xl mx-auto px-8\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8 text-center\">\n            {[\n              { number: \"50K+\", label: \"Students Examined\" },\n              { number: \"500+\", label: \"Educational Institutes\" },\n              { number: \"99.9%\", label: \"Uptime Guaranteed\" },\n              { number: \"24/7\", label: \"Technical Support\" }\n            ].map((stat, index) => (\n              <div key={index}>\n                <h3 className=\"text-4xl font-bold text-cyan-400 mb-2\">\n                  {stat.number}\n                </h3>\n                <p className=\"text-lg opacity-90\">\n                  {stat.label}\n                </p>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"bg-gradient-to-r from-cyan-500 to-indigo-600 text-white py-24 text-center\">\n        <div className=\"max-w-4xl mx-auto px-8\">\n          <h2 className=\"text-4xl font-bold mb-4\">\n            Ready to Secure Your Exams?\n          </h2>\n          <p className=\"text-lg mb-8 opacity-90\">\n            Join thousands of educational institutions using SecureExam for fraud-free examinations\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-4 justify-center\">\n            <Button \n              onClick={() => window.location.href = \"/student/auth\"}\n              className=\"bg-white text-indigo-600 hover:bg-gray-100 px-8 py-3 text-lg\"\n              data-testid=\"button-get-started\"\n            >\n              <i className=\"fas fa-rocket mr-2\"></i>\n              Get Started Now\n            </Button>\n            <Button \n              variant=\"outline\"\n              onClick={() => window.location.href = \"/admin/login\"}\n              className=\"border-white text-white hover:bg-white hover:text-indigo-600 px-8 py-3 text-lg\"\n              data-testid=\"button-contact-sales\"\n            >\n              <i className=\"fas fa-phone mr-2\"></i>\n              Contact Sales\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer id=\"contact\" className=\"bg-slate-800 text-white py-12\">\n        <div className=\"max-w-6xl mx-auto px-8\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8 mb-8\">\n            <div>\n              <h3 className=\"text-xl font-semibold mb-4\">SecureExam</h3>\n              <p className=\"text-slate-300 mb-4\">\n                Leading online examination platform with advanced security and proctoring features.\n              </p>\n              <div className=\"flex gap-4\">\n                <a href=\"#\" className=\"text-slate-300 hover:text-white text-xl\"><i className=\"fab fa-facebook\"></i></a>\n                <a href=\"#\" className=\"text-slate-300 hover:text-white text-xl\"><i className=\"fab fa-twitter\"></i></a>\n                <a href=\"#\" className=\"text-slate-300 hover:text-white text-xl\"><i className=\"fab fa-linkedin\"></i></a>\n                <a href=\"#\" className=\"text-slate-300 hover:text-white text-xl\"><i className=\"fab fa-youtube\"></i></a>\n              </div>\n            </div>\n            <div>\n              <h3 className=\"text-xl font-semibold mb-4\">Platform</h3>\n              <ul className=\"space-y-2\">\n                <li><a href=\"/student/auth\" className=\"text-slate-300 hover:text-white no-underline\">Student Login</a></li>\n                <li><a href=\"/admin/login\" className=\"text-slate-300 hover:text-white no-underline\">Admin Panel</a></li>\n                <li><a href=\"#features\" className=\"text-slate-300 hover:text-white no-underline\">Features</a></li>\n                <li><a href=\"#stats\" className=\"text-slate-300 hover:text-white no-underline\">About</a></li>\n              </ul>\n            </div>\n            <div>\n              <h3 className=\"text-xl font-semibold mb-4\">Resources</h3>\n              <ul className=\"space-y-2\">\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">Documentation</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">API Reference</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">System Requirements</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">Security Guide</a></li>\n              </ul>\n            </div>\n            <div>\n              <h3 className=\"text-xl font-semibold mb-4\">Support</h3>\n              <ul className=\"space-y-2\">\n                <li><a href=\"#contact\" className=\"text-slate-300 hover:text-white no-underline\">Contact Us</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">Help Center</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">Technical Support</a></li>\n                <li><a href=\"#\" className=\"text-slate-300 hover:text-white no-underline\">System Status</a></li>\n              </ul>\n            </div>\n          </div>\n          <div className=\"border-t border-slate-700 pt-8 text-center text-slate-300\">\n            <p>&copy; 2024 SecureExam. All rights reserved. | Privacy Policy | Terms of Service</p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":13481},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/pages/admin/dashboard.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\nimport { useEffect, useState } from \"react\";\nimport type { SecurityIncident, ExamSession } from \"@shared/schema\";\n\ninterface ExamStats {\n  activeStudents: number;\n  totalSessions: number;\n  securityAlerts: number;\n  averageProgress: number;\n}\n\ninterface StudentStatus {\n  id: string;\n  name: string;\n  rollNumber: string;\n  status: 'online' | 'offline' | 'warning' | 'alert';\n  progress: number;\n  timeRemaining: string;\n  lastActivity: string;\n}\n\nexport default function AdminDashboard() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [realTimeAlerts, setRealTimeAlerts] = useState<SecurityIncident[]>([]);\n  const [studentStatuses, setStudentStatuses] = useState<StudentStatus[]>([]);\n\n  // WebSocket connection for real-time updates\n  const { sendMessage, lastMessage } = useWebSocket();\n\n  // Fetch exam statistics\n  const { data: examStats, isLoading: statsLoading } = useQuery<ExamStats>({\n    queryKey: [\"/api/exam-stats\"],\n    refetchInterval: 5000, // Refresh every 5 seconds\n  });\n\n  // Fetch active sessions\n  const { data: activeSessions = [], isLoading: sessionsLoading } = useQuery<ExamSession[]>({\n    queryKey: [\"/api/active-sessions\"],\n    refetchInterval: 3000, // Refresh every 3 seconds\n  });\n\n  // Fetch recent security incidents\n  const { data: securityIncidents = [], isLoading: incidentsLoading } = useQuery<SecurityIncident[]>({\n    queryKey: [\"/api/security-incidents\"],\n    refetchInterval: 2000, // Refresh every 2 seconds\n  });\n\n  // Handle WebSocket messages\n  useEffect(() => {\n    if (lastMessage) {\n      try {\n        const message = JSON.parse(lastMessage.data);\n        \n        if (message.type === 'security_incident') {\n          setRealTimeAlerts(prev => [message.data, ...prev.slice(0, 4)]);\n          toast({\n            title: \"Security Alert\",\n            description: `${message.data.studentName}: ${message.data.description}`,\n            variant: \"destructive\",\n          });\n        } else if (message.type === 'student_status') {\n          setStudentStatuses(prev => {\n            const updated = [...prev];\n            const index = updated.findIndex(s => s.id === message.data.studentId);\n            if (index !== -1) {\n              updated[index] = { ...updated[index], ...message.data };\n            } else {\n              updated.push(message.data);\n            }\n            return updated.slice(0, 8); // Keep only latest 8 students\n          });\n        }\n      } catch (error) {\n        console.error('WebSocket message parse error:', error);\n      }\n    }\n  }, [lastMessage, toast]);\n\n  // Connect to admin WebSocket on mount\n  useEffect(() => {\n    if (user) {\n      sendMessage({\n        type: 'auth',\n        userId: user.id,\n        userType: 'admin'\n      });\n    }\n  }, [user, sendMessage]);\n\n  const formatTimeRemaining = (totalSeconds: number) => {\n    const hours = Math.floor(totalSeconds / 3600);\n    const minutes = Math.floor((totalSeconds % 3600) / 60);\n    const seconds = totalSeconds % 60;\n    return `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n  };\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'online': return 'status-online';\n      case 'warning': return 'status-warning';\n      case 'alert': return 'status-danger';\n      default: return 'status-offline';\n    }\n  };\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'critical': return 'border-red-500 bg-red-50';\n      case 'high': return 'border-orange-500 bg-orange-50';\n      case 'medium': return 'border-yellow-500 bg-yellow-50';\n      default: return 'border-blue-500 bg-blue-50';\n    }\n  };\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <p className=\"text-destructive\">Admin access required</p>\n            <Link href=\"/\">\n              <Button className=\"mt-4\" data-testid=\"button-home\">\n                Back to Home\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Admin Header */}\n      <div className=\"glass-header px-6 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <i className=\"fas fa-graduation-cap text-primary text-2xl\"></i>\n            <div>\n              <h1 className=\"text-xl font-bold text-foreground\">SecureExam Admin Dashboard</h1>\n              <p className=\"text-sm text-muted-foreground\">Real-time monitoring and control</p>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"status-indicator status-online\"></div>\n              <span className=\"text-sm text-muted-foreground\">System Online</span>\n            </div>\n            <Link href=\"/admin/monitoring\">\n              <Button className=\"bg-primary text-primary-foreground\" data-testid=\"button-monitoring\">\n                <i className=\"fas fa-tv mr-2\"></i>Live Monitoring\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6\">\n        {/* Stats Overview */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n          <Card className=\"shadow-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-muted-foreground text-sm\">Active Students</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"stat-active-students\">\n                    {statsLoading ? '...' : examStats?.activeStudents || 0}\n                  </p>\n                </div>\n                <div className=\"bg-green-100 p-3 rounded-lg\">\n                  <i className=\"fas fa-users text-green-600 text-xl\"></i>\n                </div>\n              </div>\n              <div className=\"flex items-center mt-2\">\n                <i className=\"fas fa-arrow-up text-green-500 text-xs mr-1\"></i>\n                <span className=\"text-green-600 text-xs\">Active now</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-muted-foreground text-sm\">Security Alerts</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"stat-security-alerts\">\n                    {statsLoading ? '...' : examStats?.securityAlerts || 0}\n                  </p>\n                </div>\n                <div className=\"bg-yellow-100 p-3 rounded-lg\">\n                  <i className=\"fas fa-exclamation-triangle text-yellow-600 text-xl\"></i>\n                </div>\n              </div>\n              <div className=\"flex items-center mt-2\">\n                <i className=\"fas fa-clock text-muted-foreground text-xs mr-1\"></i>\n                <span className=\"text-muted-foreground text-xs\">{realTimeAlerts.length} recent</span>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-muted-foreground text-sm\">Avg Progress</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"stat-avg-progress\">\n                    {statsLoading ? '...' : `${examStats?.averageProgress || 0}%`}\n                  </p>\n                </div>\n                <div className=\"bg-blue-100 p-3 rounded-lg\">\n                  <i className=\"fas fa-chart-line text-blue-600 text-xl\"></i>\n                </div>\n              </div>\n              <div className=\"flex items-center mt-2\">\n                <div className=\"w-16 bg-muted rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-500 h-2 rounded-full\" \n                    style={{ width: `${examStats?.averageProgress || 0}%` }}\n                  ></div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"shadow-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-muted-foreground text-sm\">Total Sessions</p>\n                  <p className=\"text-2xl font-bold text-foreground font-mono\" data-testid=\"stat-total-sessions\">\n                    {statsLoading ? '...' : examStats?.totalSessions || 0}\n                  </p>\n                </div>\n                <div className=\"bg-purple-100 p-3 rounded-lg\">\n                  <i className=\"fas fa-desktop text-purple-600 text-xl\"></i>\n                </div>\n              </div>\n              <div className=\"flex items-center mt-2\">\n                <span className=\"text-muted-foreground text-xs\">All time</span>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Live Student Monitoring */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"flex items-center space-x-2\">\n                    <i className=\"fas fa-video text-primary\"></i>\n                    <span>Live Student Monitoring</span>\n                  </CardTitle>\n                  <div className=\"flex items-center space-x-2\">\n                    <Button variant=\"outline\" size=\"sm\" data-testid=\"button-filter\">\n                      <i className=\"fas fa-filter mr-1\"></i>Filter\n                    </Button>\n                    <Link href=\"/admin/monitoring\">\n                      <Button size=\"sm\" className=\"bg-primary text-primary-foreground\" data-testid=\"button-full-view\">\n                        <i className=\"fas fa-expand mr-1\"></i>Full View\n                      </Button>\n                    </Link>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {sessionsLoading ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n                    <p className=\"text-muted-foreground\">Loading active sessions...</p>\n                  </div>\n                ) : activeSessions.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <i className=\"fas fa-users text-muted-foreground text-4xl mb-4\"></i>\n                    <p className=\"text-muted-foreground\">No active exam sessions</p>\n                  </div>\n                ) : (\n                  <div className=\"data-grid\">\n                    {activeSessions.slice(0, 6).map((session) => (\n                      <div key={session.id} className=\"bg-muted rounded-lg p-4\" data-testid={`student-card-${session.id}`}>\n                        <div className=\"flex items-center justify-between mb-3\">\n                          <div className=\"flex items-center space-x-3\">\n                            <div className=\"w-10 h-10 bg-gradient-primary rounded-full flex items-center justify-center text-white text-sm font-medium\">\n                              {session.studentId?.substring(0, 2).toUpperCase()}\n                            </div>\n                            <div>\n                              <p className=\"font-medium text-sm\">Student {session.studentId}</p>\n                              <p className=\"text-xs text-muted-foreground\">Session {session.id.slice(-6)}</p>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center space-x-1\">\n                            <div className={`status-indicator ${getStatusColor(session.status)}`}></div>\n                            <span className=\"text-xs text-muted-foreground capitalize\">{session.status}</span>\n                          </div>\n                        </div>\n                        \n                        <div className=\"video-feed bg-gray-800 rounded-lg mb-3\" style={{ height: '120px' }}>\n                          <div className=\"w-full h-full flex items-center justify-center text-white\">\n                            <i className=\"fas fa-video text-lg\"></i>\n                          </div>\n                          <div className=\"video-overlay\">Face: ✓</div>\n                        </div>\n                        \n                        <div className=\"flex justify-between text-xs text-muted-foreground\">\n                          <span>Progress: {session.currentQuestion || 1}/50</span>\n                          <span>Time: {formatTimeRemaining(session.timeRemaining || 0)}</span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Alert & Activity Panel */}\n          <div className=\"space-y-6\">\n            {/* Recent Alerts */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <i className=\"fas fa-exclamation-triangle text-yellow-500\"></i>\n                  <span>Recent Alerts</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {incidentsLoading ? (\n                  <div className=\"text-center py-4\">\n                    <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full mx-auto mb-2\"></div>\n                    <p className=\"text-xs text-muted-foreground\">Loading alerts...</p>\n                  </div>\n                ) : (realTimeAlerts.length > 0 ? realTimeAlerts : securityIncidents.slice(0, 3)).map((incident, index) => (\n                  <div key={incident.id || index} className={`flex items-start space-x-3 p-3 rounded-lg mb-3 border ${getSeverityColor(incident.severity)}`}>\n                    <i className={`fas ${\n                      incident.incidentType === 'multiple_faces' ? 'fa-exclamation-circle' :\n                      incident.incidentType === 'looking_away' ? 'fa-eye-slash' :\n                      incident.incidentType === 'network_disconnect' ? 'fa-wifi' :\n                      'fa-exclamation-triangle'\n                    } text-${incident.severity === 'critical' ? 'red' : incident.severity === 'high' ? 'orange' : 'yellow'}-500 mt-0.5`}></i>\n                    <div className=\"flex-1\">\n                      <p className={`text-sm font-medium text-${incident.severity === 'critical' ? 'red' : incident.severity === 'high' ? 'orange' : 'yellow'}-800`}>\n                        {incident.description}\n                      </p>\n                      <p className={`text-xs text-${incident.severity === 'critical' ? 'red' : incident.severity === 'high' ? 'orange' : 'yellow'}-600`}>\n                        {incident.incidentType.replace('_', ' ')} incident\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {new Date(incident.createdAt || '').toLocaleTimeString()}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n                \n                {!incidentsLoading && securityIncidents.length === 0 && realTimeAlerts.length === 0 && (\n                  <div className=\"text-center py-4\">\n                    <i className=\"fas fa-shield-alt text-green-500 text-2xl mb-2\"></i>\n                    <p className=\"text-sm text-green-600\">No security alerts</p>\n                    <p className=\"text-xs text-muted-foreground\">System is secure</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* System Status */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <i className=\"fas fa-heartbeat text-green-500\"></i>\n                  <span>System Status</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-muted-foreground\">AI Monitoring</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"status-indicator status-online\"></div>\n                      <span className=\"text-sm text-green-600\">Active</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-muted-foreground\">WebSocket Connection</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"status-indicator status-online\"></div>\n                      <span className=\"text-sm text-green-600\">Connected</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-muted-foreground\">Database</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"status-indicator status-online\"></div>\n                      <span className=\"text-sm text-green-600\">Operational</span>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <span className=\"text-sm text-muted-foreground\">Storage</span>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"status-indicator status-warning\"></div>\n                      <span className=\"text-sm text-yellow-600\">78% Full</span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Quick Actions */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <i className=\"fas fa-bolt text-primary\"></i>\n                  <span>Quick Actions</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <Button className=\"w-full bg-primary text-primary-foreground\" data-testid=\"button-broadcast\">\n                    <i className=\"fas fa-broadcast-tower mr-2\"></i>Send Broadcast Message\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full text-yellow-600 border-yellow-300 hover:bg-yellow-50\" data-testid=\"button-pause-all\">\n                    <i className=\"fas fa-pause mr-2\"></i>Pause All Exams\n                  </Button>\n                  <Link href=\"/admin/incidents\">\n                    <Button variant=\"outline\" className=\"w-full\" data-testid=\"button-incidents\">\n                      <i className=\"fas fa-shield-alt mr-2\"></i>View All Incidents\n                    </Button>\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":20173},"client/src/pages/admin/draft-bin.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link } from \"wouter\";\nimport { Archive, RotateCcw, Trash2, Eye, Calendar, Clock, User } from \"lucide-react\";\nimport type { HallTicket } from \"@shared/schema\";\n\nexport default function DraftBin() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedTicket, setSelectedTicket] = useState<HallTicket | null>(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n  const [showRestoreModal, setShowRestoreModal] = useState(false);\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\n\n  // Fetch all hall tickets (we'll filter inactive/submitted ones for draft bin)\n  const { data: allHallTickets = [], isLoading } = useQuery<HallTicket[]>({\n    queryKey: [\"/api/hall-tickets\"],\n  });\n\n  // Filter for submitted/inactive hall tickets that could be in draft bin\n  const draftTickets = allHallTickets.filter(ticket => !ticket.isActive);\n\n  // Restore hall ticket mutation (make it active again)\n  const restoreTicketMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest(\"PATCH\", `/api/hall-tickets/${id}`, {\n        isActive: true,\n        updatedAt: new Date().toISOString()\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Hall ticket restored successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/hall-tickets\"] });\n      setShowRestoreModal(false);\n      setSelectedTicket(null);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete hall ticket permanently\n  const deleteTicketMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/hall-tickets/${id}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Hall ticket deleted permanently\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/hall-tickets\"] });\n      setShowDeleteModal(false);\n      setSelectedTicket(null);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleViewDetails = (ticket: HallTicket) => {\n    setSelectedTicket(ticket);\n    setShowDetailsModal(true);\n  };\n\n  const handleRestore = (ticket: HallTicket) => {\n    setSelectedTicket(ticket);\n    setShowRestoreModal(true);\n  };\n\n  const handleDelete = (ticket: HallTicket) => {\n    setSelectedTicket(ticket);\n    setShowDeleteModal(true);\n  };\n\n  const getTicketStatus = (ticket: HallTicket) => {\n    if (!ticket.isActive) {\n      return { label: \"Inactive\", variant: \"secondary\" as const };\n    }\n    return { label: \"Active\", variant: \"default\" as const };\n  };\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <p className=\"text-destructive\">Admin access required</p>\n            <Link href=\"/\">\n              <Button className=\"mt-4\" data-testid=\"button-home\">\n                Back to Home\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 p-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-2\">\n              <Archive className=\"h-8 w-8 text-purple-600\" />\n              Draft Bin\n            </h1>\n            <p className=\"text-gray-600 dark:text-gray-300 mt-2\">\n              Manage submitted and inactive hall tickets\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Link href=\"/admin/hall-ticket-generation\">\n              <Button variant=\"outline\" data-testid=\"button-hall-tickets\">\n                <Archive className=\"w-4 h-4 mr-2\" />\n                Hall Tickets\n              </Button>\n            </Link>\n            <Link href=\"/admin/dashboard\">\n              <Button variant=\"outline\" data-testid=\"button-dashboard\">\n                Dashboard\n              </Button>\n            </Link>\n          </div>\n        </div>\n\n        {/* Summary Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Draft Tickets</CardTitle>\n              <Archive className=\"h-4 w-4 text-purple-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-purple-600\" data-testid=\"text-draft-count\">\n                {draftTickets.length}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Tickets</CardTitle>\n              <Archive className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"text-total-count\">\n                {allHallTickets.length}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Active Tickets</CardTitle>\n              <Archive className=\"h-4 w-4 text-green-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-active-count\">\n                {allHallTickets.filter(t => t.isActive).length}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Draft Tickets List */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex justify-between items-center\">\n              <CardTitle>Inactive Hall Tickets</CardTitle>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => queryClient.invalidateQueries({ queryKey: [\"/api/hall-tickets\"] })}\n                data-testid=\"button-refresh\"\n              >\n                Refresh\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4\"></div>\n                <p className=\"text-gray-600 dark:text-gray-300\">Loading draft tickets...</p>\n              </div>\n            ) : draftTickets.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <Archive className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-600 mb-2\">No Draft Tickets</h3>\n                <p className=\"text-gray-500\">All hall tickets are currently active</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {draftTickets.map((ticket) => {\n                  const status = getTicketStatus(ticket);\n                  return (\n                    <div key={ticket.id} className=\"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors\">\n                      <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4\">\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <h3 className=\"font-semibold text-gray-900 dark:text-white\" data-testid={`text-ticket-${ticket.hallTicketId}`}>\n                              {ticket.hallTicketId}\n                            </h3>\n                            <Badge variant={status.variant}>\n                              {status.label}\n                            </Badge>\n                            <Badge variant=\"outline\">\n                              {ticket.examName}\n                            </Badge>\n                          </div>\n                          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm text-gray-600 dark:text-gray-300\">\n                            <div className=\"flex items-center gap-2\">\n                              <User className=\"h-4 w-4\" />\n                              <span>{ticket.studentName}</span>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <span className=\"font-medium\">Roll:</span>\n                              <span>{ticket.rollNumber}</span>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <Calendar className=\"h-4 w-4\" />\n                              <span>{new Date(ticket.examDate).toLocaleDateString()}</span>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <Clock className=\"h-4 w-4\" />\n                              <span>{ticket.duration} min</span>\n                            </div>\n                          </div>\n                          <div className=\"mt-2 text-xs text-gray-500\">\n                            Created: {new Date(ticket.createdAt || '').toLocaleString()}\n                          </div>\n                        </div>\n                        \n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleViewDetails(ticket)}\n                            data-testid={`button-view-${ticket.hallTicketId}`}\n                          >\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"text-green-600 border-green-300\"\n                            onClick={() => handleRestore(ticket)}\n                            data-testid={`button-restore-${ticket.hallTicketId}`}\n                          >\n                            <RotateCcw className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"text-red-600 border-red-300\"\n                            onClick={() => handleDelete(ticket)}\n                            data-testid={`button-delete-${ticket.hallTicketId}`}\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Details Modal */}\n      {showDetailsModal && selectedTicket && (\n        <Dialog open={showDetailsModal} onOpenChange={setShowDetailsModal}>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>Hall Ticket Details</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Hall Ticket ID</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.hallTicketId}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Status</Label>\n                  <Badge variant={getTicketStatus(selectedTicket).variant} className=\"ml-2\">\n                    {getTicketStatus(selectedTicket).label}\n                  </Badge>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Student Name</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.studentName}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Roll Number</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.rollNumber}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Email</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.studentEmail}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Exam Name</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.examName}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Exam Date</Label>\n                  <p className=\"text-gray-900 dark:text-white\">\n                    {new Date(selectedTicket.examDate).toLocaleDateString()}\n                  </p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Duration</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.duration} minutes</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Total Questions</Label>\n                  <p className=\"text-gray-900 dark:text-white\">{selectedTicket.totalQuestions}</p>\n                </div>\n                <div>\n                  <Label className=\"text-sm font-medium text-gray-500\">Created</Label>\n                  <p className=\"text-gray-900 dark:text-white\">\n                    {new Date(selectedTicket.createdAt || '').toLocaleString()}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Restore Confirmation Modal */}\n      {showRestoreModal && selectedTicket && (\n        <Dialog open={showRestoreModal} onOpenChange={setShowRestoreModal}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Restore Hall Ticket</DialogTitle>\n            </DialogHeader>\n            <p className=\"text-gray-600 dark:text-gray-300\">\n              Are you sure you want to restore hall ticket <strong>{selectedTicket.hallTicketId}</strong>? \n              This will make it active and available for use again.\n            </p>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setShowRestoreModal(false)}>\n                Cancel\n              </Button>\n              <Button\n                onClick={() => restoreTicketMutation.mutate(selectedTicket.id)}\n                disabled={restoreTicketMutation.isPending}\n                data-testid=\"button-confirm-restore\"\n              >\n                {restoreTicketMutation.isPending ? \"Restoring...\" : \"Restore\"}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Delete Confirmation Modal */}\n      {showDeleteModal && selectedTicket && (\n        <Dialog open={showDeleteModal} onOpenChange={setShowDeleteModal}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Delete Hall Ticket</DialogTitle>\n            </DialogHeader>\n            <p className=\"text-gray-600 dark:text-gray-300\">\n              Are you sure you want to permanently delete hall ticket <strong>{selectedTicket.hallTicketId}</strong>? \n              This action cannot be undone.\n            </p>\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={() => setShowDeleteModal(false)}>\n                Cancel\n              </Button>\n              <Button\n                variant=\"destructive\"\n                onClick={() => deleteTicketMutation.mutate(selectedTicket.id)}\n                disabled={deleteTicketMutation.isPending}\n                data-testid=\"button-confirm-delete\"\n              >\n                {deleteTicketMutation.isPending ? \"Deleting...\" : \"Delete Permanently\"}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  );\n}","size_bytes":17578},"client/src/pages/admin/hall-ticket-generation.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link, useLocation } from \"wouter\";\nimport type { HallTicket } from \"@shared/schema\";\nimport jsPDF from \"jspdf\";\n\nexport default function HallTicketGeneration() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n  \n  const [formData, setFormData] = useState({\n    examName: \"\",\n    examDate: \"\",\n    duration: 180,\n    totalQuestions: 50,\n    rollNumber: \"\",\n    studentName: \"\",\n    studentEmail: \"\",\n  });\n  const [selectedTicket, setSelectedTicket] = useState<HallTicket | null>(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n\n  // Fetch existing hall tickets\n  const { data: hallTickets = [], isLoading } = useQuery<HallTicket[]>({\n    queryKey: [\"/api/hall-tickets\"],\n  });\n\n  // Create hall ticket mutation\n  const createHallTicketMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const response = await apiRequest(\"POST\", \"/api/hall-tickets\", data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Hall ticket created successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/hall-tickets\"] });\n      // Reset form\n      setFormData({\n        examName: \"\",\n        examDate: \"\",\n        duration: 180,\n        totalQuestions: 50,\n        rollNumber: \"\",\n        studentName: \"\",\n        studentEmail: \"\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete hall ticket mutation\n  const deleteHallTicketMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/hall-tickets/${id}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Hall ticket deleted successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/hall-tickets\"] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    createHallTicketMutation.mutate(formData);\n  };\n\n  const handleInputChange = (field: string, value: string | number) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleViewDetails = (ticket: HallTicket) => {\n    setSelectedTicket(ticket);\n    setShowDetailsModal(true);\n  };\n\n  const handleDownloadPDF = async (ticket: HallTicket) => {\n    try {\n      // Generate PDF for hall ticket\n      const canvas = document.createElement('canvas');\n      const ctx = canvas.getContext('2d');\n      if (!ctx) return;\n\n      // Set canvas size for A4 paper (595x842 points)\n      canvas.width = 595;\n      canvas.height = 842;\n\n      // Fill background\n      ctx.fillStyle = '#ffffff';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n      // Add header\n      ctx.fillStyle = '#1e40af';\n      ctx.fillRect(0, 0, canvas.width, 80);\n\n      // Add title\n      ctx.fillStyle = '#ffffff';\n      ctx.font = 'bold 24px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText('HALL TICKET', canvas.width / 2, 35);\n      ctx.font = 'normal 14px Arial';\n      ctx.fillText('University Examination', canvas.width / 2, 55);\n\n      // Add content\n      ctx.fillStyle = '#000000';\n      ctx.textAlign = 'left';\n      ctx.font = 'bold 16px Arial';\n      \n      let y = 140;\n      const lineHeight = 30;\n\n      // Student details\n      ctx.fillText(`Hall Ticket ID: ${ticket.hallTicketId}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Student Name: ${ticket.studentName}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Roll Number: ${ticket.rollNumber}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Email: ${ticket.studentEmail}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Exam: ${ticket.examName}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Date: ${new Date(ticket.examDate).toLocaleDateString()}`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Duration: ${ticket.duration} minutes`, 50, y);\n      y += lineHeight;\n      ctx.fillText(`Questions: ${ticket.totalQuestions}`, 50, y);\n\n      // Add QR code section\n      y += 60;\n      ctx.fillText('QR Code for Authentication:', 50, y);\n      y += 40;\n\n      // Generate QR code\n      const qrResponse = await fetch(`/api/hall-tickets/${ticket.id}/qr`);\n      const qrData = await qrResponse.json();\n      \n      if (qrData.qrCodeUrl) {\n        const img = new Image();\n        img.onload = () => {\n          ctx.drawImage(img, 50, y, 200, 200);\n          \n          // Instructions\n          ctx.font = 'normal 12px Arial';\n          ctx.fillText('1. Scan this QR code during exam authentication', 50, y + 230);\n          ctx.fillText('2. Keep this hall ticket safe and bring it to the exam', 50, y + 250);\n          ctx.fillText('3. Arrive 30 minutes before the exam time', 50, y + 270);\n          \n          // Create PDF with jsPDF\n          const pdf = new jsPDF();\n          \n          // Add the canvas as image to PDF\n          pdf.addImage(canvas, 'PNG', 0, 0, 210, 297); // A4 size in mm\n          \n          // Save as PDF\n          pdf.save(`hall-ticket-${ticket.hallTicketId}.pdf`);\n\n          toast({\n            title: \"Download Complete\",\n            description: `Hall ticket for ${ticket.studentName} downloaded successfully`,\n          });\n        };\n        img.src = qrData.qrCodeUrl;\n      }\n    } catch (error) {\n      toast({\n        title: \"Download Failed\",\n        description: \"Failed to generate hall ticket PDF\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <p className=\"text-destructive\">Admin access required</p>\n            <Link href=\"/\">\n              <Button className=\"mt-4\" data-testid=\"button-home\">\n                Back to Home\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-primary\">\n      {/* Header */}\n      <div className=\"glass-header px-6 py-4\">\n        <div className=\"max-w-6xl mx-auto flex items-center justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            <i className=\"fas fa-graduation-cap text-white text-2xl\"></i>\n            <h1 className=\"text-2xl font-bold text-white\">SecureExam - Admin Portal</h1>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"text-white text-sm\">\n              <span className=\"opacity-75\">Admin:</span> {user?.firstName || user?.email}\n            </div>\n            <Button\n              variant=\"secondary\"\n              onClick={() => window.location.href = \"/api/logout\"}\n              data-testid=\"button-logout\"\n            >\n              <i className=\"fas fa-sign-out-alt mr-2\"></i>Logout\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* Back Button */}\n      <div className=\"fixed top-20 left-4 z-10\">\n        <Button \n          variant=\"outline\" \n          onClick={() => setLocation(\"/admin/dashboard\")} \n          className=\"bg-white/10 border-white/20 text-white hover:bg-white/20\"\n          data-testid=\"button-back\"\n        >\n          <i className=\"fas fa-arrow-left mr-2\"></i>\n          Back\n        </Button>\n      </div>\n      \n      <div className=\"max-w-6xl mx-auto p-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Hall Ticket Generation Form */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"shadow-xl\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-2xl\">Generate Hall Tickets</CardTitle>\n                  <div className=\"flex items-center space-x-2\">\n                    <Link href=\"/admin/draft-bin\">\n                      <Button variant=\"outline\" data-testid=\"button-draft-bin\">\n                        <i className=\"fas fa-folder-open mr-2\"></i>Draft Bin\n                      </Button>\n                    </Link>\n                    <Button variant=\"outline\" data-testid=\"button-bulk-export\">\n                      <i className=\"fas fa-download mr-2\"></i>Bulk Export\n                    </Button>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div>\n                      <Label htmlFor=\"examName\">Exam Details</Label>\n                      <Input\n                        id=\"examName\"\n                        placeholder=\"Computer Science Final\"\n                        value={formData.examName}\n                        onChange={(e) => handleInputChange(\"examName\", e.target.value)}\n                        required\n                        data-testid=\"input-exam-name\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"examDate\">Exam Date</Label>\n                      <Input\n                        id=\"examDate\"\n                        type=\"date\"\n                        value={formData.examDate}\n                        onChange={(e) => handleInputChange(\"examDate\", e.target.value)}\n                        required\n                        data-testid=\"input-exam-date\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"duration\">Duration (minutes)</Label>\n                      <Input\n                        id=\"duration\"\n                        type=\"number\"\n                        value={formData.duration}\n                        onChange={(e) => handleInputChange(\"duration\", parseInt(e.target.value))}\n                        required\n                        data-testid=\"input-duration\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"totalQuestions\">Total Questions</Label>\n                      <Input\n                        id=\"totalQuestions\"\n                        type=\"number\"\n                        value={formData.totalQuestions}\n                        onChange={(e) => handleInputChange(\"totalQuestions\", parseInt(e.target.value))}\n                        required\n                        data-testid=\"input-total-questions\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"rollNumber\">Roll Number</Label>\n                      <Input\n                        id=\"rollNumber\"\n                        placeholder=\"CS21B1234\"\n                        value={formData.rollNumber}\n                        onChange={(e) => handleInputChange(\"rollNumber\", e.target.value)}\n                        required\n                        data-testid=\"input-roll-number\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"studentName\">Student Name</Label>\n                      <Input\n                        id=\"studentName\"\n                        placeholder=\"John Smith\"\n                        value={formData.studentName}\n                        onChange={(e) => handleInputChange(\"studentName\", e.target.value)}\n                        required\n                        data-testid=\"input-student-name\"\n                      />\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label htmlFor=\"studentEmail\">Student Email</Label>\n                      <Input\n                        id=\"studentEmail\"\n                        type=\"email\"\n                        placeholder=\"john.smith@university.edu\"\n                        value={formData.studentEmail}\n                        onChange={(e) => handleInputChange(\"studentEmail\", e.target.value)}\n                        required\n                        data-testid=\"input-student-email\"\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-end space-x-4\">\n                    <Button type=\"button\" variant=\"outline\" data-testid=\"button-save-draft\">\n                      Save Draft\n                    </Button>\n                    <Button \n                      type=\"submit\" \n                      disabled={createHallTicketMutation.isPending}\n                      data-testid=\"button-generate\"\n                    >\n                      {createHallTicketMutation.isPending ? (\n                        <>\n                          <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\"></div>\n                          Generating...\n                        </>\n                      ) : (\n                        <>\n                          <i className=\"fas fa-qrcode mr-2\"></i>Generate Hall Ticket\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Preview Panel */}\n          <div>\n            <Card className=\"shadow-xl\">\n              <CardHeader>\n                <CardTitle>Hall Ticket Preview</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"bg-muted p-6 rounded-lg border-2 border-dashed border-primary\">\n                  <div className=\"text-center mb-4\">\n                    <h4 className=\"font-bold text-lg\">UNIVERSITY EXAMINATION</h4>\n                    <p className=\"text-sm text-muted-foreground\">{formData.examName || \"Exam Name\"}</p>\n                  </div>\n                  \n                  <div className=\"space-y-3 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Roll Number:</span>\n                      <span className=\"font-medium\">{formData.rollNumber || \"CS21B1234\"}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Student Name:</span>\n                      <span className=\"font-medium\">{formData.studentName || \"Student Name\"}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Date & Time:</span>\n                      <span className=\"font-medium\">{formData.examDate || \"Date\"}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-muted-foreground\">Duration:</span>\n                      <span className=\"font-medium\">{formData.duration} minutes</span>\n                    </div>\n                  </div>\n\n                  <div className=\"mt-6 flex justify-center\">\n                    <div className=\"qr-scanner\">\n                      <div className=\"text-center\">\n                        <div className=\"grid grid-cols-8 gap-1 mb-2\">\n                          {Array.from({ length: 16 }).map((_, i) => (\n                            <div \n                              key={i} \n                              className={`w-3 h-3 ${Math.random() > 0.5 ? 'bg-foreground' : 'bg-muted'}`} \n                            />\n                          ))}\n                        </div>\n                        <p className=\"text-xs text-muted-foreground\">Scan to verify</p>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"mt-4 text-xs text-muted-foreground text-center\">\n                    Hall Ticket ID: Will be generated\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Recent Hall Tickets */}\n            <Card className=\"shadow-xl mt-6\">\n              <CardHeader>\n                <CardTitle>Recent Hall Tickets</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"text-center py-4\">\n                    <div className=\"animate-spin w-6 h-6 border-2 border-primary border-t-transparent rounded-full mx-auto mb-2\"></div>\n                    <p className=\"text-sm text-muted-foreground\">Loading...</p>\n                  </div>\n                ) : hallTickets.length === 0 ? (\n                  <p className=\"text-center text-muted-foreground py-4\">No hall tickets created yet</p>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {hallTickets.slice(0, 5).map((ticket: HallTicket) => (\n                      <div key={ticket.id} className=\"flex items-center justify-between p-3 bg-muted rounded-lg\">\n                        <div>\n                          <div className=\"font-medium text-sm\">{ticket.hallTicketId}</div>\n                          <div className=\"text-xs text-muted-foreground\">{ticket.studentName} ({ticket.rollNumber})</div>\n                          <div className=\"text-xs text-muted-foreground\">{ticket.examName} • {new Date(ticket.examDate).toLocaleDateString()}</div>\n                        </div>\n                        <div className=\"flex items-center space-x-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => handleViewDetails(ticket)} data-testid={`button-view-details-${ticket.id}`}>\n                            <i className=\"fas fa-eye mr-1\"></i>View\n                          </Button>\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownloadPDF(ticket)} data-testid={`button-download-${ticket.id}`}>\n                            <i className=\"fas fa-download mr-1\"></i>PDF\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"destructive\" \n                            onClick={() => deleteHallTicketMutation.mutate(ticket.id)} \n                            data-testid={`button-delete-${ticket.id}`}\n                          >\n                            <i className=\"fas fa-trash mr-1\"></i>Delete\n                          </Button>\n                          <div className=\"status-indicator status-online\"></div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Detailed View Modal */}\n      <Dialog open={showDetailsModal} onOpenChange={setShowDetailsModal}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>Hall Ticket Details</DialogTitle>\n          </DialogHeader>\n          \n          {selectedTicket && (\n            <div className=\"space-y-6\">\n              {/* Student Information */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">Student Information</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Hall Ticket ID</Label>\n                      <p className=\"font-mono text-sm\">{selectedTicket.hallTicketId}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Roll Number</Label>\n                      <p className=\"text-sm\">{selectedTicket.rollNumber}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Student Name</Label>\n                      <p className=\"text-sm\">{selectedTicket.studentName}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Email</Label>\n                      <p className=\"text-sm\">{selectedTicket.studentEmail}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Exam Information */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">Exam Information</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Exam Name</Label>\n                      <p className=\"text-sm\">{selectedTicket.examName}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Date</Label>\n                      <p className=\"text-sm\">{new Date(selectedTicket.examDate).toLocaleDateString()}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Duration</Label>\n                      <p className=\"text-sm\">{selectedTicket.duration} minutes</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Total Questions</Label>\n                      <p className=\"text-sm\">{selectedTicket.totalQuestions}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Status</Label>\n                      <p className=\"text-sm\">\n                        <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\n                          selectedTicket.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n                        }`}>\n                          {selectedTicket.isActive ? 'Active' : 'Inactive'}\n                        </span>\n                      </p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-muted-foreground\">Created</Label>\n                      <p className=\"text-sm\">{selectedTicket.createdAt ? new Date(selectedTicket.createdAt).toLocaleDateString() : 'N/A'}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Actions */}\n              <div className=\"flex justify-end space-x-2\">\n                <Button variant=\"outline\" onClick={() => setShowDetailsModal(false)}>\n                  Close\n                </Button>\n                <Button onClick={() => handleDownloadPDF(selectedTicket)}>\n                  <i className=\"fas fa-download mr-2\"></i>Download PDF\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":23874},"client/src/pages/admin/incidents.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link } from \"wouter\";\nimport type { SecurityIncident } from \"@shared/schema\";\n\ninterface IncidentStats {\n  critical: number;\n  high: number;\n  medium: number;\n  low: number;\n  resolved: number;\n}\n\nexport default function IncidentManagement() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedIncident, setSelectedIncident] = useState<SecurityIncident | null>(null);\n  const [snapshotModalOpen, setSnapshotModalOpen] = useState(false);\n\n  // Fetch security incidents\n  const { data: incidents = [], isLoading } = useQuery<SecurityIncident[]>({\n    queryKey: [\"/api/security-incidents\"],\n    refetchInterval: 5000, // Refresh every 5 seconds\n  });\n\n  // Resolve incident mutation\n  const resolveIncidentMutation = useMutation({\n    mutationFn: async ({ id, action }: { id: string; action: string }) => {\n      const response = await apiRequest(\"PATCH\", `/api/security-incidents/${id}`, {\n        isResolved: true,\n        resolvedBy: user?.id,\n        // Let the database handle the timestamp - avoid client-side Date object\n        resolutionAction: action\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Incident Resolved\",\n        description: \"Security incident has been marked as resolved\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/security-incidents\"] });\n      setSelectedIncident(null);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getIncidentStats = (): IncidentStats => {\n    return incidents.reduce((stats, incident) => {\n      if (incident.isResolved) {\n        stats.resolved++;\n      } else {\n        switch (incident.severity) {\n          case 'critical':\n            stats.critical++;\n            break;\n          case 'high':\n            stats.high++;\n            break;\n          case 'medium':\n            stats.medium++;\n            break;\n          case 'low':\n            stats.low++;\n            break;\n        }\n      }\n      return stats;\n    }, { critical: 0, high: 0, medium: 0, low: 0, resolved: 0 });\n  };\n\n  const getSeverityColor = (severity: string) => {\n    switch (severity) {\n      case 'critical': return 'destructive';\n      case 'high': return 'destructive';\n      case 'medium': return 'secondary';\n      default: return 'secondary';\n    }\n  };\n\n  const getSeverityBorder = (severity: string) => {\n    switch (severity) {\n      case 'critical': return 'border-l-red-500 bg-red-50';\n      case 'high': return 'border-l-orange-500 bg-orange-50';\n      case 'medium': return 'border-l-yellow-500 bg-yellow-50';\n      default: return 'border-l-blue-500 bg-blue-50';\n    }\n  };\n\n  const getIncidentIcon = (type: string) => {\n    switch (type) {\n      case 'multiple_faces': return 'fa-exclamation-circle';\n      case 'looking_away': return 'fa-eye-slash';\n      case 'network_disconnect': return 'fa-wifi';\n      case 'fullscreen_exit': return 'fa-expand';\n      default: return 'fa-exclamation-triangle';\n    }\n  };\n\n  const handleResolveIncident = (incident: SecurityIncident, action: string) => {\n    resolveIncidentMutation.mutate({ id: incident.id, action });\n  };\n\n  const stats = getIncidentStats();\n  const activeIncidents = incidents.filter(i => !i.isResolved);\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <p className=\"text-destructive\">Admin access required</p>\n            <Link href=\"/\">\n              <Button className=\"mt-4\" data-testid=\"button-home\">\n                Back to Home\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Incident Header */}\n      <div className=\"glass-header px-6 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <i className=\"fas fa-shield-alt text-red-500 text-2xl\"></i>\n            <div>\n              <h1 className=\"text-xl font-bold text-foreground\">Incident Management System</h1>\n              <p className=\"text-sm text-muted-foreground\">Security alerts, snapshots, and audit trail</p>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium\">\n              <i className=\"fas fa-exclamation-triangle mr-1\"></i>{stats.critical + stats.high + stats.medium + stats.low} Active Alerts\n            </div>\n            <Button variant=\"destructive\" data-testid=\"button-alert-proctors\">\n              <i className=\"fas fa-bell mr-2\"></i>Alert All Proctors\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Active Incidents */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle>Active Security Incidents</CardTitle>\n                  <Button variant=\"outline\" size=\"sm\" data-testid=\"button-export-report\">\n                    <i className=\"fas fa-download mr-1\"></i>Export Report\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n                    <p className=\"text-muted-foreground\">Loading incidents...</p>\n                  </div>\n                ) : activeIncidents.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <i className=\"fas fa-shield-alt text-green-500 text-4xl mb-4\"></i>\n                    <h3 className=\"text-lg font-semibold text-green-600 mb-2\">No Active Incidents</h3>\n                    <p className=\"text-muted-foreground\">All systems are secure and monitoring normally</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {activeIncidents.map((incident) => (\n                      <div key={incident.id} className={`border-l-4 rounded-lg p-4 ${getSeverityBorder(incident.severity)}`} data-testid={`incident-${incident.id}`}>\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex items-start space-x-3\">\n                            <i className={`fas ${getIncidentIcon(incident.incidentType)} text-xl mt-1 ${\n                              incident.severity === 'critical' ? 'text-red-500' :\n                              incident.severity === 'high' ? 'text-orange-500' :\n                              incident.severity === 'medium' ? 'text-yellow-500' :\n                              'text-blue-500'\n                            }`}></i>\n                            <div>\n                              <h3 className={`font-semibold ${\n                                incident.severity === 'critical' ? 'text-red-800' :\n                                incident.severity === 'high' ? 'text-orange-800' :\n                                incident.severity === 'medium' ? 'text-yellow-800' :\n                                'text-blue-800'\n                              }`}>\n                                {incident.description}\n                              </h3>\n                              <p className={`text-sm ${\n                                incident.severity === 'critical' ? 'text-red-600' :\n                                incident.severity === 'high' ? 'text-orange-600' :\n                                incident.severity === 'medium' ? 'text-yellow-600' :\n                                'text-blue-600'\n                              }`}>\n                                {incident.incidentType.replace('_', ' ').toUpperCase()} - {incident.severity.toUpperCase()}\n                              </p>\n                              <p className=\"text-xs text-muted-foreground mt-1\">\n                                {new Date(incident.createdAt || '').toLocaleString()}\n                              </p>\n                            </div>\n                          </div>\n                          <div className=\"flex space-x-2\">\n                            {incident.snapshotUrl && (\n                              <Button \n                                size=\"sm\" \n                                variant=\"outline\" \n                                onClick={() => {\n                                  setSelectedIncident(incident);\n                                  setSnapshotModalOpen(true);\n                                }}\n                                data-testid={`button-view-snapshot-${incident.id}`}\n                              >\n                                <i className=\"fas fa-camera mr-1\"></i>View Snapshot\n                              </Button>\n                            )}\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\" \n                              className=\"text-yellow-600 border-yellow-300\"\n                              onClick={() => handleResolveIncident(incident, 'flagged')}\n                              data-testid={`button-flag-${incident.id}`}\n                            >\n                              <i className=\"fas fa-flag mr-1\"></i>Flag Student\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\" \n                              className=\"text-green-600 border-green-300\"\n                              onClick={() => handleResolveIncident(incident, 'resolved')}\n                              data-testid={`button-resolve-${incident.id}`}\n                            >\n                              <i className=\"fas fa-check mr-1\"></i>Resolve\n                            </Button>\n                          </div>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                          <div className=\"bg-white rounded-lg p-3\">\n                            <h4 className=\"text-sm font-medium mb-2\">Detection Details</h4>\n                            <div className=\"text-xs space-y-1\">\n                              <div className=\"flex justify-between\">\n                                <span>Type:</span>\n                                <span className=\"font-medium capitalize\">{incident.incidentType.replace('_', ' ')}</span>\n                              </div>\n                              <div className=\"flex justify-between\">\n                                <span>Severity:</span>\n                                <Badge variant={getSeverityColor(incident.severity)} className=\"text-xs\">\n                                  {incident.severity}\n                                </Badge>\n                              </div>\n                              {incident.metadata && typeof incident.metadata === 'object' && (\n                                <>\n                                  {(incident.metadata as any).confidence && (\n                                    <div className=\"flex justify-between\">\n                                      <span>Confidence:</span>\n                                      <span className=\"font-medium\">\n                                        {Math.round((incident.metadata as any).confidence * 100)}%\n                                      </span>\n                                    </div>\n                                  )}\n                                  {(incident.metadata as any).duration && (\n                                    <div className=\"flex justify-between\">\n                                      <span>Duration:</span>\n                                      <span className=\"font-medium\">{(incident.metadata as any).duration}s</span>\n                                    </div>\n                                  )}\n                                </>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"bg-white rounded-lg p-3\">\n                            <h4 className=\"text-sm font-medium mb-2\">Actions Available</h4>\n                            <div className=\"text-xs space-y-1\">\n                              <div className=\"flex items-center space-x-1\">\n                                <i className=\"fas fa-camera text-blue-500\"></i>\n                                <span>Snapshot captured</span>\n                              </div>\n                              <div className=\"flex items-center space-x-1\">\n                                <i className=\"fas fa-bell text-yellow-500\"></i>\n                                <span>Admin notified</span>\n                              </div>\n                              <div className=\"flex items-center space-x-1\">\n                                <i className=\"fas fa-clock text-gray-500\"></i>\n                                <span>Awaiting response</span>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Incident Statistics & Controls */}\n          <div className=\"space-y-6\">\n            {/* Incident Summary */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle>Incident Summary</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\n                      <span className=\"text-sm\">Critical Alerts</span>\n                    </div>\n                    <span className=\"font-semibold text-red-600\" data-testid=\"stat-critical\">\n                      {stats.critical}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-3 h-3 bg-orange-500 rounded-full\"></div>\n                      <span className=\"text-sm\">High Priority</span>\n                    </div>\n                    <span className=\"font-semibold text-orange-600\" data-testid=\"stat-high\">\n                      {stats.high}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-3 h-3 bg-yellow-500 rounded-full\"></div>\n                      <span className=\"text-sm\">Warnings</span>\n                    </div>\n                    <span className=\"font-semibold text-yellow-600\" data-testid=\"stat-medium\">\n                      {stats.medium}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n                      <span className=\"text-sm\">Low Priority</span>\n                    </div>\n                    <span className=\"font-semibold text-blue-600\" data-testid=\"stat-low\">\n                      {stats.low}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center justify-between border-t pt-2\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"w-3 h-3 bg-green-500 rounded-full\"></div>\n                      <span className=\"text-sm\">Resolved Today</span>\n                    </div>\n                    <span className=\"font-semibold text-green-600\" data-testid=\"stat-resolved\">\n                      {stats.resolved}\n                    </span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Snapshot Gallery */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle>Recent Snapshots</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {[1, 2, 3, 4].map((index) => (\n                    <div key={index} className=\"relative group cursor-pointer\" data-testid={`snapshot-${index}`}>\n                      <div className=\"aspect-video bg-gray-800 rounded-lg flex items-center justify-center\">\n                        <i className={`fas ${\n                          index === 1 ? 'fa-users text-red-400' :\n                          index === 2 ? 'fa-eye-slash text-yellow-400' :\n                          index === 3 ? 'fa-user text-green-400' :\n                          'fa-mobile-alt text-blue-400'\n                        } text-lg`}></i>\n                      </div>\n                      <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center\">\n                        <i className=\"fas fa-search-plus text-white text-lg\"></i>\n                      </div>\n                      <div className={`absolute bottom-1 left-1 px-1 py-0.5 rounded text-xs text-white ${\n                        index === 1 ? 'bg-red-500' :\n                        index === 2 ? 'bg-yellow-500' :\n                        index === 3 ? 'bg-green-500' :\n                        'bg-blue-500'\n                      }`}>\n                        {index === 1 ? 'Critical' :\n                         index === 2 ? 'Warning' :\n                         index === 3 ? 'Normal' :\n                         'Device'}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                <Button variant=\"outline\" className=\"w-full mt-4\" data-testid=\"button-view-all-snapshots\">\n                  View All Snapshots\n                </Button>\n              </CardContent>\n            </Card>\n\n            {/* Response Actions */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle>Response Actions</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <Button variant=\"destructive\" className=\"w-full\" data-testid=\"button-suspend-student\">\n                    <i className=\"fas fa-ban mr-2\"></i>Suspend Student\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full text-yellow-600 border-yellow-300\" data-testid=\"button-flag-review\">\n                    <i className=\"fas fa-flag mr-2\"></i>Flag for Review\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full text-blue-600 border-blue-300\" data-testid=\"button-send-warning\">\n                    <i className=\"fas fa-bell mr-2\"></i>Send Warning\n                  </Button>\n                  <Button variant=\"outline\" className=\"w-full text-green-600 border-green-300\" data-testid=\"button-mark-resolved\">\n                    <i className=\"fas fa-check mr-2\"></i>Mark All Resolved\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Recent Activity */}\n            <Card className=\"shadow-sm\">\n              <CardHeader>\n                <CardTitle>Recent Activity</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {incidents.slice(0, 5).map((incident, index) => (\n                    <div key={incident.id} className=\"flex items-start space-x-3 text-sm\">\n                      <div className={`w-2 h-2 rounded-full mt-2 ${\n                        incident.severity === 'critical' ? 'bg-red-500' :\n                        incident.severity === 'high' ? 'bg-orange-500' :\n                        incident.severity === 'medium' ? 'bg-yellow-500' :\n                        'bg-blue-500'\n                      }`}></div>\n                      <div>\n                        <p className=\"text-foreground\">\n                          {incident.isResolved ? 'Incident resolved' : 'Alert triggered'}: {incident.incidentType.replace('_', ' ')}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {new Date(incident.createdAt || '').toLocaleString()}\n                        </p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Snapshot Modal */}\n      {snapshotModalOpen && selectedIncident && (\n        <div className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\" onClick={() => setSnapshotModalOpen(false)}>\n          <div className=\"bg-card rounded-xl shadow-2xl p-6 max-w-2xl w-full mx-4\" onClick={(e) => e.stopPropagation()}>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold text-foreground\">Security Incident Snapshot</h3>\n              <Button variant=\"ghost\" onClick={() => setSnapshotModalOpen(false)} data-testid=\"button-close-modal\">\n                <i className=\"fas fa-times\"></i>\n              </Button>\n            </div>\n            <div className=\"bg-gray-800 rounded-lg aspect-video flex items-center justify-center mb-4\">\n              <div className=\"text-center text-white\">\n                <i className={`fas ${getIncidentIcon(selectedIncident.incidentType)} text-4xl mb-2`}></i>\n                <p>Incident Snapshot</p>\n                <p className=\"text-sm opacity-75\">{selectedIncident.incidentType.replace('_', ' ')}</p>\n              </div>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">\n                  Captured: {new Date(selectedIncident.createdAt || '').toLocaleString()}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Severity: <Badge variant={getSeverityColor(selectedIncident.severity)}>{selectedIncident.severity}</Badge>\n                </p>\n              </div>\n              <div className=\"flex space-x-2\">\n                <Button size=\"sm\" variant=\"outline\" data-testid=\"button-download-snapshot\">\n                  <i className=\"fas fa-download mr-1\"></i>Download\n                </Button>\n                <Button \n                  size=\"sm\" \n                  variant=\"outline\" \n                  className=\"text-green-600 border-green-300\"\n                  onClick={() => {\n                    handleResolveIncident(selectedIncident, 'reviewed');\n                    setSnapshotModalOpen(false);\n                  }}\n                  data-testid=\"button-mark-reviewed\"\n                >\n                  <i className=\"fas fa-check mr-1\"></i>Mark Reviewed\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":24301},"client/src/pages/admin/monitoring.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link } from \"wouter\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\nimport WebcamMonitor from \"@/components/webcam-monitor\";\nimport type { ExamSession } from \"@shared/schema\";\n\ninterface StudentMonitoring {\n  id: string;\n  name: string;\n  rollNumber: string;\n  status: 'normal' | 'warning' | 'alert' | 'offline';\n  faceDetected: boolean;\n  multipleFaces: boolean;\n  lookingAway: boolean;\n  confidence: number;\n  progress: number;\n  timeRemaining: number;\n  lastActivity: string;\n  cameraStream?: MediaStream | null;\n  examSessionId?: string;\n  videoSnapshot?: string; // Base64 image data for live video feed\n}\n\nexport default function MonitoringSystem() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [filter, setFilter] = useState(\"all\");\n  const [currentPage, setCurrentPage] = useState(1);\n  const [studentsPerPage] = useState(12);\n  const [monitoringData, setMonitoringData] = useState<StudentMonitoring[]>([]);\n\n  // WebSocket connection for real-time monitoring\n  const { sendMessage, lastMessage } = useWebSocket();\n\n  // Fetch active sessions\n  const { data: activeSessions = [], isLoading } = useQuery<ExamSession[]>({\n    queryKey: [\"/api/active-sessions\"],\n    refetchInterval: 2000, // Refresh every 2 seconds\n  });\n\n  // Handle WebSocket messages for real-time updates\n  useEffect(() => {\n    if (lastMessage) {\n      try {\n        const message = JSON.parse(lastMessage.data);\n        \n        if (message.type === 'student_status') {\n          setMonitoringData(prev => {\n            const updated = [...prev];\n            const index = updated.findIndex(s => s.id === message.data.studentId);\n            if (index !== -1) {\n              updated[index] = { ...updated[index], ...message.data };\n            } else {\n              updated.push({\n                id: message.data.studentId,\n                name: message.data.studentName || 'Unknown Student',\n                rollNumber: message.data.rollNumber || 'N/A',\n                status: message.data.status || 'normal',\n                faceDetected: message.data.faceDetected || false,\n                multipleFaces: message.data.multipleFaces || false,\n                lookingAway: message.data.lookingAway || false,\n                confidence: message.data.confidence || 0,\n                progress: message.data.progress || 0,\n                timeRemaining: message.data.timeRemaining || 0,\n                lastActivity: new Date().toISOString()\n              });\n            }\n            return updated;\n          });\n        }\n\n        if (message.type === 'video_feed') {\n          setMonitoringData(prev => {\n            const updated = [...prev];\n            const index = updated.findIndex(s => s.id === message.data.studentId);\n            if (index !== -1) {\n              // Update existing student with video snapshot\n              updated[index] = { \n                ...updated[index], \n                lastActivity: new Date().toISOString(),\n                videoSnapshot: message.data.snapshot\n              };\n            } else {\n              // Add new student with video feed\n              updated.push({\n                id: message.data.studentId,\n                name: message.data.studentName || 'Unknown Student',\n                rollNumber: message.data.rollNumber || 'N/A',\n                status: 'normal',\n                faceDetected: true,\n                multipleFaces: false,\n                lookingAway: false,\n                confidence: 0.8,\n                progress: 0,\n                timeRemaining: 0,\n                lastActivity: new Date().toISOString(),\n                videoSnapshot: message.data.snapshot,\n                examSessionId: message.data.sessionId\n              });\n            }\n            return updated;\n          });\n        }\n      } catch (error) {\n        console.error('WebSocket message parse error:', error);\n      }\n    }\n  }, [lastMessage]);\n\n  // Connect to admin WebSocket on mount\n  useEffect(() => {\n    if (user) {\n      sendMessage({\n        type: 'auth',\n        userId: user.id,\n        userType: 'admin'\n      });\n    }\n  }, [user, sendMessage]);\n\n  // Convert active sessions to monitoring data with default values\n  useEffect(() => {\n    if (activeSessions.length > 0) {\n      const sessionData = activeSessions.map(session => ({\n        id: session.id,\n        name: session.studentId?.includes('student_') ? \n              session.studentId.replace('student_', '') : \n              `Student ${session.studentId?.slice(-4)}`,\n        rollNumber: session.studentId?.replace('student_', '') || 'Unknown',\n        status: 'normal' as const, // Default status, will be updated via WebSocket\n        faceDetected: false, // Default false, will be updated via WebSocket\n        multipleFaces: false,\n        lookingAway: false,\n        confidence: 0,\n        progress: (session.currentQuestion || 1),\n        timeRemaining: session.timeRemaining || 0,\n        lastActivity: new Date().toISOString(),\n        examSessionId: session.id\n      })) as StudentMonitoring[];\n      \n      setMonitoringData(sessionData);\n    }\n  }, [activeSessions]);\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'normal': return 'status-online';\n      case 'warning': return 'status-warning';\n      case 'alert': return 'status-danger';\n      default: return 'status-offline';\n    }\n  };\n\n  const getStatusBorder = (status: string) => {\n    switch (status) {\n      case 'alert': return 'border-red-400';\n      case 'warning': return 'border-yellow-400';\n      case 'normal': return 'border-green-400';\n      default: return 'border-gray-400';\n    }\n  };\n\n  const filteredStudents = monitoringData.filter(student => {\n    if (filter === \"all\") return true;\n    if (filter === \"alerts\") return student.status === \"alert\";\n    if (filter === \"warnings\") return student.status === \"warning\";\n    if (filter === \"normal\") return student.status === \"normal\";\n    if (filter === \"offline\") return student.status === \"offline\";\n    return true;\n  });\n\n  const totalPages = Math.ceil(filteredStudents.length / studentsPerPage);\n  const currentStudents = filteredStudents.slice(\n    (currentPage - 1) * studentsPerPage,\n    currentPage * studentsPerPage\n  );\n\n  const monitoringStats = {\n    activeStreams: monitoringData.length,\n    faceDetected: monitoringData.filter(s => s.faceDetected).length,\n    warnings: monitoringData.filter(s => s.status === 'warning').length,\n    criticalAlerts: monitoringData.filter(s => s.status === 'alert').length,\n    aiAccuracy: 98.7,\n    snapshots: Math.floor(monitoringData.length * 1.5)\n  };\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <p className=\"text-destructive\">Admin access required</p>\n            <Link href=\"/\">\n              <Button className=\"mt-4\" data-testid=\"button-home\">\n                Back to Home\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Monitoring Header */}\n      <div className=\"glass-header px-6 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-4\">\n            <i className=\"fas fa-tv text-primary text-2xl\"></i>\n            <div>\n              <h1 className=\"text-xl font-bold text-foreground\">Live Monitoring System</h1>\n              <p className=\"text-sm text-muted-foreground\">Real-time surveillance and AI analysis</p>\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-2 bg-green-100 px-3 py-1 rounded-full\">\n              <div className=\"status-indicator status-online pulse-green\"></div>\n              <span className=\"text-sm text-green-700\">All Systems Active</span>\n            </div>\n            <Link href=\"/admin/dashboard\">\n              <Button variant=\"outline\" data-testid=\"button-dashboard\">\n                <i className=\"fas fa-tachometer-alt mr-2\"></i>Dashboard\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"p-6\">\n        {/* Monitoring Controls */}\n        <Card className=\"shadow-sm mb-6\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Monitoring Controls</CardTitle>\n              <div className=\"flex items-center space-x-3\">\n                <Button className=\"bg-green-500 text-white hover:opacity-90\" data-testid=\"button-start-cameras\">\n                  <i className=\"fas fa-play mr-2\"></i>Start All Cameras\n                </Button>\n                <Button variant=\"destructive\" data-testid=\"button-stop-cameras\">\n                  <i className=\"fas fa-stop mr-2\"></i>Stop All\n                </Button>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4\">\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-foreground\" data-testid=\"stat-active-streams\">\n                    {monitoringStats.activeStreams}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Active Streams</div>\n                </div>\n              </div>\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-green-600\" data-testid=\"stat-face-detected\">\n                    {monitoringStats.faceDetected}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Face Detected</div>\n                </div>\n              </div>\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-600\" data-testid=\"stat-warnings\">\n                    {monitoringStats.warnings}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Warnings</div>\n                </div>\n              </div>\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-red-600\" data-testid=\"stat-critical-alerts\">\n                    {monitoringStats.criticalAlerts}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Critical Alerts</div>\n                </div>\n              </div>\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"stat-ai-accuracy\">\n                    {monitoringStats.aiAccuracy}%\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">AI Accuracy</div>\n                </div>\n              </div>\n              <div className=\"bg-muted rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-purple-600\" data-testid=\"stat-snapshots\">\n                    {monitoringStats.snapshots}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground\">Snapshots</div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Live Video Grid */}\n        <Card className=\"shadow-sm\">\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>Live Video Feeds</CardTitle>\n              <div className=\"flex items-center space-x-3\">\n                <Select value={filter} onValueChange={setFilter}>\n                  <SelectTrigger className=\"w-48\" data-testid=\"select-filter\">\n                    <SelectValue placeholder=\"Filter students\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Students</SelectItem>\n                    <SelectItem value=\"alerts\">Alert Status Only</SelectItem>\n                    <SelectItem value=\"warnings\">Warning Status Only</SelectItem>\n                    <SelectItem value=\"normal\">Normal Status Only</SelectItem>\n                    <SelectItem value=\"offline\">Offline Students</SelectItem>\n                  </SelectContent>\n                </Select>\n                <Button className=\"bg-primary text-primary-foreground\" data-testid=\"button-fullscreen\">\n                  <i className=\"fas fa-expand mr-2\"></i>Fullscreen Mode\n                </Button>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">\n                <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n                <p className=\"text-muted-foreground\">Loading video feeds...</p>\n              </div>\n            ) : currentStudents.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <i className=\"fas fa-video-slash text-muted-foreground text-4xl mb-4\"></i>\n                <p className=\"text-muted-foreground\">No active video feeds</p>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4\">\n                {currentStudents.map((student) => (\n                  <div key={student.id} className=\"relative group\" data-testid={`video-feed-${student.id}`}>\n                    <div className={`video-feed bg-gray-900 rounded-lg overflow-hidden border-2 ${getStatusBorder(student.status)}`} style={{ aspectRatio: '4/3' }}>\n                      {/* Live Video Feed Display */}\n                      <div className=\"w-full h-full relative bg-gradient-to-br from-gray-900 to-gray-800\">\n                        {student.videoSnapshot ? (\n                          // Display actual video snapshot from student\n                          <img \n                            src={student.videoSnapshot} \n                            alt={`Live feed for ${student.name}`}\n                            className=\"w-full h-full object-cover\"\n                            style={{ imageRendering: 'auto' }}\n                          />\n                        ) : (\n                          // Fallback to status visualization when no video feed\n                          <div className=\"absolute inset-0 flex items-center justify-center\">\n                            {student.faceDetected ? (\n                              <div className=\"text-center\">\n                                {/* Face Detection Visual */}\n                                <div className=\"relative mb-4\">\n                                  {student.multipleFaces ? (\n                                    <div className=\"w-16 h-16 border-2 border-red-400 rounded-full flex items-center justify-center animate-pulse\">\n                                      <i className=\"fas fa-users text-red-400 text-xl\"></i>\n                                    </div>\n                                  ) : student.lookingAway ? (\n                                    <div className=\"w-16 h-16 border-2 border-yellow-400 rounded-full flex items-center justify-center\">\n                                      <i className=\"fas fa-eye-slash text-yellow-400 text-xl\"></i>\n                                    </div>\n                                  ) : (\n                                    <div className=\"w-16 h-16 border-2 border-green-400 rounded-full flex items-center justify-center\">\n                                      <i className=\"fas fa-user text-green-400 text-xl\"></i>\n                                    </div>\n                                  )}\n                                  {/* Status indicator */}\n                                  <div className={`absolute -top-1 -right-1 w-4 h-4 rounded-full ${\n                                    student.status === 'alert' ? 'bg-red-500 animate-ping' :\n                                    student.status === 'warning' ? 'bg-yellow-500 animate-pulse' :\n                                    'bg-green-500'\n                                  }`}></div>\n                                </div>\n                                {/* Live indicator */}\n                                <div className=\"flex items-center justify-center space-x-1 text-green-400 text-xs\">\n                                  <div className=\"w-2 h-2 bg-green-400 rounded-full animate-pulse\"></div>\n                                  <span>STATUS ONLY</span>\n                                </div>\n                                <div className=\"text-xs text-gray-300 mt-1\">\n                                  Confidence: {Math.round(student.confidence * 100)}%\n                                </div>\n                              </div>\n                            ) : (\n                              <div className=\"text-center\">\n                                <div className=\"w-16 h-16 border-2 border-gray-500 rounded-full flex items-center justify-center mb-4\">\n                                  <i className=\"fas fa-video-slash text-gray-500 text-xl\"></i>\n                                </div>\n                                <div className=\"text-xs text-gray-400\">Camera Inactive</div>\n                              </div>\n                            )}\n                          </div>\n                        )}\n                        \n                        {/* Overlays */}\n                        <div className=\"absolute top-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs\">\n                          {student.name}\n                        </div>\n                        <div className={`absolute top-2 right-2 px-2 py-1 rounded text-xs text-white flex items-center space-x-1 ${\n                          student.status === 'alert' ? 'bg-red-500' :\n                          student.status === 'warning' ? 'bg-yellow-500' :\n                          student.status === 'normal' ? 'bg-green-500' :\n                          'bg-gray-500'\n                        }`}>\n                          <div className={`w-2 h-2 rounded-full ${\n                            student.status === 'alert' ? 'bg-white animate-ping' :\n                            student.status === 'warning' ? 'bg-white animate-pulse' :\n                            student.status === 'normal' ? 'bg-white' :\n                            'bg-gray-300'\n                          }`}></div>\n                          <span>{student.status.charAt(0).toUpperCase() + student.status.slice(1)}</span>\n                        </div>\n                        <div className=\"absolute bottom-2 left-2 bg-black/70 text-white px-2 py-1 rounded text-xs\">\n                          {student.rollNumber}\n                        </div>\n                        <div className=\"absolute bottom-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs\">\n                          {new Date(student.lastActivity).toLocaleTimeString()}\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {/* Hover overlay */}\n                    <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center\">\n                      <div className=\"flex space-x-2\">\n                        <button className=\"bg-primary text-white p-2 rounded-lg hover:opacity-80\" data-testid={`button-expand-${student.id}`}>\n                          <i className=\"fas fa-expand\"></i>\n                        </button>\n                        <button className=\"bg-yellow-500 text-white p-2 rounded-lg hover:opacity-80\" data-testid={`button-snapshot-${student.id}`}>\n                          <i className=\"fas fa-camera\"></i>\n                        </button>\n                        <button className=\"bg-red-500 text-white p-2 rounded-lg hover:opacity-80\" data-testid={`button-alert-${student.id}`}>\n                          <i className=\"fas fa-exclamation-triangle\"></i>\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {/* Pagination */}\n            {totalPages > 1 && (\n              <div className=\"flex items-center justify-between mt-6\">\n                <div className=\"text-sm text-muted-foreground\">\n                  Showing {(currentPage - 1) * studentsPerPage + 1}-{Math.min(currentPage * studentsPerPage, filteredStudents.length)} of {filteredStudents.length} students\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}\n                    disabled={currentPage === 1}\n                    data-testid=\"button-prev-page\"\n                  >\n                    <i className=\"fas fa-chevron-left\"></i>\n                  </Button>\n                  {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                    const pageNum = i + 1;\n                    return (\n                      <Button\n                        key={pageNum}\n                        variant={currentPage === pageNum ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(pageNum)}\n                        data-testid={`button-page-${pageNum}`}\n                      >\n                        {pageNum}\n                      </Button>\n                    );\n                  })}\n                  {totalPages > 5 && (\n                    <>\n                      <span className=\"text-muted-foreground\">...</span>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => setCurrentPage(totalPages)}\n                        data-testid={`button-page-${totalPages}`}\n                      >\n                        {totalPages}\n                      </Button>\n                    </>\n                  )}\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}\n                    disabled={currentPage === totalPages}\n                    data-testid=\"button-next-page\"\n                  >\n                    <i className=\"fas fa-chevron-right\"></i>\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":23466},"client/src/pages/admin/question-management.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Link } from \"wouter\";\nimport type { Question } from \"@shared/schema\";\n\nexport default function QuestionManagement() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const [formData, setFormData] = useState({\n    examName: \"\",\n    questionText: \"\",\n    questionType: \"multiple_choice\" as const,\n    options: [\"\", \"\", \"\", \"\"],\n    correctAnswer: \"\",\n    difficulty: \"medium\" as const,\n    subject: \"\",\n    topic: \"\",\n    marks: 1,\n  });\n  \n  const [selectedQuestion, setSelectedQuestion] = useState<Question | null>(null);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [showImportModal, setShowImportModal] = useState(false);\n  const [importFile, setImportFile] = useState<File | null>(null);\n  const [importPreview, setImportPreview] = useState<any[]>([]);\n\n  // Fetch existing questions\n  const { data: questions = [], isLoading } = useQuery<Question[]>({\n    queryKey: [\"/api/questions\"],\n  });\n\n  // Create question mutation\n  const createQuestionMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const response = await apiRequest(\"POST\", \"/api/questions\", data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Question created successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions\"] });\n      // Reset form\n      setFormData({\n        examName: \"\",\n        questionText: \"\",\n        questionType: \"multiple_choice\",\n        options: [\"\", \"\", \"\", \"\"],\n        correctAnswer: \"\",\n        difficulty: \"medium\",\n        subject: \"\",\n        topic: \"\",\n        marks: 1,\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Update question mutation\n  const updateQuestionMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: typeof formData }) => {\n      const response = await apiRequest(\"PUT\", `/api/questions/${id}`, data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Question updated successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions\"] });\n      setShowEditModal(false);\n      setSelectedQuestion(null);\n      setIsEditing(false);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Delete question mutation\n  const deleteQuestionMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/questions/${id}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Success\",\n        description: \"Question deleted successfully\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions\"] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Bulk import mutation\n  const bulkImportMutation = useMutation({\n    mutationFn: async (questions: any[]) => {\n      const results = await Promise.all(\n        questions.map(async (questionData) => {\n          const response = await apiRequest(\"POST\", \"/api/questions\", questionData);\n          return response.json();\n        })\n      );\n      return results;\n    },\n    onSuccess: (results) => {\n      toast({\n        title: \"Success\",\n        description: `${results.length} questions imported successfully`,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions\"] });\n      setShowImportModal(false);\n      setImportFile(null);\n      setImportPreview([]);\n    },\n    onError: (error) => {\n      toast({\n        title: \"Import Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (isEditing && selectedQuestion) {\n      updateQuestionMutation.mutate({ id: selectedQuestion.id, data: formData });\n    } else {\n      createQuestionMutation.mutate(formData);\n    }\n  };\n\n  const handleInputChange = (field: string, value: string | number) => {\n    setFormData(prev => ({ ...prev, [field]: value }));\n  };\n\n  const handleOptionChange = (index: number, value: string) => {\n    const newOptions = [...formData.options];\n    newOptions[index] = value;\n    setFormData(prev => ({ ...prev, options: newOptions }));\n  };\n\n  const handleEditQuestion = (question: Question) => {\n    setSelectedQuestion(question);\n    setFormData({\n      examName: question.examName,\n      questionText: question.questionText,\n      questionType: question.questionType as \"multiple_choice\",\n      options: question.options || [\"\", \"\", \"\", \"\"],\n      correctAnswer: question.correctAnswer,\n      difficulty: question.difficulty as \"medium\",\n      subject: question.subject,\n      topic: question.topic,\n      marks: question.marks,\n    });\n    setIsEditing(true);\n    setShowEditModal(true);\n  };\n\n  const handleDeleteQuestion = (questionId: string) => {\n    if (confirm(\"Are you sure you want to delete this question?\")) {\n      deleteQuestionMutation.mutate(questionId);\n    }\n  };\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    if (!file.name.endsWith('.csv')) {\n      toast({\n        title: \"Invalid File\",\n        description: \"Please upload a CSV file\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setImportFile(file);\n    parseCSVFile(file);\n  };\n\n  const parseCSVFile = (file: File) => {\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      const text = e.target?.result as string;\n      const lines = text.split('\\n');\n      const headers = lines[0].split(',').map(h => h.trim());\n      \n      // Expected headers: examName,questionText,optionA,optionB,optionC,optionD,correctAnswer,difficulty,subject,topic,marks\n      const expectedHeaders = ['examName', 'questionText', 'optionA', 'optionB', 'optionC', 'optionD', 'correctAnswer', 'difficulty', 'subject', 'topic', 'marks'];\n      \n      const missingHeaders = expectedHeaders.filter(h => !headers.includes(h));\n      if (missingHeaders.length > 0) {\n        toast({\n          title: \"Invalid CSV Format\",\n          description: `Missing columns: ${missingHeaders.join(', ')}`,\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      const questions = lines.slice(1)\n        .filter(line => line.trim())\n        .map((line, index) => {\n          const values = line.split(',').map(v => v.trim().replace(/^\"|\"$/g, ''));\n          const question: any = {};\n          \n          headers.forEach((header, i) => {\n            question[header] = values[i] || '';\n          });\n\n          // Format the data for the API\n          return {\n            examName: question.examName,\n            questionText: question.questionText,\n            options: [question.optionA, question.optionB, question.optionC, question.optionD],\n            correctAnswer: question.correctAnswer.toUpperCase(),\n            questionType: \"multiple_choice\",\n            difficulty: question.difficulty || \"medium\",\n            subject: question.subject,\n            topic: question.topic,\n            marks: parseInt(question.marks) || 1,\n          };\n        });\n\n      setImportPreview(questions);\n    };\n    reader.readAsText(file);\n  };\n\n  const handleImportQuestions = () => {\n    if (importPreview.length === 0) {\n      toast({\n        title: \"No Questions\",\n        description: \"Please upload a valid CSV file with questions\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    bulkImportMutation.mutate(importPreview);\n  };\n\n  if (user?.role !== 'admin') {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <Card className=\"max-w-md w-full shadow-2xl\">\n          <CardContent className=\"pt-6 text-center\">\n            <i className=\"fas fa-lock text-4xl text-red-500 mb-4\"></i>\n            <h3 className=\"text-xl font-semibold mb-2\">Access Denied</h3>\n            <p className=\"text-muted-foreground mb-4\">Admin access required</p>\n            <Link href=\"/\"><Button>Return Home</Button></Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-primary\">\n      <div className=\"container mx-auto py-8 px-4\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-white\">Question Management</h1>\n            <p className=\"text-white/80\">Create and manage exam questions</p>\n          </div>\n          <div className=\"flex items-center space-x-4\">\n            <Link href=\"/admin/dashboard\">\n              <Button variant=\"secondary\" data-testid=\"button-back-dashboard\">\n                <i className=\"fas fa-arrow-left mr-2\"></i>Dashboard\n              </Button>\n            </Link>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Question Form */}\n          <div className=\"lg:col-span-1\">\n            <Card className=\"shadow-xl\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-2xl\">\n                    {isEditing ? \"Edit Question\" : \"Add New Question\"}\n                  </CardTitle>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  {/* Exam Name */}\n                  <div>\n                    <Label htmlFor=\"examName\">Exam Name</Label>\n                    <Input\n                      id=\"examName\"\n                      placeholder=\"Mathematics Final Exam 2024\"\n                      value={formData.examName}\n                      onChange={(e) => handleInputChange(\"examName\", e.target.value)}\n                      required\n                      data-testid=\"input-exam-name\"\n                    />\n                  </div>\n\n                  {/* Subject and Topic */}\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label htmlFor=\"subject\">Subject</Label>\n                      <Input\n                        id=\"subject\"\n                        placeholder=\"Mathematics\"\n                        value={formData.subject}\n                        onChange={(e) => handleInputChange(\"subject\", e.target.value)}\n                        required\n                        data-testid=\"input-subject\"\n                      />\n                    </div>\n                    <div>\n                      <Label htmlFor=\"topic\">Topic</Label>\n                      <Input\n                        id=\"topic\"\n                        placeholder=\"Algebra\"\n                        value={formData.topic}\n                        onChange={(e) => handleInputChange(\"topic\", e.target.value)}\n                        required\n                        data-testid=\"input-topic\"\n                      />\n                    </div>\n                  </div>\n\n                  {/* Question Text */}\n                  <div>\n                    <Label htmlFor=\"questionText\">Question</Label>\n                    <Textarea\n                      id=\"questionText\"\n                      placeholder=\"Enter your question here...\"\n                      value={formData.questionText}\n                      onChange={(e) => handleInputChange(\"questionText\", e.target.value)}\n                      required\n                      className=\"min-h-[100px]\"\n                      data-testid=\"textarea-question\"\n                    />\n                  </div>\n\n                  {/* Question Type */}\n                  <div>\n                    <Label htmlFor=\"questionType\">Question Type</Label>\n                    <Select value={formData.questionType} onValueChange={(value) => handleInputChange(\"questionType\", value)}>\n                      <SelectTrigger data-testid=\"select-question-type\">\n                        <SelectValue placeholder=\"Select type\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"multiple_choice\">Multiple Choice</SelectItem>\n                        <SelectItem value=\"true_false\">True/False</SelectItem>\n                        <SelectItem value=\"short_answer\">Short Answer</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/* Options (for multiple choice) */}\n                  {formData.questionType === \"multiple_choice\" && (\n                    <div>\n                      <Label>Answer Options</Label>\n                      <div className=\"space-y-2\">\n                        {formData.options.map((option, index) => (\n                          <div key={index} className=\"flex items-center space-x-2\">\n                            <span className=\"text-sm font-medium\">{String.fromCharCode(65 + index)}.</span>\n                            <Input\n                              placeholder={`Option ${String.fromCharCode(65 + index)}`}\n                              value={option}\n                              onChange={(e) => handleOptionChange(index, e.target.value)}\n                              required\n                              data-testid={`input-option-${index}`}\n                            />\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Correct Answer */}\n                  <div>\n                    <Label htmlFor=\"correctAnswer\">Correct Answer</Label>\n                    {formData.questionType === \"multiple_choice\" ? (\n                      <Select value={formData.correctAnswer} onValueChange={(value) => handleInputChange(\"correctAnswer\", value)}>\n                        <SelectTrigger data-testid=\"select-correct-answer\">\n                          <SelectValue placeholder=\"Select correct option\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {formData.options.map((_, index) => (\n                            <SelectItem key={index} value={String.fromCharCode(65 + index)}>\n                              Option {String.fromCharCode(65 + index)}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    ) : (\n                      <Input\n                        id=\"correctAnswer\"\n                        placeholder=\"Enter correct answer\"\n                        value={formData.correctAnswer}\n                        onChange={(e) => handleInputChange(\"correctAnswer\", e.target.value)}\n                        required\n                        data-testid=\"input-correct-answer\"\n                      />\n                    )}\n                  </div>\n\n                  {/* Difficulty and Marks */}\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label htmlFor=\"difficulty\">Difficulty</Label>\n                      <Select value={formData.difficulty} onValueChange={(value) => handleInputChange(\"difficulty\", value)}>\n                        <SelectTrigger data-testid=\"select-difficulty\">\n                          <SelectValue placeholder=\"Select difficulty\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"easy\">Easy</SelectItem>\n                          <SelectItem value=\"medium\">Medium</SelectItem>\n                          <SelectItem value=\"hard\">Hard</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label htmlFor=\"marks\">Marks</Label>\n                      <Input\n                        id=\"marks\"\n                        type=\"number\"\n                        min=\"1\"\n                        max=\"10\"\n                        value={formData.marks}\n                        onChange={(e) => handleInputChange(\"marks\", parseInt(e.target.value))}\n                        required\n                        data-testid=\"input-marks\"\n                      />\n                    </div>\n                  </div>\n\n                  {/* Submit Button */}\n                  <div className=\"flex justify-end space-x-4\">\n                    {isEditing && (\n                      <Button \n                        type=\"button\" \n                        variant=\"outline\" \n                        onClick={() => {\n                          setIsEditing(false);\n                          setSelectedQuestion(null);\n                          setShowEditModal(false);\n                          setFormData({\n                            questionText: \"\",\n                            questionType: \"multiple_choice\",\n                            options: [\"\", \"\", \"\", \"\"],\n                            correctAnswer: \"\",\n                            difficulty: \"medium\",\n                            subject: \"\",\n                            topic: \"\",\n                            marks: 1,\n                          });\n                        }}\n                        data-testid=\"button-cancel-edit\"\n                      >\n                        Cancel\n                      </Button>\n                    )}\n                    <Button \n                      type=\"submit\" \n                      disabled={createQuestionMutation.isPending || updateQuestionMutation.isPending}\n                      data-testid=\"button-submit-question\"\n                    >\n                      {createQuestionMutation.isPending || updateQuestionMutation.isPending ? (\n                        <>\n                          <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\"></div>\n                          {isEditing ? \"Updating...\" : \"Creating...\"}\n                        </>\n                      ) : (\n                        <>\n                          <i className={`fas ${isEditing ? \"fa-save\" : \"fa-plus\"} mr-2`}></i>\n                          {isEditing ? \"Update Question\" : \"Add Question\"}\n                        </>\n                      )}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Questions List */}\n          <div className=\"lg:col-span-2\">\n            <Card className=\"shadow-xl\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle>Exam Questions ({questions.length})</CardTitle>\n                  <Button \n                    variant=\"outline\" \n                    onClick={() => setShowImportModal(true)}\n                    data-testid=\"button-bulk-import\"\n                  >\n                    <i className=\"fas fa-upload mr-2\"></i>Bulk Import\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                {isLoading ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n                    <p className=\"text-muted-foreground\">Loading questions...</p>\n                  </div>\n                ) : questions.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <i className=\"fas fa-question-circle text-4xl text-muted-foreground mb-4\"></i>\n                    <p className=\"text-muted-foreground\">No questions created yet</p>\n                    <p className=\"text-sm text-muted-foreground\">Add your first question using the form</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {questions.map((question: Question) => (\n                      <div key={question.id} className=\"border rounded-lg p-4 bg-muted/50\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center space-x-2 mb-2\">\n                              <span className=\"text-xs bg-primary/10 text-primary px-2 py-1 rounded-full\">\n                                {question.subject}\n                              </span>\n                              <span className=\"text-xs bg-secondary text-secondary-foreground px-2 py-1 rounded-full\">\n                                {question.difficulty}\n                              </span>\n                              <span className=\"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full\">\n                                {question.marks} marks\n                              </span>\n                            </div>\n                            <h4 className=\"font-medium text-sm mb-2\">{question.questionText}</h4>\n                            {question.questionType === \"multiple_choice\" && question.options && (\n                              <div className=\"text-xs text-muted-foreground space-y-1\">\n                                {question.options.map((option, index) => (\n                                  <div key={index} className={`${String.fromCharCode(65 + index) === question.correctAnswer ? 'text-green-600 font-medium' : ''}`}>\n                                    {String.fromCharCode(65 + index)}. {option}\n                                  </div>\n                                ))}\n                              </div>\n                            )}\n                          </div>\n                          <div className=\"flex items-center space-x-2 ml-4\">\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handleEditQuestion(question)} data-testid={`button-edit-${question.id}`}>\n                              <i className=\"fas fa-edit\"></i>\n                            </Button>\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => handleDeleteQuestion(question.id)} data-testid={`button-delete-${question.id}`}>\n                              <i className=\"fas fa-trash\"></i>\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n\n      {/* Bulk Import Modal */}\n      <Dialog open={showImportModal} onOpenChange={setShowImportModal}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Bulk Import Questions</DialogTitle>\n          </DialogHeader>\n          \n          <div className=\"space-y-6\">\n            {/* Instructions */}\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium text-blue-900 mb-2\">CSV Format Instructions</h4>\n              <p className=\"text-sm text-blue-800 mb-2\">\n                Your CSV file should include these columns (in any order):\n              </p>\n              <code className=\"text-xs bg-white p-2 rounded block\">\n                examName,questionText,optionA,optionB,optionC,optionD,correctAnswer,difficulty,subject,topic,marks\n              </code>\n              <div className=\"mt-2 text-xs text-blue-700\">\n                <strong>correctAnswer:</strong> Use A, B, C, or D<br/>\n                <strong>difficulty:</strong> Use easy, medium, or hard<br/>\n                <strong>marks:</strong> Use numbers (1, 2, 3, etc.)\n              </div>\n            </div>\n\n            {/* File Upload */}\n            <div>\n              <label className=\"block text-sm font-medium mb-2\">\n                Select CSV File\n              </label>\n              <input\n                type=\"file\"\n                accept=\".csv\"\n                onChange={handleFileUpload}\n                className=\"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/90\"\n                data-testid=\"input-csv-file\"\n              />\n            </div>\n\n            {/* Preview */}\n            {importPreview.length > 0 && (\n              <div>\n                <h4 className=\"font-medium mb-2\">Preview ({importPreview.length} questions)</h4>\n                <div className=\"border rounded-lg max-h-60 overflow-y-auto\">\n                  <table className=\"w-full text-xs\">\n                    <thead className=\"bg-gray-50 sticky top-0\">\n                      <tr>\n                        <th className=\"p-2 text-left\">Exam</th>\n                        <th className=\"p-2 text-left\">Question</th>\n                        <th className=\"p-2 text-left\">Options</th>\n                        <th className=\"p-2 text-left\">Answer</th>\n                        <th className=\"p-2 text-left\">Subject</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {importPreview.slice(0, 10).map((q, index) => (\n                        <tr key={index} className=\"border-t\">\n                          <td className=\"p-2\">{q.examName}</td>\n                          <td className=\"p-2 max-w-xs truncate\">{q.questionText}</td>\n                          <td className=\"p-2\">\n                            {q.options.map((opt: string, i: number) => (\n                              <span key={i} className=\"text-xs\">\n                                {String.fromCharCode(65 + i)}:{opt.substring(0, 10)}...{i < 3 && ' '}\n                              </span>\n                            ))}\n                          </td>\n                          <td className=\"p-2\">{q.correctAnswer}</td>\n                          <td className=\"p-2\">{q.subject}</td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                  {importPreview.length > 10 && (\n                    <div className=\"p-2 text-center text-gray-500 text-xs\">\n                      ...and {importPreview.length - 10} more questions\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex justify-end space-x-4\">\n              <Button \n                variant=\"outline\" \n                onClick={() => {\n                  setShowImportModal(false);\n                  setImportFile(null);\n                  setImportPreview([]);\n                }}\n                data-testid=\"button-cancel-import\"\n              >\n                Cancel\n              </Button>\n              <Button \n                onClick={handleImportQuestions}\n                disabled={importPreview.length === 0 || bulkImportMutation.isPending}\n                data-testid=\"button-confirm-import\"\n              >\n                {bulkImportMutation.isPending ? (\n                  <>\n                    <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\"></div>\n                    Importing...\n                  </>\n                ) : (\n                  <>\n                    <i className=\"fas fa-check mr-2\"></i>\n                    Import {importPreview.length} Questions\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":28781},"client/src/pages/admin/results.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Download, Award, Clock, CheckCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { generateExamReport } from \"@/lib/exam-utils\";\nimport type { ExamSession, Question } from \"@shared/schema\";\n\nexport default function Results() {\n  const { user } = useAuth();\n\n  // Fetch completed exam sessions\n  const { data: sessions = [], isLoading: sessionsLoading } = useQuery<ExamSession[]>({\n    queryKey: [\"/api/exam-sessions\"],\n  });\n\n  // Fetch all questions\n  const { data: questions = [], isLoading: questionsLoading } = useQuery<Question[]>({\n    queryKey: [\"/api/questions\"],\n  });\n\n  if (!user || user.role !== \"admin\") {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 flex items-center justify-center\">\n        <Card className=\"w-full max-w-md mx-4\">\n          <CardContent className=\"pt-6 text-center\">\n            <p className=\"text-gray-600 dark:text-gray-300\">Access denied. Admin privileges required.</p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const completedSessions = sessions.filter((session: any) => session.status === \"completed\");\n\n  const getResultsForSession = (session: any) => {\n    // Filter questions based on hall ticket data or use all questions\n    const sessionQuestions = questions.length > 0 ? questions : [];\n    \n    // Bypass strict typing for now - focus on functionality\n    return generateExamReport(session as any, sessionQuestions);\n  };\n\n  const exportResults = () => {\n    const csvContent = [\n      [\"Student ID\", \"Exam Name\", \"Score\", \"Correct Answers\", \"Total Questions\", \"Time Spent (minutes)\", \"Status\"].join(\",\"),\n      ...completedSessions.map((session: any) => {\n        const results = getResultsForSession(session);\n        return [\n          `${session.studentName || ''} ${session.studentLastName || ''}`.trim() || session.studentId,\n          \"Exam\", // Default exam name since examName doesn't exist in schema\n          `${results.score}%`,\n          results.correctAnswers,\n          results.totalQuestions,\n          Math.round(results.timeSpent / 60000),\n          session.status\n        ].join(\",\");\n      })\n    ].join(\"\\n\");\n\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `exam-results-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  if (sessionsLoading || questionsLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 dark:text-gray-300\">Loading results...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const averageScore = completedSessions.length > 0 \n    ? Math.round(completedSessions.reduce((sum: number, session: any) => {\n        const results = getResultsForSession(session);\n        return sum + results.score;\n      }, 0) / completedSessions.length)\n    : 0;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 p-4\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">Exam Results</h1>\n            <p className=\"text-gray-600 dark:text-gray-300 mt-2\">View and analyze student exam performance</p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Link href=\"/admin/dashboard\">\n              <Button variant=\"outline\" data-testid=\"button-dashboard\">\n                Dashboard\n              </Button>\n            </Link>\n            {completedSessions.length > 0 && (\n              <Button onClick={exportResults} data-testid=\"button-export-results\">\n                <Download className=\"w-4 h-4 mr-2\" />\n                Export CSV\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Summary Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Completed Exams</CardTitle>\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-completed-count\">\n                {completedSessions.length}\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Average Score</CardTitle>\n              <Award className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"text-average-score\">\n                {averageScore}%\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Students</CardTitle>\n              <Clock className=\"h-4 w-4 text-purple-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-purple-600\" data-testid=\"text-total-students\">\n                {new Set(completedSessions.map((s: any) => s.studentId)).size}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Results List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Student Results</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {completedSessions.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <p className=\"text-gray-600 dark:text-gray-300\">No completed exams yet.</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {completedSessions.map((session: any) => {\n                  const results = getResultsForSession(session);\n                  const getScoreColor = (score: number) => {\n                    if (score >= 80) return \"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100\";\n                    if (score >= 60) return \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100\";\n                    return \"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100\";\n                  };\n\n                  return (\n                    <div key={session.id} className=\"border rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800\">\n                      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-4 mb-2\">\n                            <h3 className=\"font-semibold text-gray-900 dark:text-white\" data-testid={`text-student-${session.studentId}`}>\n                              Student: {session.studentName} {session.studentLastName || ''} \n                              {!session.studentName && `ID: ${session.studentId}`}\n                            </h3>\n                            <Badge variant=\"outline\">\n                              Exam Session\n                            </Badge>\n                          </div>\n                          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-300\">\n                            <div>\n                              <span className=\"font-medium\">Score:</span>\n                              <Badge className={getScoreColor(results.score)} data-testid={`text-score-${session.studentId}`}>\n                                {results.score}%\n                              </Badge>\n                            </div>\n                            <div>\n                              <span className=\"font-medium\">Correct:</span>\n                              <span className=\"ml-1\">{results.correctAnswers}/{results.totalQuestions}</span>\n                            </div>\n                            <div>\n                              <span className=\"font-medium\">Time:</span>\n                              <span className=\"ml-1\">{Math.round(results.timeSpent / 60000)}m</span>\n                            </div>\n                            <div>\n                              <span className=\"font-medium\">Completed:</span>\n                              <span className=\"ml-1\">{session.endTime ? new Date(session.endTime).toLocaleDateString() : \"N/A\"}</span>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":9779},"client/src/pages/student/authentication.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport QRScanner from \"@/components/qr-scanner\";\nimport { useLocation } from \"wouter\";\n\nexport default function StudentAuthentication() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [scanMode, setScanMode] = useState(true);\n  const [manualData, setManualData] = useState({\n    hallTicketId: \"\",\n    rollNumber: \"\",\n  });\n\n  // Verify hall ticket mutation\n  const verifyHallTicketMutation = useMutation({\n    mutationFn: async (data: { qrData?: string; rollNumber: string; hallTicketId?: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/verify-hall-ticket\", data);\n      return response.json();\n    },\n    onSuccess: (result) => {\n      toast({\n        title: \"Success\",\n        description: \"Hall ticket verified successfully\",\n      });\n      // Store hall ticket data and navigate to verification\n      localStorage.setItem(\"hallTicketData\", JSON.stringify(result.hallTicket));\n      setLocation(\"/student/identity-verification\");\n    },\n    onError: (error) => {\n      toast({\n        title: \"Verification Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleQRScan = (qrData: string) => {\n    try {\n      const parsed = JSON.parse(qrData);\n      verifyHallTicketMutation.mutate({\n        qrData,\n        rollNumber: parsed.rollNumber,\n      });\n    } catch (error) {\n      toast({\n        title: \"Invalid QR Code\",\n        description: \"Please scan a valid hall ticket QR code\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleManualSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!manualData.hallTicketId || !manualData.rollNumber) {\n      toast({\n        title: \"Missing Information\",\n        description: \"Please fill in all required fields\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // For manual entry, send hall ticket ID and roll number directly\n    verifyHallTicketMutation.mutate({\n      rollNumber: manualData.rollNumber,\n      hallTicketId: manualData.hallTicketId,\n    });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-primary flex items-center justify-center p-4\">\n      <Card className=\"max-w-md w-full shadow-2xl\">\n        <CardHeader className=\"text-center\">\n          <div className=\"w-20 h-20 bg-gradient-primary rounded-full flex items-center justify-center mx-auto mb-4\">\n            <i className=\"fas fa-user-graduate text-2xl text-white\"></i>\n          </div>\n          <CardTitle className=\"text-2xl\">Student Authentication</CardTitle>\n          <p className=\"text-muted-foreground\">\n            {scanMode ? \"Scan your hall ticket QR code to proceed\" : \"Enter your hall ticket details manually\"}\n          </p>\n        </CardHeader>\n\n        <CardContent className=\"space-y-6\">\n          {/* Mode Toggle */}\n          <div className=\"flex bg-muted rounded-lg p-1\">\n            <button\n              className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${\n                scanMode ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'\n              }`}\n              onClick={() => setScanMode(true)}\n              data-testid=\"button-scan-mode\"\n            >\n              <i className=\"fas fa-qrcode mr-2\"></i>QR Scan\n            </button>\n            <button\n              className={`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${\n                !scanMode ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'\n              }`}\n              onClick={() => setScanMode(false)}\n              data-testid=\"button-manual-mode\"\n            >\n              <i className=\"fas fa-keyboard mr-2\"></i>Manual Entry\n            </button>\n          </div>\n\n          {scanMode ? (\n            /* QR Scanner Section */\n            <div className=\"space-y-4\">\n              <QRScanner onScan={handleQRScan} />\n              \n              <div className=\"text-center\">\n                <p className=\"text-sm text-muted-foreground mb-4\">\n                  Click \"Start QR Scanner\" below, then hold your hall ticket QR code in front of the camera\n                </p>\n              </div>\n            </div>\n          ) : (\n            /* Manual Entry Form */\n            <form onSubmit={handleManualSubmit} className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"hallTicketId\">Hall Ticket ID</Label>\n                <Input\n                  id=\"hallTicketId\"\n                  placeholder=\"HT2024CS001234\"\n                  value={manualData.hallTicketId}\n                  onChange={(e) => setManualData(prev => ({ ...prev, hallTicketId: e.target.value.toUpperCase() }))}\n                  required\n                  data-testid=\"input-hall-ticket-id\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"rollNumber\">Roll Number</Label>\n                <Input\n                  id=\"rollNumber\"\n                  placeholder=\"CS21B1234\"\n                  value={manualData.rollNumber}\n                  onChange={(e) => setManualData(prev => ({ ...prev, rollNumber: e.target.value.toUpperCase() }))}\n                  required\n                  data-testid=\"input-roll-number\"\n                />\n              </div>\n              \n              <Button \n                type=\"submit\" \n                className=\"w-full\"\n                disabled={verifyHallTicketMutation.isPending}\n                data-testid=\"button-verify\"\n              >\n                {verifyHallTicketMutation.isPending ? (\n                  <>\n                    <div className=\"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2\"></div>\n                    Verifying...\n                  </>\n                ) : (\n                  <>\n                    <i className=\"fas fa-sign-in-alt mr-2\"></i>Proceed to Verification\n                  </>\n                )}\n              </Button>\n            </form>\n          )}\n\n          {/* Status Display */}\n          <div className=\"p-4 bg-muted rounded-lg\">\n            <div className=\"flex items-center space-x-3\">\n              <div className={`status-indicator ${\n                verifyHallTicketMutation.isPending ? 'status-warning' : 'status-offline'\n              }`}></div>\n              <span className=\"text-sm text-muted-foreground\">\n                {verifyHallTicketMutation.isPending \n                  ? 'Verifying hall ticket...' \n                  : 'Waiting for hall ticket scan...'\n                }\n              </span>\n            </div>\n          </div>\n\n          {/* Help Text */}\n          <div className=\"text-center\">\n            <p className=\"text-xs text-muted-foreground\">\n              Need help? Contact your exam coordinator or IT support\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":7274},"client/src/pages/student/exam-complete.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useLocation } from \"wouter\";\nimport { useEffect } from \"react\";\n\nexport default function ExamComplete() {\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    // Clean up any remaining fullscreen or exam state\n    if (document.fullscreenElement) {\n      document.exitFullscreen().catch(console.error);\n    }\n  }, []);\n\n  const handleGoHome = () => {\n    // Clean up any remaining exam data\n    localStorage.removeItem(\"hallTicketData\");\n    localStorage.removeItem(\"verificationComplete\");\n    setLocation(\"/\");\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-indigo-950 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-2xl shadow-2xl\">\n        <CardHeader className=\"text-center pb-2\">\n          <div className=\"mx-auto w-20 h-20 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mb-4\">\n            <i className=\"fas fa-check-circle text-4xl text-green-600 dark:text-green-400\"></i>\n          </div>\n          <CardTitle className=\"text-3xl font-bold text-green-700 dark:text-green-400\">\n            Exam Submitted Successfully!\n          </CardTitle>\n        </CardHeader>\n        \n        <CardContent className=\"text-center space-y-6\">\n          <div className=\"space-y-3\">\n            <p className=\"text-xl text-muted-foreground\">\n              Thank you for your patience during the examination.\n            </p>\n            <p className=\"text-muted-foreground\">\n              Your answers have been securely submitted and recorded. \n              You will be notified of your results once they are available.\n            </p>\n          </div>\n\n          <div className=\"bg-muted/50 rounded-lg p-4 space-y-2\">\n            <h3 className=\"font-semibold text-lg\">What happens next?</h3>\n            <ul className=\"text-sm text-muted-foreground space-y-1\">\n              <li>• Your exam responses are being processed</li>\n              <li>• Results will be available within 24-48 hours</li>\n              <li>• You will receive notification via email</li>\n              <li>• Contact support if you have any concerns</li>\n            </ul>\n          </div>\n\n          <div className=\"pt-4\">\n            <Button \n              onClick={handleGoHome}\n              size=\"lg\"\n              className=\"w-full\"\n              data-testid=\"button-home\"\n            >\n              <i className=\"fas fa-home mr-2\"></i>\n              Return to Home\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":2723},"client/src/pages/student/exam.tsx":{"content":"import { useState, useEffect, useCallback } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useLocation } from \"wouter\";\nimport WebcamMonitor from \"@/components/webcam-monitor\";\nimport FaceDetection from \"@/components/face-detection\";\nimport { useWebcam } from \"@/hooks/useWebcam\";\nimport { useFaceDetection } from \"@/hooks/useFaceDetection\";\nimport { useWebSocket } from \"@/hooks/useWebSocket\";\n\ninterface HallTicketData {\n  id: string;\n  hallTicketId: string;\n  examName: string;\n  studentName: string;\n  rollNumber: string;\n  examDate: string;\n  duration: number;\n}\n\ninterface Question {\n  id: string;\n  questionText: string;\n  options: string[];\n  questionType: string;\n  marks: number;\n}\n\nexport default function ExamMode() {\n  const { user } = useAuth();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [hallTicketData, setHallTicketData] = useState<HallTicketData | null>(null);\n  const [examSession, setExamSession] = useState<any>(null);\n  const [currentQuestion, setCurrentQuestion] = useState(1);\n  const [answers, setAnswers] = useState<Record<number, string>>({});\n  const [timeRemaining, setTimeRemaining] = useState(0);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [showWarning, setShowWarning] = useState(false);\n  const [warningCount, setWarningCount] = useState(0);\n  const [violationCount, setViolationCount] = useState(0);\n  const [isPaused, setIsPaused] = useState(false);\n  const [warningMessage, setWarningMessage] = useState(\"\");\n  \n  const { isActive: cameraActive, startCamera, stopCamera, stream, error: cameraError, capturePhoto } = useWebcam();\n  const { faceDetected, multipleFaces, lookingAway, confidence } = useFaceDetection(stream);\n  const { sendMessage } = useWebSocket();\n\n  // Fetch questions for the current exam session (load immediately when session is set)\n  const { \n    data: questions, \n    isLoading: questionsLoading, \n    error: questionsError \n  } = useQuery<Question[]>({\n    queryKey: ['/api/exam-sessions', examSession?.id, 'questions'],\n    enabled: !!examSession?.id,\n    staleTime: 300000, // Cache for 5 minutes\n    gcTime: 600000, // Keep in cache for 10 minutes\n    retry: 2, // Retry failed requests twice\n  });\n\n  // Handle questions loading errors and empty states\n  useEffect(() => {\n    if (questionsError) {\n      console.error(\"Questions loading error:\", questionsError);\n      toast({\n        title: \"Questions Loading Failed\",\n        description: \"Failed to load exam questions. Please try refreshing the page.\",\n        variant: \"destructive\",\n      });\n    } else if (questions && questions.length === 0 && !questionsLoading) {\n      // Questions loaded successfully but empty - show error state\n      toast({\n        title: \"No Questions Available\",\n        description: \"This exam has no questions assigned. Please contact your administrator.\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        setLocation(\"/student/auth\");\n      }, 3000);\n    }\n  }, [questionsError, questions, questionsLoading, toast, setLocation]);\n\n  // Initialize exam session\n  const createSessionMutation = useMutation({\n    mutationFn: async (hallTicketId: string) => {\n      const response = await apiRequest(\"POST\", \"/api/exam-sessions\", {\n        hallTicketId,\n        status: \"in_progress\",\n        startTime: new Date().toISOString(),\n        currentQuestion: 1,\n        answers: {},\n        timeRemaining: hallTicketData?.duration ? hallTicketData.duration * 60 : 10800, // Convert minutes to seconds\n      });\n      return response.json();\n    },\n    onSuccess: (session) => {\n      setExamSession(session);\n      // Don't start timer yet - wait for questions to load\n      setTimeRemaining(session.timeRemaining);\n      enterFullscreen();\n    },\n    onError: (error: any) => {\n      console.error(\"Session creation error:\", error);\n      \n      // Handle specific error cases\n      if (error.message?.includes(\"No questions found\")) {\n        toast({\n          title: \"Exam Not Available\",\n          description: \"This exam has no questions configured. Please contact your administrator.\",\n          variant: \"destructive\",\n        });\n      } else {\n        toast({\n          title: \"Session Error\", \n          description: error.message || \"Failed to initialize exam session\",\n          variant: \"destructive\",\n        });\n      }\n      \n      // Redirect back to auth page after error\n      setTimeout(() => {\n        setLocation(\"/student/auth\");\n      }, 3000);\n    },\n  });\n\n  // Enter fullscreen mode\n  const enterFullscreen = async () => {\n    try {\n      await document.documentElement.requestFullscreen();\n      setIsFullscreen(true);\n    } catch (error) {\n      console.error(\"Fullscreen error:\", error);\n    }\n  };\n\n  // Exit fullscreen mode\n  const exitFullscreen = async () => {\n    try {\n      await document.exitFullscreen();\n      setIsFullscreen(false);\n    } catch (error) {\n      console.error(\"Exit fullscreen error:\", error);\n    }\n  };\n\n  // Enhanced security violation handler\n  const handleSecurityViolation = async (violationType: string, description: string, severity: \"low\" | \"medium\" | \"high\" | \"critical\" = \"medium\") => {\n    if (!examSession) return;\n\n    const newViolationCount = violationCount + 1;\n    setViolationCount(newViolationCount);\n    setWarningCount(prev => prev + 1);\n    \n    // Set warning message based on violation type\n    let warning = \"\";\n    if (violationType === \"fullscreen_exit\") {\n      warning = \"⚠️ Please stay in fullscreen mode during the exam!\";\n    } else if (violationType === \"tab_switch\") {\n      warning = \"⚠️ Switching tabs is not allowed during the exam!\";\n    } else if (violationType === \"window_blur\") {\n      warning = \"⚠️ Please keep the exam window focused!\";\n    } else if (violationType === \"key_violation\") {\n      warning = \"⚠️ Restricted key combination detected!\";\n    }\n    \n    setWarningMessage(warning);\n    setShowWarning(true);\n\n    // Auto-hide warning after 5 seconds\n    setTimeout(() => {\n      setShowWarning(false);\n      setWarningMessage(\"\");\n    }, 5000);\n\n    // Send violation event to server via WebSocket\n    sendMessage({\n      type: 'security_violation',\n      data: {\n        sessionId: examSession.id,\n        studentId: user?.id,\n        studentName: hallTicketData?.studentName,\n        rollNumber: hallTicketData?.rollNumber,\n        incidentType: violationType,\n        severity: severity,\n        description: description,\n        metadata: { \n          violationCount: newViolationCount,\n          warningCount: warningCount + 1,\n          timestamp: new Date().toISOString()\n        }\n      }\n    });\n\n    // Implement violation policy\n    if (newViolationCount === 1) {\n      // First violation: Auto-pause exam\n      setIsPaused(true);\n      toast({\n        title: \"Exam Paused\",\n        description: \"Your exam has been paused due to a security violation. Click 'Resume' to continue.\",\n        variant: \"destructive\",\n      });\n      \n      // Send policy update to admin (separate from incident creation)\n      sendMessage({\n        type: 'policy_update',\n        data: {\n          sessionId: examSession.id,\n          studentId: user?.id,\n          studentName: hallTicketData?.studentName,\n          rollNumber: hallTicketData?.rollNumber,\n          action: 'paused',\n          violationType,\n          violationCount: newViolationCount,\n          timestamp: new Date().toISOString()\n        }\n      });\n      \n    } else if (newViolationCount >= 3) {\n      // Three or more violations: Auto-submit exam\n      toast({\n        title: \"Exam Auto-Submitted\",\n        description: \"Your exam has been automatically submitted due to multiple security violations.\",\n        variant: \"destructive\",\n      });\n      \n      // Send policy update to admin (separate from incident creation)\n      sendMessage({\n        type: 'policy_update',\n        data: {\n          sessionId: examSession.id,\n          studentId: user?.id,\n          studentName: hallTicketData?.studentName,\n          rollNumber: hallTicketData?.rollNumber,\n          action: 'auto_submitted',\n          violationType,\n          violationCount: newViolationCount,\n          timestamp: new Date().toISOString()\n        }\n      });\n      \n      // Auto-submit after 2 seconds\n      setTimeout(() => {\n        submitExam();\n      }, 2000);\n    } else {\n      // Second violation: Warning only (status update, not incident)\n      sendMessage({\n        type: 'student_status',\n        data: {\n          sessionId: examSession.id,\n          studentId: user?.id,\n          studentName: hallTicketData?.studentName,\n          rollNumber: hallTicketData?.rollNumber,\n          violationType,\n          violationCount: newViolationCount,\n          action: 'warning',\n          timestamp: new Date().toISOString()\n        }\n      });\n    }\n  };\n\n  // Enhanced fullscreen and security event handling\n  useEffect(() => {\n    if (!examSession) return;\n\n    // Fullscreen change handler\n    const handleFullscreenChange = () => {\n      const isNowFullscreen = !!document.fullscreenElement;\n      setIsFullscreen(isNowFullscreen);\n      \n      // If user exits fullscreen during exam, handle violation\n      if (!isNowFullscreen) {\n        handleSecurityViolation(\"fullscreen_exit\", \"Student exited fullscreen mode\", \"medium\");\n        \n        // Immediately try to re-enter fullscreen\n        setTimeout(() => {\n          if (!document.fullscreenElement && examSession) {\n            enterFullscreen();\n          }\n        }, 1000);\n      }\n    };\n\n    // Tab switching / window blur detection\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        handleSecurityViolation(\"tab_switch\", \"Student switched tabs or minimized window\", \"medium\");\n      }\n    };\n\n    const handleWindowBlur = () => {\n      handleSecurityViolation(\"window_blur\", \"Student left the exam window\", \"medium\");\n    };\n\n    // Enhanced keyboard event handling with robust ESC blocking\n    const blockEscKey = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' || event.keyCode === 27 || event.which === 27) {\n        event.preventDefault();\n        event.stopPropagation();\n        event.stopImmediatePropagation();\n        handleSecurityViolation(\"key_violation\", \"Student attempted to use ESC key\", \"medium\");\n        return false;\n      }\n    };\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      // Block ESC key with maximum priority\n      if (blockEscKey(event) === false) return false;\n\n      // Block common exit combinations\n      const blockedKeys = [\n        'F11', // Toggle fullscreen\n        'Alt+Tab', // Switch apps\n        'Ctrl+Shift+I', // Dev tools\n        'F12', // Dev tools\n        'Ctrl+U', // View source\n        'Ctrl+Shift+C', // Inspect element\n        'Ctrl+Shift+J', // Console\n        'Ctrl+R', // Refresh\n        'F5', // Refresh\n        'Ctrl+N', // New window\n        'Ctrl+T', // New tab\n        'Ctrl+W', // Close tab\n      ];\n\n      // Check for other blocked combinations\n      const combo = [\n        event.ctrlKey && 'Ctrl',\n        event.altKey && 'Alt', \n        event.shiftKey && 'Shift',\n        event.key\n      ].filter(Boolean).join('+');\n\n      if (blockedKeys.includes(combo) || blockedKeys.includes(event.key)) {\n        event.preventDefault();\n        event.stopPropagation();\n        handleSecurityViolation(\"key_violation\", `Student attempted to use blocked key: ${combo}`, \"medium\");\n        return false;\n      }\n    };\n\n    const handleKeyUp = (event: KeyboardEvent) => {\n      blockEscKey(event);\n    };\n\n    const handleKeyPress = (event: KeyboardEvent) => {\n      blockEscKey(event);\n    };\n\n    // Add event listeners with multiple layers of ESC blocking\n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    window.addEventListener('blur', handleWindowBlur);\n    \n    // Multiple layers of ESC key blocking for maximum security\n    document.addEventListener('keydown', handleKeyDown, { capture: true });\n    document.addEventListener('keyup', handleKeyUp, { capture: true });\n    document.addEventListener('keypress', handleKeyPress, { capture: true });\n    window.addEventListener('keydown', handleKeyDown, { capture: true });\n    window.addEventListener('keyup', handleKeyUp, { capture: true });\n\n    // Cleanup\n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n      window.removeEventListener('blur', handleWindowBlur);\n      \n      // Remove all ESC blocking event listeners\n      document.removeEventListener('keydown', handleKeyDown, { capture: true });\n      document.removeEventListener('keyup', handleKeyUp, { capture: true });\n      document.removeEventListener('keypress', handleKeyPress, { capture: true });\n      window.removeEventListener('keydown', handleKeyDown, { capture: true });\n      window.removeEventListener('keyup', handleKeyUp, { capture: true });\n    };\n  }, [examSession, violationCount, warningCount]);\n\n  // Resume exam function\n  const resumeExam = () => {\n    setIsPaused(false);\n    // Re-enter fullscreen if needed\n    if (!document.fullscreenElement) {\n      enterFullscreen();\n    }\n    toast({\n      title: \"Exam Resumed\",\n      description: \"Your exam has been resumed. Please avoid further violations.\",\n    });\n  };\n\n  // Video snapshot streaming to admin for live monitoring\n  useEffect(() => {\n    if (!examSession || !stream || !sendMessage) return;\n\n    const sendVideoSnapshot = async () => {\n      try {\n        // Capture snapshot from video stream\n        const video = document.createElement('video');\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        \n        if (!ctx) return;\n        \n        video.srcObject = stream;\n        video.play();\n        \n        video.addEventListener('loadedmetadata', () => {\n          canvas.width = 320; // Smaller size for WebSocket transmission\n          canvas.height = 240;\n          ctx.drawImage(video, 0, 0, 320, 240);\n          \n          // Convert to data URL and send via WebSocket\n          const imageData = canvas.toDataURL('image/jpeg', 0.6);\n          sendMessage({\n            type: 'video_snapshot',\n            data: {\n              sessionId: examSession.id,\n              studentId: user?.id,\n              studentName: hallTicketData?.studentName,\n              rollNumber: hallTicketData?.rollNumber,\n              snapshot: imageData,\n              timestamp: new Date().toISOString()\n            }\n          });\n        });\n      } catch (error) {\n        console.error('Error capturing video snapshot:', error);\n        // Fallback to monitoring logs API\n        try {\n          await apiRequest(\"POST\", \"/api/monitoring-logs\", {\n            sessionId: examSession.id,\n            eventType: 'snapshot_failed',\n            eventData: { error: error.message, timestamp: new Date().toISOString() }\n          });\n        } catch (fallbackError) {\n          console.error('Fallback monitoring log failed:', fallbackError);\n        }\n      }\n    };\n\n    // Send snapshots every 3 seconds\n    const snapshotInterval = setInterval(sendVideoSnapshot, 3000);\n    \n    return () => {\n      clearInterval(snapshotInterval);\n    };\n  }, [examSession, stream, sendMessage, user, hallTicketData]);\n\n  // Timer countdown - only start when questions are loaded\n  useEffect(() => {\n    const questionsLoaded = questions && questions.length > 0;\n    if (timeRemaining > 0 && examSession && questionsLoaded) {\n      const timer = setInterval(() => {\n        setTimeRemaining(prev => {\n          if (prev <= 1) {\n            // Auto-submit exam\n            submitExam();\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n\n      return () => clearInterval(timer);\n    }\n  }, [timeRemaining, examSession, questions]);\n\n  // Enhanced face detection monitoring with thresholds\n  const [lookAwayCount, setLookAwayCount] = useState(0);\n  const [multipleFaceCount, setMultipleFaceCount] = useState(0);\n  const [lastSnapshotTime, setLastSnapshotTime] = useState(0);\n\n  useEffect(() => {\n    if (!examSession || !cameraActive) return;\n\n    const handleFaceViolation = async (violationType: string, description: string, severity: string) => {\n      try {\n        // Send face violation event to server via WebSocket (server will create incident)\n        sendMessage({\n          type: 'face_violation',\n          data: {\n            sessionId: examSession.id,\n            studentId: examSession.studentId,\n            studentName: hallTicketData?.studentName,\n            rollNumber: hallTicketData?.rollNumber,\n            incidentType: violationType,\n            severity: severity,\n            description: description,\n            metadata: { \n              confidence, \n              timestamp: new Date().toISOString()\n            }\n          }\n        });\n      } catch (error) {\n        console.error('Face violation handling error:', error);\n      }\n    };\n\n    const handleMonitoring = async () => {\n      if (multipleFaces) {\n        const newCount = multipleFaceCount + 1;\n        setMultipleFaceCount(newCount);\n        \n        // Immediate critical alert for multiple faces\n        await handleFaceViolation(\n          \"multiple_faces\", \n          `Multiple faces detected (occurrence ${newCount})`,\n          \"critical\"\n        );\n        \n        setShowWarning(true);\n        setWarningMessage(\"⚠️ Multiple faces detected! Only the exam taker should be visible.\");\n        \n      } else if (lookingAway) {\n        const newCount = lookAwayCount + 1;\n        setLookAwayCount(newCount);\n        \n        // Progressive warnings based on count\n        if (newCount === 1) {\n          setShowWarning(true);\n          setWarningMessage(\"⚠️ Please look at the camera during the exam.\");\n        } else if (newCount === 3) {\n          // After 3 look-away detections, send alert to admin\n          await handleFaceViolation(\n            \"looking_away_repeated\", \n            `Student repeatedly looking away (${newCount} times)`,\n            \"high\"\n          );\n          \n          setShowWarning(true);\n          setWarningMessage(\"⚠️ FINAL WARNING: Keep your eyes on the screen. Admin has been notified.\");\n          \n        } else if (newCount > 3) {\n          // Continue logging but don't overwhelm with alerts\n          try {\n            await apiRequest(\"POST\", \"/api/security-incidents\", {\n              sessionId: examSession.id,\n              incidentType: \"looking_away\",\n              severity: \"medium\",\n              description: `Student looking away (occurrence ${newCount})`,\n              metadata: { confidence, count: newCount }\n            });\n          } catch (error) {\n            console.error('Security incident creation error:', error);\n          }\n        }\n      } else {\n        // Reset look away counter when face is properly detected\n        if (faceDetected && lookAwayCount > 0) {\n          setLookAwayCount(0);\n        }\n      }\n\n      // Send lightweight status updates to admin (every 10 seconds when camera is active)\n      const now = Date.now();\n      if (faceDetected && now - lastSnapshotTime > 10000) {\n        setLastSnapshotTime(now);\n        try {\n          sendMessage({\n            type: 'student_status',\n            data: {\n              sessionId: examSession.id,\n              studentId: examSession.studentId,\n              timestamp: new Date().toISOString(),\n              status: {\n                faceDetected,\n                multipleFaces,\n                lookingAway,\n                confidence,\n                violationCount,\n                lookAwayCount\n              }\n            }\n          });\n        } catch (error) {\n          console.error('Status update error:', error);\n        }\n      }\n    };\n\n    // Execute monitoring logic\n    handleMonitoring();\n\n  }, [multipleFaces, lookingAway, faceDetected, examSession, cameraActive, confidence, lookAwayCount, multipleFaceCount, lastSnapshotTime]);\n\n  // Create security incident\n\n  // Load hall ticket data on mount and start camera immediately\n  useEffect(() => {\n    const storedData = localStorage.getItem(\"hallTicketData\");\n    const verificationComplete = localStorage.getItem(\"verificationComplete\");\n    \n    if (!storedData || !verificationComplete) {\n      toast({\n        title: \"Authentication Required\",\n        description: \"Please complete authentication and verification first\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n      return;\n    }\n    \n    try {\n      const data = JSON.parse(storedData);\n      setHallTicketData(data);\n      \n      // Start camera immediately for faster activation\n      startCamera();\n      \n      createSessionMutation.mutate(data.id);\n    } catch (error) {\n      toast({\n        title: \"Invalid Data\",\n        description: \"Please complete authentication again\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n    }\n  }, [startCamera]);\n\n  const formatTime = (seconds: number) => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const handleAnswerChange = (questionIndex: number, answer: string) => {\n    setAnswers(prev => ({ ...prev, [questionIndex]: answer }));\n  };\n\n  const navigateQuestion = (direction: 'prev' | 'next') => {\n    const questionsLength = questions?.length || 0;\n    if (direction === 'prev' && currentQuestion > 1) {\n      setCurrentQuestion(prev => prev - 1);\n    } else if (direction === 'next' && currentQuestion < questionsLength) {\n      setCurrentQuestion(prev => prev + 1);\n    }\n  };\n\n  // Submit exam mutation\n  const submitExamMutation = useMutation({\n    mutationFn: async () => {\n      if (!examSession) throw new Error(\"No exam session found\");\n      \n      const response = await apiRequest(\"POST\", `/api/exam-sessions/${examSession.id}/submit`, {\n        answers\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Exam Submitted\",\n        description: \"Your exam has been submitted successfully\",\n      });\n      \n      // Exit fullscreen and clean up\n      exitFullscreen();\n      localStorage.removeItem(\"hallTicketData\");\n      localStorage.removeItem(\"verificationComplete\");\n      setLocation(\"/exam-complete\");\n    },\n    onError: (error) => {\n      toast({\n        title: \"Submission Failed\",\n        description: error.message || \"Failed to submit exam. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const submitExam = () => {\n    submitExamMutation.mutate();\n  };\n\n  if (!hallTicketData || !examSession) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Initializing exam session...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Safe access to questions array\n  const questionsArray = questions || [];\n  const currentQuestionData = questionsArray[currentQuestion - 1];\n\n  // Show loading while questions are being fetched\n  if (questionsLoading || !currentQuestionData || questionsArray.length === 0) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading exam questions...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"kiosk-mode bg-background\">\n      {/* Exam Header */}\n      <div className=\"bg-gradient-primary text-white p-4 flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <i className=\"fas fa-graduation-cap text-2xl\"></i>\n          <div>\n            <h1 className=\"font-bold text-lg\">{hallTicketData.examName}</h1>\n            <p className=\"text-sm opacity-90\">\n              {hallTicketData.hallTicketId || hallTicketData.id} - {hallTicketData.studentName} ({hallTicketData.rollNumber})\n            </p>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center space-x-6\">\n          {/* Timer */}\n          <div className=\"text-center\">\n            <div className=\"text-3xl font-mono font-bold\">{formatTime(timeRemaining)}</div>\n            <div className=\"text-xs opacity-75\">Time Remaining</div>\n          </div>\n          \n          {/* Status Indicators */}\n          <div className=\"flex items-center space-x-3\">\n            <div className=\"flex items-center space-x-1\">\n              <div className={`status-indicator ${faceDetected ? 'status-online pulse-green' : 'status-warning'}`}></div>\n              <span className=\"text-xs\">Camera</span>\n            </div>\n            <div className=\"flex items-center space-x-1\">\n              <div className=\"status-indicator status-online\"></div>\n              <span className=\"text-xs\">Network</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex h-[calc(100vh-80px)]\">\n        {/* Question Panel */}\n        <div className=\"flex-1 p-6 overflow-y-auto\">\n          <div className=\"max-w-4xl mx-auto\">\n            {/* Question Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div className=\"flex items-center space-x-4\">\n                <span className=\"bg-primary text-primary-foreground px-4 py-2 rounded-full font-semibold\">\n                  Question {currentQuestion} of {questionsArray.length}\n                </span>\n                <span className=\"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm\">\n                  Multiple Choice\n                </span>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button className=\"bg-yellow-100 text-yellow-800 p-2 rounded-lg hover:bg-yellow-200\">\n                  <i className=\"fas fa-flag\"></i>\n                </button>\n              </div>\n            </div>\n\n            {/* Question Content */}\n            <div className=\"bg-card rounded-xl p-6 shadow-sm mb-6\">\n              <h2 className=\"text-xl font-semibold text-foreground mb-4\">\n                {currentQuestionData.questionText}\n              </h2>\n              \n              <div className=\"space-y-4 mt-6\">\n                {currentQuestionData.options.map((option: string, index: number) => {\n                  const optionLetter = String.fromCharCode(65 + index); // A, B, C, D\n                  const isSelected = answers[currentQuestion] === optionLetter;\n                  \n                  return (\n                    <label \n                      key={index}\n                      className={`flex items-center p-4 rounded-lg cursor-pointer transition-colors ${\n                        isSelected \n                          ? 'bg-primary/10 border-2 border-primary' \n                          : 'bg-muted hover:bg-border'\n                      }`}\n                    >\n                      <input \n                        type=\"radio\" \n                        name=\"answer\" \n                        value={optionLetter}\n                        checked={isSelected}\n                        onChange={(e) => handleAnswerChange(currentQuestion, e.target.value)}\n                        className=\"mr-4 w-5 h-5 accent-primary\"\n                        data-testid={`option-${optionLetter}`}\n                      />\n                      <div>\n                        <span className=\"font-medium text-primary mr-3\">{optionLetter})</span>\n                        <span>{option}</span>\n                      </div>\n                    </label>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Navigation Buttons */}\n            <div className=\"flex justify-between items-center\">\n              <Button\n                variant=\"outline\"\n                onClick={() => navigateQuestion('prev')}\n                disabled={currentQuestion === 1}\n                data-testid=\"button-previous\"\n              >\n                <i className=\"fas fa-chevron-left mr-2\"></i>Previous\n              </Button>\n              \n              <div className=\"flex space-x-4\">\n                <Button\n                  variant=\"outline\"\n                  className=\"bg-yellow-100 text-yellow-800 hover:bg-yellow-200\"\n                  data-testid=\"button-bookmark\"\n                >\n                  <i className=\"fas fa-bookmark mr-2\"></i>Save & Mark\n                </Button>\n                {questions && currentQuestion < questions.length ? (\n                  <Button\n                    onClick={() => navigateQuestion('next')}\n                    data-testid=\"button-next\"\n                  >\n                    Next<i className=\"fas fa-chevron-right ml-2\"></i>\n                  </Button>\n                ) : (\n                  <Button\n                    onClick={submitExam}\n                    variant=\"destructive\"\n                    data-testid=\"button-submit\"\n                  >\n                    <i className=\"fas fa-paper-plane mr-2\"></i>Submit Exam\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Question Navigation Panel */}\n        <div className=\"w-80 bg-card border-l border-border p-6\">\n          <div className=\"mb-6\">\n            <h3 className=\"font-semibold text-foreground mb-4\">Question Navigator</h3>\n            \n            {/* Legend */}\n            <div className=\"space-y-2 mb-4\">\n              <div className=\"flex items-center space-x-2 text-sm\">\n                <div className=\"w-6 h-6 bg-green-500 rounded\"></div>\n                <span>Answered</span>\n              </div>\n              <div className=\"flex items-center space-x-2 text-sm\">\n                <div className=\"w-6 h-6 bg-primary rounded\"></div>\n                <span>Current</span>\n              </div>\n              <div className=\"flex items-center space-x-2 text-sm\">\n                <div className=\"w-6 h-6 bg-yellow-500 rounded\"></div>\n                <span>Marked</span>\n              </div>\n              <div className=\"flex items-center space-x-2 text-sm\">\n                <div className=\"w-6 h-6 bg-muted border-2 border-border rounded\"></div>\n                <span>Not Visited</span>\n              </div>\n            </div>\n            \n            {/* Question Grid */}\n            <div className=\"grid grid-cols-5 gap-2\">\n              {questionsArray.map((_: Question, index: number) => {\n                const questionNum = index + 1;\n                const isAnswered = answers[questionNum];\n                const isCurrent = currentQuestion === questionNum;\n                \n                return (\n                  <button\n                    key={index}\n                    className={`w-10 h-10 rounded font-medium hover:opacity-80 transition-opacity ${\n                      isCurrent \n                        ? 'bg-primary text-white' \n                        : isAnswered \n                          ? 'bg-green-500 text-white'\n                          : 'bg-muted border-2 border-border hover:bg-border'\n                    }`}\n                    onClick={() => setCurrentQuestion(questionNum)}\n                    data-testid={`question-nav-${questionNum}`}\n                  >\n                    {questionNum}\n                  </button>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Exam Summary */}\n          <div className=\"bg-muted rounded-lg p-4 mb-6\">\n            <h4 className=\"font-semibold mb-3\">Progress Summary</h4>\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span>Answered:</span>\n                <span className=\"font-medium text-green-600\">\n                  {Object.keys(answers).length}/{questions?.length || 0}\n                </span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Marked:</span>\n                <span className=\"font-medium text-yellow-600\">0/{questions?.length || 0}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Not Visited:</span>\n                <span className=\"font-medium text-muted-foreground\">\n                  {(questions?.length || 0) - Math.max(...Object.keys(answers).map(Number), 0)}/{questions?.length || 0}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Submit Section */}\n          <div className=\"border-t border-border pt-4\">\n            <Button\n              onClick={submitExam}\n              variant=\"destructive\"\n              className=\"w-full\"\n              data-testid=\"button-final-submit\"\n            >\n              <i className=\"fas fa-paper-plane mr-2\"></i>Submit Exam\n            </Button>\n            <p className=\"text-xs text-muted-foreground text-center mt-2\">\n              Auto-submit in {formatTime(timeRemaining)}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Enhanced Live Camera Feed (Bottom-right corner) */}\n      <div className=\"fixed bottom-4 right-4 w-72 h-52 bg-black rounded-lg overflow-hidden shadow-xl border-2 border-primary z-10\">\n        <WebcamMonitor \n          stream={stream}\n          isActive={cameraActive}\n          error={cameraError}\n          onStartCamera={startCamera}\n          onStopCamera={stopCamera}\n          className=\"w-full h-full\"\n        />\n        <div className=\"absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded text-xs font-mono\">\n          ● LIVE\n        </div>\n        <div className={`absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs transition-colors ${\n          faceDetected ? 'bg-green-600/70' : 'bg-red-600/70'\n        }`}>\n          Face: {faceDetected ? '✓' : '✗'}\n        </div>\n        <div className=\"absolute bottom-2 left-2 right-2\">\n          <div className=\"bg-black/70 text-white px-2 py-1 rounded text-xs text-center\">\n            {cameraActive ? 'Monitoring Active' : 'Camera Inactive'}\n          </div>\n        </div>\n        {multipleFaces && (\n          <div className=\"absolute inset-0 bg-red-600/20 border-2 border-red-500 animate-pulse\">\n            <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-600 text-white px-3 py-1 rounded font-bold text-sm\">\n              MULTIPLE FACES!\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Enhanced Warning Banner */}\n      {showWarning && (\n        <div className=\"fixed top-0 left-0 right-0 bg-destructive text-destructive-foreground p-4 text-center font-semibold z-20\">\n          <i className=\"fas fa-exclamation-triangle mr-2\"></i>\n          {warningMessage || \n            `WARNING: ${multipleFaces ? 'Multiple faces detected' : lookingAway ? 'Looking away detected' : 'Please face the camera'}.`\n          }\n          <Button\n            variant=\"secondary\"\n            size=\"sm\"\n            className=\"ml-4\"\n            onClick={() => setShowWarning(false)}\n          >\n            Dismiss\n          </Button>\n        </div>\n      )}\n\n      {/* Exam Paused Overlay */}\n      {isPaused && (\n        <div className=\"fixed inset-0 bg-black/80 flex items-center justify-center z-50\">\n          <div className=\"bg-card p-8 rounded-xl shadow-2xl text-center max-w-md mx-4\">\n            <div className=\"mb-6\">\n              <i className=\"fas fa-pause-circle text-6xl text-yellow-500 mb-4\"></i>\n              <h2 className=\"text-2xl font-bold text-foreground mb-2\">Exam Paused</h2>\n              <p className=\"text-muted-foreground mb-4\">\n                Your exam has been paused due to a security violation.\n              </p>\n              <div className=\"bg-muted rounded-lg p-4 mb-6\">\n                <p className=\"text-sm\">\n                  <strong>Violations:</strong> {violationCount}/3\n                </p>\n                <p className=\"text-xs text-muted-foreground mt-2\">\n                  {violationCount >= 2 \n                    ? \"⚠️ One more violation will auto-submit your exam!\" \n                    : \"Please avoid further violations to continue.\"\n                  }\n                </p>\n              </div>\n            </div>\n            <Button \n              onClick={resumeExam}\n              size=\"lg\"\n              className=\"w-full\"\n              data-testid=\"button-resume\"\n            >\n              <i className=\"fas fa-play mr-2\"></i>\n              Resume Exam\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Enhanced Security Status Indicator */}\n      <div className=\"fixed bottom-4 left-4 bg-card/95 backdrop-blur border rounded-lg p-3 shadow-lg z-10\">\n        <div className=\"text-xs space-y-1\">\n          <div className=\"flex items-center space-x-2\">\n            <div className={`w-2 h-2 rounded-full ${isFullscreen ? 'bg-green-500' : 'bg-red-500'}`}></div>\n            <span>Fullscreen: {isFullscreen ? 'Active' : 'Inactive'}</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className={`w-2 h-2 rounded-full ${violationCount === 0 ? 'bg-green-500' : violationCount < 3 ? 'bg-yellow-500' : 'bg-red-500'}`}></div>\n            <span>Violations: {violationCount}/3</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className={`w-2 h-2 rounded-full ${faceDetected ? 'bg-green-500' : 'bg-yellow-500'}`}></div>\n            <span>Face: {faceDetected ? 'Detected' : 'Not Found'}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":38433},"client/src/pages/student/identity-verification.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport WebcamMonitor from \"@/components/webcam-monitor\";\nimport FaceDetection from \"@/components/face-detection\";\nimport { useWebcam } from \"@/hooks/useWebcam\";\nimport { useFaceDetection } from \"@/hooks/useFaceDetection\";\n\ninterface HallTicketData {\n  id: string;\n  examName: string;\n  studentName: string;\n  rollNumber: string;\n  examDate: string;\n  duration: number;\n}\n\nexport default function IdentityVerification() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [hallTicketData, setHallTicketData] = useState<HallTicketData | null>(null);\n  const [verificationStep, setVerificationStep] = useState<'camera' | 'photo' | 'document' | 'complete'>('camera');\n  const [capturedPhoto, setCapturedPhoto] = useState<string | null>(null);\n  const [documentUploaded, setDocumentUploaded] = useState(false);\n  const [documentFile, setDocumentFile] = useState<File | null>(null);\n  const [documentVerificationStatus, setDocumentVerificationStatus] = useState<'pending' | 'verifying' | 'verified' | 'failed'>('pending');\n  const [documentPreview, setDocumentPreview] = useState<string | null>(null);\n  const [verificationResult, setVerificationResult] = useState<any>(null);\n  \n  // Test mode detection for bypassing camera/verification - ONLY in explicit development\n  const TEST_MODE = import.meta.env.NODE_ENV === 'development' ||\n                   import.meta.env.VITE_TEST_MODE === 'true' || \n                   (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');\n  \n  const { stream, isActive: cameraActive, error: cameraError, startCamera, stopCamera, capturePhoto } = useWebcam();\n  const { faceDetected, confidence } = useFaceDetection(stream);\n\n  useEffect(() => {\n    // Get hall ticket data from localStorage\n    const storedData = localStorage.getItem(\"hallTicketData\");\n    if (!storedData) {\n      toast({\n        title: \"No Hall Ticket Data\",\n        description: \"Please complete authentication first\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n      return;\n    }\n    \n    try {\n      setHallTicketData(JSON.parse(storedData));\n    } catch (error) {\n      toast({\n        title: \"Invalid Data\",\n        description: \"Please complete authentication again\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n    }\n  }, [setLocation, toast]);\n\n  // Auto-start camera when component loads (or bypass in test mode if camera error)\n  useEffect(() => {\n    startCamera();\n  }, [startCamera]);\n\n  // Camera error bypass for test mode and auto-verification\n  useEffect(() => {\n    if (TEST_MODE && cameraError && cameraError.includes('NotFoundError')) {\n      toast({\n        title: \"Test Mode Active\",\n        description: \"Camera not available - using test mode bypass\",\n        variant: \"default\",\n      });\n      \n      // Auto-trigger verification if document is already uploaded and camera fails\n      if (documentUploaded && documentVerificationStatus === 'verified') {\n        setTimeout(() => {\n          console.log(\"Auto-triggering verification due to no camera in test mode\");\n          performAIVerification();\n        }, 2000);\n      }\n    }\n  }, [TEST_MODE, cameraError, documentUploaded, documentVerificationStatus, toast]);\n\n  const handleCapturePhoto = async () => {\n    try {\n      const photoData = await capturePhoto();\n      if (photoData) {\n        setCapturedPhoto(photoData);\n        setVerificationStep('document');\n        toast({\n          title: \"Photo Captured\",\n          description: \"Photo captured successfully. Please upload your ID document.\",\n        });\n      }\n    } catch (error) {\n      toast({\n        title: \"Capture Failed\",\n        description: \"Failed to capture photo. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const validateDocument = (file: File): { isValid: boolean; message: string } => {\n    // File type validation\n    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'];\n    if (!allowedTypes.includes(file.type)) {\n      return { isValid: false, message: 'Please upload a valid image file (JPEG, PNG, or WebP)' };\n    }\n    \n    // File size validation (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      return { isValid: false, message: 'File size must be less than 5MB' };\n    }\n    \n    // File name validation (basic)\n    if (file.name.length > 100) {\n      return { isValid: false, message: 'File name is too long' };\n    }\n    \n    return { isValid: true, message: 'Valid document format' };\n  };\n\n  const analyzeDocument = async (file: File): Promise<{ quality: 'good' | 'poor' | 'acceptable'; issues: string[] }> => {\n    return new Promise((resolve) => {\n      const img = new Image();\n      const url = URL.createObjectURL(file);\n      \n      img.onload = () => {\n        const issues: string[] = [];\n        let quality: 'good' | 'poor' | 'acceptable' = 'good';\n        \n        // In development mode, be more lenient with requirements for testing\n        const isDevelopment = import.meta.env.NODE_ENV === 'development' || import.meta.env.DEV;\n        \n        // Check image dimensions (relaxed for development)\n        const minWidth = isDevelopment ? 200 : 400;\n        const minHeight = isDevelopment ? 150 : 300;\n        \n        if (img.width < minWidth || img.height < minHeight) {\n          if (isDevelopment) {\n            issues.push('Low resolution image (acceptable for testing)');\n            quality = 'acceptable';\n          } else {\n            issues.push('Image resolution is too low');\n            quality = 'poor';\n          }\n        } else if (img.width < 800 || img.height < 600) {\n          issues.push('Consider using a higher resolution image');\n          quality = 'acceptable';\n        }\n        \n        // Check aspect ratio (relaxed for development)\n        const aspectRatio = img.width / img.height;\n        const minRatio = isDevelopment ? 0.8 : 1.3;\n        const maxRatio = isDevelopment ? 3.0 : 2.0;\n        \n        if (aspectRatio < minRatio || aspectRatio > maxRatio) {\n          if (isDevelopment) {\n            issues.push('Aspect ratio is non-standard (acceptable for testing)');\n            if (quality === 'good') quality = 'acceptable';\n          } else {\n            issues.push('Image aspect ratio doesn\\'t match typical ID cards');\n            if (quality === 'good') quality = 'acceptable';\n          }\n        }\n        \n        URL.revokeObjectURL(url);\n        resolve({ quality, issues });\n      };\n      \n      img.onerror = () => {\n        URL.revokeObjectURL(url);\n        resolve({ quality: 'poor', issues: ['Failed to analyze image'] });\n      };\n      \n      img.src = url;\n    });\n  };\n\n  const handleDocumentUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n    \n    // Validate document format\n    const validation = validateDocument(file);\n    if (!validation.isValid) {\n      toast({\n        title: \"Invalid Document\",\n        description: validation.message,\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    setDocumentFile(file);\n    setDocumentVerificationStatus('verifying');\n    \n    // Create preview\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      setDocumentPreview(e.target?.result as string);\n    };\n    reader.readAsDataURL(file);\n    \n    try {\n      // Analyze document quality\n      const analysis = await analyzeDocument(file);\n      \n      // Immediately process without delay for faster verification\n      if (analysis.quality === 'poor') {\n        setDocumentVerificationStatus('failed');\n        toast({\n          title: \"Document Quality Issues\",\n          description: `Please upload a clearer image. Issues: ${analysis.issues.join(', ')}`,\n          variant: \"destructive\",\n        });\n      } else {\n        // Instead of auto-completing, trigger AI verification immediately\n        if (capturedPhoto) {\n          performAIVerification();\n        } else {\n          setDocumentVerificationStatus('verified');\n          setDocumentUploaded(true);\n          \n          let message = \"ID document uploaded successfully!\";\n          if (analysis.issues.length > 0) {\n            message += ` Note: ${analysis.issues.join(', ')}`;\n          }\n          \n          // Auto-trigger verification ONLY in test mode for security\n          if (TEST_MODE && cameraError && cameraError.includes('NotFoundError')) {\n            message += \" Auto-verifying without camera (TEST MODE)...\";\n            setTimeout(() => performAIVerification(), 1000);\n          } else {\n            message += \" Now capture your photo for AI verification.\";\n          }\n          \n          toast({\n            title: \"Document Uploaded\",\n            description: message,\n          });\n        }\n      }\n      \n    } catch (error) {\n      setDocumentVerificationStatus('failed');\n      toast({\n        title: \"Verification Failed\",\n        description: \"Failed to process the document. Please try again.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const retryDocumentUpload = () => {\n    setDocumentFile(null);\n    setDocumentPreview(null);\n    setDocumentVerificationStatus('pending');\n    setDocumentUploaded(false);\n  };\n\n  const bypassCameraForTesting = () => {\n    setCapturedPhoto(\"test-mode-photo\");\n    setVerificationStep('document');\n    toast({\n      title: \"Test Mode Bypass\",\n      description: \"Camera verification bypassed for testing\",\n      variant: \"default\",\n    });\n    \n    // Auto-trigger verification if document is already uploaded\n    if (documentUploaded && documentVerificationStatus === 'verified') {\n      setTimeout(() => {\n        console.log(\"Auto-triggering AI verification after camera bypass\");\n        performAIVerification();\n      }, 1000);\n    }\n  };\n\n  const bypassDocumentForTesting = () => {\n    setDocumentUploaded(true);\n    setDocumentVerificationStatus('verified');\n    setVerificationStep('complete');\n    toast({\n      title: \"Test Mode Bypass\",\n      description: \"Document verification bypassed for testing\",\n      variant: \"default\",\n    });\n  };\n\n  // Fast AI verification function (5-10 seconds max)\n  const performAIVerification = async () => {\n    if (!hallTicketData) {\n      toast({\n        title: \"Error\",\n        description: \"Hall ticket data missing\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!documentFile || !documentPreview) {\n      toast({\n        title: \"Error\", \n        description: \"Please upload your ID document first\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      setVerificationResult(null);\n      \n      // Use placeholder photo ONLY in test mode for security\n      let photoToUse = capturedPhoto;\n      if (!photoToUse && TEST_MODE) {\n        photoToUse = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAX/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwCdABmX/9k=\"; // 1x1 pixel placeholder\n        console.log(\"Using placeholder photo for verification (TEST MODE ONLY)\");\n      }\n\n      if (!photoToUse) {\n        toast({\n          title: \"Error\",\n          description: \"Please capture your photo first or enable camera\",\n          variant: \"destructive\",\n        });\n        return;\n      }\n\n      console.log(\"Starting fast AI verification...\");\n      \n      // Convert document file to base64\n      const documentBase64 = await new Promise<string>((resolve) => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const result = e.target?.result as string;\n          const base64 = result.split(',')[1]; // Remove data:image/... prefix\n          resolve(base64);\n        };\n        reader.readAsDataURL(documentFile);\n      });\n\n      // Extract base64 from photo (remove data URL prefix if present)\n      const photoBase64 = photoToUse.includes(',') ? photoToUse.split(',')[1] : photoToUse;\n\n      const requestData = {\n        idCardImage: documentBase64,\n        selfieImage: photoBase64,\n        expectedName: hallTicketData.studentName,\n        expectedIdNumber: hallTicketData.rollNumber,\n        hallTicketId: hallTicketData.id\n      };\n\n      console.log(\"Calling fast verification API...\");\n      \n      const response = await fetch('/api/verify-identity', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(requestData),\n      });\n\n      const result = await response.json();\n      console.log(\"Verification result:\", result);\n\n      setVerificationResult(result);\n\n      if (result.isValid) {\n        setVerificationStep('complete');\n        toast({\n          title: \"Verification Successful! ✅\",\n          description: `Identity verified in ${result.confidence ? Math.round(result.confidence * 100) : 85}% confidence. You can now start your exam.`,\n        });\n      } else {\n        toast({\n          title: \"Verification Failed\",\n          description: result.reasons?.join('. ') || \"Unable to verify identity. Please try again.\",\n          variant: \"destructive\",\n        });\n      }\n\n    } catch (error) {\n      console.error(\"Verification error:\", error);\n      \n      // Fast fallback: Auto-approve if API fails for speed\n      if (TEST_MODE) {\n        console.log(\"API failed, using fallback approval for test mode\");\n        setVerificationResult({\n          isValid: true,\n          confidence: 0.7,\n          extractedData: { name: hallTicketData.studentName },\n          faceMatch: { matches: true, confidence: 0.7 },\n          reasons: [\"Fallback approval: API unavailable\"]\n        });\n        setVerificationStep('complete');\n        toast({\n          title: \"Verification Complete ✅\",\n          description: \"Fast approval applied. You can now start your exam.\",\n        });\n      } else {\n        toast({\n          title: \"Verification Error\",\n          description: \"Failed to verify identity. Please try again.\",\n          variant: \"destructive\",\n        });\n      }\n    }\n  };\n\n  const handleContinueToExam = () => {\n    // Store verification completion\n    localStorage.setItem(\"verificationComplete\", \"true\");\n    setLocation(\"/student/exam\");\n  };\n\n  const getVerificationStatus = (step: string) => {\n    switch (step) {\n      case 'camera':\n        return faceDetected ? 'completed' : cameraActive ? 'active' : 'pending';\n      case 'photo':\n        return capturedPhoto ? 'completed' : verificationStep === 'photo' ? 'active' : 'pending';\n      case 'document':\n        return documentUploaded ? 'completed' : verificationStep === 'document' ? 'active' : 'pending';\n      default:\n        return 'pending';\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <i className=\"fas fa-check-circle text-green-500\"></i>;\n      case 'active':\n        return <i className=\"fas fa-clock text-yellow-500\"></i>;\n      default:\n        return <i className=\"fas fa-circle text-gray-400\"></i>;\n    }\n  };\n\n  if (!hallTicketData) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-accent flex items-center justify-center p-4\">\n      {/* Back Button */}\n      <div className=\"fixed top-4 left-4 z-10\">\n        <Button \n          variant=\"outline\" \n          onClick={() => setLocation(\"/student/auth\")} \n          className=\"bg-white/10 border-white/20 text-white hover:bg-white/20\"\n          data-testid=\"button-back\"\n        >\n          <i className=\"fas fa-arrow-left mr-2\"></i>\n          Back\n        </Button>\n      </div>\n      \n      <div className=\"max-w-4xl w-full\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"w-20 h-20 bg-gradient-accent rounded-full flex items-center justify-center mx-auto mb-4\">\n            <i className=\"fas fa-id-card text-2xl text-white\"></i>\n          </div>\n          <h1 className=\"text-2xl font-bold text-white\">Identity Verification</h1>\n          <p className=\"text-white/80 mt-2\">Please verify your identity before starting the exam</p>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          {/* Verification Process */}\n          <div className=\"space-y-6\">\n            {/* Live Photo Capture */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <i className=\"fas fa-video text-accent\"></i>\n                  <span>Live Photo Capture</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <WebcamMonitor \n                    stream={stream}\n                    isActive={cameraActive}\n                    error={cameraError}\n                    onStartCamera={startCamera}\n                    onStopCamera={stopCamera}\n                  />\n                  <FaceDetection stream={stream} />\n                  \n                  <div className=\"flex justify-between items-center\">\n                    <div className=\"flex gap-2\">\n                      <Button\n                        onClick={cameraActive ? handleCapturePhoto : startCamera}\n                        disabled={cameraActive && !faceDetected}\n                        className=\"bg-accent hover:opacity-90\"\n                        data-testid=\"button-capture-photo\"\n                      >\n                        <i className={`fas ${cameraActive ? 'fa-camera' : 'fa-video'} mr-2`}></i>\n                        {cameraActive ? 'Capture Photo' : 'Start Camera'}\n                      </Button>\n                      {TEST_MODE && (cameraError || !cameraActive) && (\n                        <Button\n                          onClick={bypassCameraForTesting}\n                          variant=\"outline\"\n                          className=\"border-orange-300 text-orange-600 hover:bg-orange-50\"\n                          data-testid=\"button-bypass-camera\"\n                        >\n                          <i className=\"fas fa-forward mr-2\"></i>\n                          Bypass Camera (Test)\n                        </Button>\n                      )}\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className={`status-indicator ${faceDetected ? 'status-online' : 'status-warning'}`}></div>\n                      <span className=\"text-sm text-muted-foreground\">\n                        {faceDetected ? `Face Detected (${Math.round(confidence * 100)}%)` : 'No Face Detected'}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* ID Document Upload */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <i className=\"fas fa-id-card text-accent\"></i>\n                  <span>ID Document Verification</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"border-2 border-dashed border-border rounded-xl p-6 text-center bg-muted\">\n                  {documentVerificationStatus === 'verified' ? (\n                    <div className=\"text-green-600\">\n                      <i className=\"fas fa-check-circle text-3xl mb-4\"></i>\n                      <p className=\"font-medium\">Document verified successfully</p>\n                      {documentPreview && (\n                        <div className=\"mt-4\">\n                          <img \n                            src={documentPreview} \n                            alt=\"Uploaded document\" \n                            className=\"max-w-32 max-h-24 object-cover rounded-lg mx-auto border\"\n                          />\n                          <p className=\"text-xs text-muted-foreground mt-1\">{documentFile?.name}</p>\n                        </div>\n                      )}\n                    </div>\n                  ) : documentVerificationStatus === 'verifying' ? (\n                    <div className=\"text-blue-600\">\n                      <div className=\"animate-spin w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full mx-auto mb-4\"></div>\n                      <p className=\"font-medium\">Verifying document...</p>\n                      <p className=\"text-sm text-muted-foreground mt-2\">Analyzing image quality and format</p>\n                      {documentPreview && (\n                        <div className=\"mt-4\">\n                          <img \n                            src={documentPreview} \n                            alt=\"Uploaded document\" \n                            className=\"max-w-32 max-h-24 object-cover rounded-lg mx-auto border opacity-75\"\n                          />\n                        </div>\n                      )}\n                    </div>\n                  ) : documentVerificationStatus === 'failed' ? (\n                    <div className=\"text-red-600\">\n                      <i className=\"fas fa-exclamation-triangle text-3xl mb-4\"></i>\n                      <p className=\"font-medium\">Document verification failed</p>\n                      <p className=\"text-sm text-muted-foreground mt-2\">Please upload a clearer image</p>\n                      {documentPreview && (\n                        <div className=\"mt-4\">\n                          <img \n                            src={documentPreview} \n                            alt=\"Uploaded document\" \n                            className=\"max-w-32 max-h-24 object-cover rounded-lg mx-auto border opacity-50\"\n                          />\n                        </div>\n                      )}\n                      <div className=\"mt-3 flex gap-2 justify-center\">\n                        <Button \n                          onClick={retryDocumentUpload}\n                          className=\"bg-primary hover:opacity-90\"\n                          data-testid=\"button-retry-document\"\n                        >\n                          <i className=\"fas fa-redo mr-2\"></i>Try Again\n                        </Button>\n                        {TEST_MODE && (\n                          <Button\n                            onClick={bypassDocumentForTesting}\n                            variant=\"outline\"\n                            className=\"border-orange-300 text-orange-600 hover:bg-orange-50\"\n                            data-testid=\"button-bypass-document\"\n                          >\n                            <i className=\"fas fa-forward mr-2\"></i>\n                            Bypass (Test)\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  ) : (\n                    <>\n                      <i className=\"fas fa-id-card text-3xl text-muted-foreground mb-4\"></i>\n                      <p className=\"text-muted-foreground mb-4\">\n                        Upload your student ID or government-issued ID\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mb-4\">\n                        Supported formats: JPEG, PNG, WebP • Max size: 5MB\n                      </p>\n                      <div>\n                        <input\n                          type=\"file\"\n                          accept=\"image/jpeg,image/jpg,image/png,image/webp\"\n                          onChange={handleDocumentUpload}\n                          className=\"hidden\"\n                          id=\"document-upload\"\n                          data-testid=\"input-document-upload\"\n                        />\n                        <label htmlFor=\"document-upload\">\n                          <Button asChild className=\"bg-primary hover:opacity-90\">\n                            <span>\n                              <i className=\"fas fa-upload mr-2\"></i>Choose File\n                            </span>\n                          </Button>\n                        </label>\n                      </div>\n                    </>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Student Information & Progress */}\n          <div className=\"space-y-6\">\n            {/* Student Information */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Student Information</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"bg-muted rounded-xl p-6\">\n                  <div className=\"flex items-start space-x-4 mb-6\">\n                    <div className=\"w-16 h-16 bg-gradient-primary rounded-lg flex items-center justify-center\">\n                      <i className=\"fas fa-user text-white text-xl\"></i>\n                    </div>\n                    <div>\n                      <h4 className=\"font-semibold text-lg\">{hallTicketData.studentName}</h4>\n                      <p className=\"text-muted-foreground\">Hall Ticket: {hallTicketData.id}</p>\n                      <p className=\"text-muted-foreground\">Roll: {hallTicketData.rollNumber}</p>\n                      <p className=\"text-muted-foreground\">Exam: {hallTicketData.examName}</p>\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-muted-foreground\">Hall Ticket Verified:</span>\n                      <div className=\"flex items-center space-x-2\">\n                        <i className=\"fas fa-check-circle text-green-500\"></i>\n                        <span className=\"text-green-600 font-medium\">Valid</span>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-muted-foreground\">Photo Match:</span>\n                      <div className=\"flex items-center space-x-2\">\n                        {capturedPhoto ? (\n                          <>\n                            <i className=\"fas fa-check-circle text-green-500\"></i>\n                            <span className=\"text-green-600 font-medium\">Captured</span>\n                          </>\n                        ) : (\n                          <>\n                            <i className=\"fas fa-clock text-yellow-500\"></i>\n                            <span className=\"text-yellow-600 font-medium\">Pending</span>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-muted-foreground\">ID Document:</span>\n                      <div className=\"flex items-center space-x-2\">\n                        {documentUploaded ? (\n                          <>\n                            <i className=\"fas fa-check-circle text-green-500\"></i>\n                            <span className=\"text-green-600 font-medium\">Verified</span>\n                          </>\n                        ) : (\n                          <>\n                            <i className=\"fas fa-exclamation-circle text-yellow-500\"></i>\n                            <span className=\"text-yellow-600 font-medium\">Pending</span>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Verification Checklist */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Verification Checklist</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg\">\n                    <div className=\"flex items-center space-x-3\">\n                      <i className=\"fas fa-check-circle text-green-500\"></i>\n                      <span className=\"text-green-800\">Hall ticket validated</span>\n                    </div>\n                  </div>\n                  \n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${\n                    capturedPhoto \n                      ? 'bg-green-50 border-green-200' \n                      : faceDetected \n                        ? 'bg-yellow-50 border-yellow-200'\n                        : 'bg-gray-50 border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center space-x-3\">\n                      {getStatusIcon(getVerificationStatus('photo'))}\n                      <span className={\n                        capturedPhoto \n                          ? 'text-green-800' \n                          : faceDetected \n                            ? 'text-yellow-800'\n                            : 'text-gray-600'\n                      }>\n                        Live photo captured\n                      </span>\n                    </div>\n                  </div>\n                  \n                  <div className={`flex items-center justify-between p-3 rounded-lg border ${\n                    documentUploaded \n                      ? 'bg-green-50 border-green-200' \n                      : 'bg-gray-50 border-gray-200'\n                  }`}>\n                    <div className=\"flex items-center space-x-3\">\n                      {getStatusIcon(getVerificationStatus('document'))}\n                      <span className={documentUploaded ? 'text-green-800' : 'text-gray-600'}>\n                        ID document verified\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Action Buttons */}\n            <div className=\"flex space-x-4\">\n              <Button \n                variant=\"outline\" \n                className=\"flex-1\"\n                onClick={() => {\n                  // Reset verification\n                  setCapturedPhoto(null);\n                  setDocumentUploaded(false);\n                  setVerificationStep('camera');\n                  if (cameraActive) stopCamera();\n                }}\n                data-testid=\"button-retry\"\n              >\n                <i className=\"fas fa-redo mr-2\"></i>Retry Verification\n              </Button>\n              <Button \n                className=\"flex-1 bg-primary hover:opacity-90\"\n                disabled={!capturedPhoto || !documentUploaded}\n                onClick={handleContinueToExam}\n                data-testid=\"button-continue\"\n              >\n                <i className=\"fas fa-arrow-right mr-2\"></i>Continue to Exam\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":31753},"client/src/pages/student/simple-identity-verification.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { Input } from \"@/components/ui/input\";\nimport { Progress } from \"@/components/ui/progress\";\n\ninterface HallTicketData {\n  id: string;\n  examName: string;\n  studentName: string;\n  rollNumber: string;\n  examDate: string;\n  duration: number;\n}\n\ninterface VerificationResult {\n  isValid: boolean;\n  confidence: number;\n  extractedName?: string;\n  reason: string;\n}\n\nexport default function SimpleIdentityVerification() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [hallTicketData, setHallTicketData] = useState<HallTicketData | null>(null);\n  const [documentFile, setDocumentFile] = useState<File | null>(null);\n  const [documentPreview, setDocumentPreview] = useState<string | null>(null);\n  const [isVerifying, setIsVerifying] = useState(false);\n  const [verificationResult, setVerificationResult] = useState<VerificationResult | null>(null);\n  const [verificationProgress, setVerificationProgress] = useState(0);\n\n  useEffect(() => {\n    // Get hall ticket data from localStorage\n    const storedData = localStorage.getItem(\"hallTicketData\");\n    if (!storedData) {\n      toast({\n        title: \"No Hall Ticket Data\",\n        description: \"Please complete authentication first\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n      return;\n    }\n    \n    try {\n      setHallTicketData(JSON.parse(storedData));\n    } catch (error) {\n      toast({\n        title: \"Invalid Data\", \n        description: \"Please complete authentication again\",\n        variant: \"destructive\",\n      });\n      setLocation(\"/student/auth\");\n    }\n  }, [setLocation, toast]);\n\n  const validateDocument = (file: File): { isValid: boolean; message: string } => {\n    // File type validation\n    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/webp'];\n    if (!allowedTypes.includes(file.type)) {\n      return { isValid: false, message: 'Please upload a valid image file (JPEG, PNG, or WebP)' };\n    }\n    \n    // File size validation (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      return { isValid: false, message: 'File size must be less than 5MB' };\n    }\n    \n    return { isValid: true, message: 'Valid document' };\n  };\n\n  const handleDocumentUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const validation = validateDocument(file);\n    if (!validation.isValid) {\n      toast({\n        title: \"Invalid File\",\n        description: validation.message,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setDocumentFile(file);\n    \n    // Create preview\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      setDocumentPreview(e.target?.result as string);\n    };\n    reader.readAsDataURL(file);\n    \n    // Start verification immediately after upload\n    await performNameVerification(file);\n  };\n\n  const performNameVerification = async (file: File) => {\n    if (!hallTicketData) {\n      toast({\n        title: \"Error\",\n        description: \"Hall ticket data missing\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsVerifying(true);\n    setVerificationProgress(0);\n    setVerificationResult(null);\n\n    try {\n      // Convert file to base64\n      const base64 = await new Promise<string>((resolve) => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const result = e.target?.result as string;\n          const base64Data = result.split(',')[1]; // Remove data:image/... prefix\n          resolve(base64Data);\n        };\n        reader.readAsDataURL(file);\n      });\n\n      // Update progress\n      setVerificationProgress(30);\n\n      console.log(\"Starting simple name verification...\");\n      \n      // Call new simple verification API\n      const response = await fetch('/api/verify-name', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          idCardImage: base64,\n          expectedName: hallTicketData.studentName\n        }),\n      });\n\n      setVerificationProgress(70);\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Verification request failed');\n      }\n\n      const result: VerificationResult = await response.json();\n      setVerificationResult(result);\n      setVerificationProgress(100);\n\n      if (result.isValid) {\n        toast({\n          title: \"Verification Successful\",\n          description: result.reason,\n        });\n      } else {\n        toast({\n          title: \"Verification Failed\",\n          description: result.reason,\n          variant: \"destructive\",\n        });\n      }\n\n    } catch (error) {\n      console.error(\"Verification error:\", error);\n      setVerificationResult({\n        isValid: false,\n        confidence: 0,\n        reason: error instanceof Error ? error.message : \"Verification failed. Please try again.\"\n      });\n      setVerificationProgress(100);\n      \n      toast({\n        title: \"Verification Error\",\n        description: \"Failed to verify document. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsVerifying(false);\n    }\n  };\n\n  const retryVerification = () => {\n    setDocumentFile(null);\n    setDocumentPreview(null);\n    setVerificationResult(null);\n    setVerificationProgress(0);\n  };\n\n  const proceedToExam = () => {\n    if (verificationResult?.isValid) {\n      setLocation(\"/student/exam\");\n    }\n  };\n\n  if (!hallTicketData) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-2xl mx-auto\">\n          {/* Header */}\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n              Identity Verification\n            </h1>\n            <p className=\"text-muted-foreground mt-2\">\n              Upload your ID document to verify your identity\n            </p>\n          </div>\n\n          {/* Hall Ticket Info */}\n          <Card className=\"mb-6\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-ticket-alt text-accent\"></i>\n                <span>Exam Information</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"font-medium\">Student Name:</span>\n                  <p className=\"text-muted-foreground\">{hallTicketData.studentName}</p>\n                </div>\n                <div>\n                  <span className=\"font-medium\">Roll Number:</span>\n                  <p className=\"text-muted-foreground\">{hallTicketData.rollNumber}</p>\n                </div>\n                <div>\n                  <span className=\"font-medium\">Exam:</span>\n                  <p className=\"text-muted-foreground\">{hallTicketData.examName}</p>\n                </div>\n                <div>\n                  <span className=\"font-medium\">Date:</span>\n                  <p className=\"text-muted-foreground\">{hallTicketData.examDate}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Document Upload */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center space-x-2\">\n                <i className=\"fas fa-id-card text-accent\"></i>\n                <span>Upload ID Document</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {!documentFile ? (\n                  <div className=\"border-2 border-dashed border-border rounded-xl p-8 text-center\">\n                    <i className=\"fas fa-cloud-upload-alt text-4xl text-muted-foreground mb-4\"></i>\n                    <p className=\"text-lg font-medium mb-2\">Upload your ID document</p>\n                    <p className=\"text-sm text-muted-foreground mb-4\">\n                      Accepted formats: JPEG, PNG, WebP (max 5MB)\n                    </p>\n                    <Input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      onChange={handleDocumentUpload}\n                      className=\"max-w-xs\"\n                      data-testid=\"input-document-upload\"\n                    />\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {/* Document Preview */}\n                    <div className=\"border rounded-lg p-4\">\n                      <div className=\"flex items-center space-x-4\">\n                        {documentPreview && (\n                          <img \n                            src={documentPreview} \n                            alt=\"Uploaded document\" \n                            className=\"w-24 h-24 object-cover rounded-lg border\"\n                          />\n                        )}\n                        <div className=\"flex-1\">\n                          <p className=\"font-medium\">{documentFile.name}</p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {(documentFile.size / 1024 / 1024).toFixed(2)} MB\n                          </p>\n                        </div>\n                        <Button \n                          variant=\"outline\" \n                          size=\"sm\" \n                          onClick={retryVerification}\n                          data-testid=\"button-retry-upload\"\n                        >\n                          <i className=\"fas fa-redo mr-2\"></i>\n                          Retry\n                        </Button>\n                      </div>\n                    </div>\n\n                    {/* Verification Progress */}\n                    {isVerifying && (\n                      <div className=\"space-y-2\">\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <span>Extracting name from document...</span>\n                          <span>{verificationProgress}%</span>\n                        </div>\n                        <Progress value={verificationProgress} className=\"w-full\" />\n                      </div>\n                    )}\n\n                    {/* Verification Result */}\n                    {verificationResult && (\n                      <div className={`border rounded-lg p-4 ${\n                        verificationResult.isValid \n                          ? 'border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950' \n                          : 'border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-950'\n                      }`}>\n                        <div className=\"flex items-center space-x-2 mb-2\">\n                          <i className={`fas ${verificationResult.isValid ? 'fa-check-circle text-green-600' : 'fa-exclamation-circle text-red-600'}`}></i>\n                          <span className=\"font-medium\">\n                            {verificationResult.isValid ? 'Verification Successful' : 'Verification Failed'}\n                          </span>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground\">{verificationResult.reason}</p>\n                        {verificationResult.extractedName && (\n                          <p className=\"text-sm mt-2\">\n                            <span className=\"font-medium\">Extracted Name:</span> {verificationResult.extractedName}\n                          </p>\n                        )}\n                        <p className=\"text-sm\">\n                          <span className=\"font-medium\">Confidence:</span> {Math.round(verificationResult.confidence * 100)}%\n                        </p>\n                      </div>\n                    )}\n\n                    {/* Continue Button */}\n                    {verificationResult?.isValid && (\n                      <Button\n                        onClick={proceedToExam}\n                        className=\"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700\"\n                        size=\"lg\"\n                        data-testid=\"button-continue-exam\"\n                      >\n                        <i className=\"fas fa-arrow-right mr-2\"></i>\n                        Continue to Exam\n                      </Button>\n                    )}\n                  </div>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":13064},"server/auth.ts":{"content":"import passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport { Strategy as JwtStrategy, ExtractJwt } from \"passport-jwt\";\nimport session from \"express-session\";\nimport jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcrypt\";\nimport type { Express, RequestHandler } from \"express\";\nimport { readFileSync } from \"fs\";\nimport { join } from \"path\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-jwt-key-change-in-production\";\nconst SESSION_SECRET = process.env.SESSION_SECRET || \"your-session-secret\";\n\n// Load admin credentials from file\nfunction loadAdminCredentials() {\n  try {\n    const credentialsPath = join(__dirname, \"admin-credentials.json\");\n    const data = readFileSync(credentialsPath, \"utf-8\");\n    return JSON.parse(data);\n  } catch (error) {\n    console.error(\"Error loading admin credentials:\", error);\n    return {};\n  }\n}\n\n// Configure Passport Local Strategy\npassport.use(\n  new LocalStrategy(\n    {\n      usernameField: \"email\",\n      passwordField: \"password\",\n    },\n    async (email, password, done) => {\n      try {\n        const credentials = loadAdminCredentials();\n        const adminCreds = credentials.admin;\n\n        if (!adminCreds || adminCreds.email !== email) {\n          return done(null, false, { message: \"Invalid credentials\" });\n        }\n\n        const isValidPassword = await bcrypt.compare(password, adminCreds.password);\n        if (!isValidPassword) {\n          return done(null, false, { message: \"Invalid credentials\" });\n        }\n\n        // Get or create user in database\n        let user = await storage.getUser(adminCreds.id);\n        if (!user) {\n          user = await storage.upsertUser({\n            id: adminCreds.id,\n            email: adminCreds.email,\n            firstName: adminCreds.username,\n            role: adminCreds.role,\n          });\n        }\n\n        return done(null, user);\n      } catch (error) {\n        return done(error);\n      }\n    }\n  )\n);\n\n// Configure Passport JWT Strategy\nconst jwtOptions = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: JWT_SECRET,\n};\n\npassport.use(\n  new JwtStrategy(jwtOptions, async (payload: any, done: any) => {\n    try {\n      const user = await storage.getUser(payload.sub);\n      if (user) {\n        return done(null, user);\n      }\n      return done(null, false);\n    } catch (error) {\n      return done(error, false);\n    }\n  })\n);\n\n// Session configuration\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n\n  let sessionStore;\n  if (process.env.DATABASE_URL) {\n    const pgStore = connectPg(session);\n    sessionStore = new pgStore({\n      conString: process.env.DATABASE_URL,\n      createTableIfMissing: false,\n      ttl: sessionTtl,\n      tableName: \"sessions\",\n    });\n  } else {\n    console.warn(\"DATABASE_URL not available, using MemoryStore for sessions\");\n    sessionStore = undefined;\n  }\n\n  return session({\n    secret: SESSION_SECRET,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      maxAge: sessionTtl,\n    },\n  });\n}\n\n// Generate JWT token\nexport function generateToken(user: any) {\n  return jwt.sign(\n    {\n      sub: user.id,\n      email: user.email,\n      role: user.role,\n    },\n    JWT_SECRET,\n    { expiresIn: \"7d\" }\n  );\n}\n\n// Auth middleware - checks JWT token\nexport const isAuthenticated: RequestHandler = (req: any, res, next) => {\n  passport.authenticate(\"jwt\", { session: false }, (err: any, user: any) => {\n    if (err || !user) {\n      return res.status(401).json({ message: \"Unauthorized\" });\n    }\n    req.user = { claims: { sub: user.id }, ...user };\n    next();\n  })(req, res, next);\n};\n\n// Setup authentication\nexport async function setupAuth(app: Express) {\n  app.use(getSession());\n  app.use(passport.initialize());\n\n  // Login route\n  app.post(\"/api/login\", (req, res, next) => {\n    passport.authenticate(\"local\", { session: false }, (err: any, user: any, info: any) => {\n      if (err) {\n        return res.status(500).json({ message: \"Authentication error\" });\n      }\n      if (!user) {\n        return res.status(401).json({ message: info?.message || \"Invalid credentials\" });\n      }\n\n      const token = generateToken(user);\n      res.json({\n        token,\n        user: {\n          id: user.id,\n          email: user.email,\n          firstName: user.firstName,\n          role: user.role,\n        },\n      });\n    })(req, res, next);\n  });\n\n  // Logout route\n  app.post(\"/api/logout\", (req: any, res) => {\n    res.json({ message: \"Logged out successfully\" });\n  });\n\n  // Get current user\n  app.get(\"/api/auth/user\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n}\n","size_bytes":5107},"client/src/pages/admin/login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient } from \"@/lib/queryClient\";\nimport { Shield } from \"lucide-react\";\n\nconst loginSchema = z.object({\n  email: z.string().email(\"Invalid email address\"),\n  password: z.string().min(1, \"Password is required\"),\n});\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      email: \"\",\n      password: \"\",\n    },\n  });\n\n  async function onSubmit(data: LoginFormData) {\n    setIsLoading(true);\n    try {\n      const response = await fetch(\"/api/login\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Login failed\");\n      }\n\n      const result = await response.json();\n      \n      // Store the JWT token\n      localStorage.setItem(\"auth_token\", result.token);\n      \n      // Invalidate the user query to force a refresh\n      queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n\n      toast({\n        title: \"Login successful\",\n        description: `Welcome back, ${result.user.firstName || result.user.email}!`,\n      });\n\n      // Redirect to admin dashboard\n      setLocation(\"/admin\");\n    } catch (error: any) {\n      toast({\n        title: \"Login failed\",\n        description: error.message || \"Invalid credentials. Please try again.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 via-white to-indigo-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"p-3 bg-indigo-600 rounded-full\">\n              <Shield className=\"h-8 w-8 text-white\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl font-bold\">Admin Login</CardTitle>\n          <CardDescription>\n            Enter your credentials to access the SecureExam admin panel\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"email\"\n                        placeholder=\"admin@secureexam.com\"\n                        disabled={isLoading}\n                        data-testid=\"input-email\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"password\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"password\"\n                        placeholder=\"Enter your password\"\n                        disabled={isLoading}\n                        data-testid=\"input-password\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={isLoading}\n                data-testid=\"button-submit\"\n              >\n                {isLoading ? \"Logging in...\" : \"Login\"}\n              </Button>\n\n              <div className=\"text-center text-sm text-gray-600 dark:text-gray-400 mt-4\">\n                <p>Demo credentials:</p>\n                <p className=\"font-mono text-xs mt-1\">admin@secureexam.com / admin123</p>\n              </div>\n\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"w-full\"\n                onClick={() => setLocation(\"/\")}\n                data-testid=\"button-back\"\n              >\n                Back to Home\n              </Button>\n            </form>\n          </Form>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":5340}},"version":1}